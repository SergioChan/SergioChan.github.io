<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Sergio Chan]]></title>
  <subtitle><![CDATA[Full Stack, Born hacker, Professional Manager]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://sergiochan.github.io/"/>
  <updated>2018-08-02T04:21:08.670Z</updated>
  <id>http://sergiochan.github.io/</id>
  
  <author>
    <name><![CDATA[Sergio Chan]]></name>
    <email><![CDATA[cyh9211@icloud.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åˆ›å»ºè‡ªå·±çš„ä»¥å¤ªåŠç§æœ‰é“¾ï¼ˆ1ï¼‰CentOS + Geth]]></title>
    <link href="http://sergiochan.github.io/2018/07/25/%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%EF%BC%881%EF%BC%89CentOS-Geth/"/>
    <id>http://sergiochan.github.io/2018/07/25/å¦‚ä½•åˆ›å»ºè‡ªå·±çš„ä»¥å¤ªåŠç§æœ‰é“¾ï¼ˆ1ï¼‰CentOS-Geth/</id>
    <published>2018-07-25T13:47:19.000Z</published>
    <updated>2018-08-02T04:21:08.670Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>è¿™ä¸¤å¤©æ ¹æ®ç½‘ä¸Šèƒ½æœåˆ°çš„æ‰€æœ‰çš„æ•™ç¨‹å’Œæ–‡æ¡£ï¼Œè¯•ç€æ­å»ºäº†ä¸€ä¸ªä»¥å¤ªåŠç§æœ‰é“¾ + iOS é’±åŒ… / åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œè¸©äº†ä¸€äº›å‘ï¼Œä¸€æ¥è¦æ‰¾åˆ°è¿™äº›å‘çš„è§£å†³åŠæ³•æ¯”è¾ƒæ›²æŠ˜ï¼ŒäºŒæ¥è¿™ç±»æ•™ç¨‹çš„åŒè´¨åŒ–å¤ªå¼ºï¼Œæˆ‘å°±ç€é‡è®°å½•ä¸€ä¸‹è¿™äº›å‘çš„åŸå› å’Œè§£å†³åŠæ³•å§ï¼Œå¸®åŠ©çœ‹åˆ°çš„äººå¯ä»¥å¸å–ä¸€äº›ç»éªŒã€‚</p>
<h3 id="u51C6_u5907_u5DE5_u4F5C"><a href="#u51C6_u5907_u5DE5_u4F5C" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>Ethereum å®¢æˆ·ç«¯ç›®å‰æœ‰å‡ ç§è¯­è¨€çš„å®ç°æ˜¯å¼€æºçš„ï¼ˆè¿™é‡Œåªåˆ—å‡ºå‡ ä¸ªæœ€ä¸»è¦çš„ï¼Œå…¶ä»–çš„å¯ä»¥åœ¨ Ethereum çš„<a href="https://github.com/ethereum/wiki/wiki/Clients,-tools,-dapp-browsers,-wallets-and-other-projects" target="_blank" rel="external">å®˜æ–¹ wiki</a> ä¸Šæ‰¾åˆ°ï¼‰ï¼š</p>
<ul>
<li><a href="https://github.com/ethereum/go-ethereum" target="_blank" rel="external">go-ethereumï¼ˆGETHï¼‰</a>ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰æ¯”è¾ƒå®¹æ˜“ä¸Šæ‰‹ä¸”æ™®éæµè¡Œçš„å®ç°ï¼Œå¯¹åº”çš„å·¥å…·å’Œæ–‡æ¡£éƒ½æ¯”è¾ƒé½å…¨</li>
<li><a href="https://github.com/ethereum/pyethapp" target="_blank" rel="external">pyethapp</a>ï¼ŒåŸºäº <a href="https://github.com/ethereum/pyethereum" target="_blank" rel="external">py-ethereum</a>ï¼Œä½†æ˜¯ç›®å‰å·²ç»åœæ­¢ç»§ç»­ç»´æŠ¤ï¼ŒåŸºäº py-ethereum æœ‰äº†æ–°çš„ py-evmï¼Œå¹¶ä¸”æ¨å‡ºäº†åŸºäº <a href="https://github.com/ethereum/py-evm" target="_blank" rel="external">py-evm</a> çš„æ–°çš„å®¢æˆ·ç«¯ Trinity</li>
<li><a href="https://github.com/paritytech/parity" target="_blank" rel="external">Parity</a>ï¼ˆRustï¼‰</li>
<li><a href="https://github.com/ethereum/cpp-ethereum" target="_blank" rel="external">cpp-ethereum</a>ï¼ˆC++ï¼‰</li>
</ul>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>å„ä¸ªå¹³å°çš„å®‰è£…è¿‡ç¨‹å¯ä»¥è§ä»¥å¤ªåŠå®˜æ–¹çš„<a href="https://github.com/ethereum/go-ethereum/wiki/Building-Ethereum" target="_blank" rel="external">å„å¹³å°å®‰è£…æŒ‡å¼•</a>ã€‚ä»¥ CentOS ä¸ºä¾‹ï¼Œå®‰è£…è¿‡ç¨‹å…¶å®å¹¶ä¸å¤æ‚ã€‚</p>
<p>é¦–å…ˆç¡®ä¿ cmake, gcc, wget è¿™äº›åŸºæœ¬çš„ç»„ä»¶éƒ½å·²ç»å®‰è£…å®Œæ¯•ã€‚ç„¶åæ˜¯å®‰è£… golang ç¯å¢ƒï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install golang</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œ golang ç¯å¢ƒåï¼Œå¯ä»¥ wget ä¸‹è½½ github ä¸Šæœ€æ–°ç‰ˆæœ¬çš„ release åŒ…ï¼ŒæŸ¥çœ‹åœ°å€<a href="https://github.com/ethereum/go-ethereum/releases" target="_blank" rel="external">åœ¨è¿™</a>ã€‚ä¾‹å¦‚æˆ‘å°±æ˜¯ä¸‹è½½çš„æœ€æ–°çš„ 1.8.12 çš„åŒ…ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://github.com/ethereum/go-ethereum/archive/v1.8.12.zip</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½å®Œä¹‹åè§£å‹ï¼Œè§£å‹åè¿›å…¥ç›®å½•ä¸‹è¿è¡Œ makeã€‚æˆåŠŸåå³ç¼–è¯‘å®Œæˆã€‚geth çš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ build/bin ä¸‹ã€‚åˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•å°±å¯ä»¥åœ¨å‘½ä»¤è¡Œè°ƒç”¨ geth å‘½ä»¤äº†ã€‚</p>
<h3 id="u521B_u4E16_u533A_u5757_u7684_u7B80_u5355_u914D_u7F6E_u4EE5_u53CA_u9700_u8981_u6CE8_u610F_u7684_u4E00_u4E2A_u5751"><a href="#u521B_u4E16_u533A_u5757_u7684_u7B80_u5355_u914D_u7F6E_u4EE5_u53CA_u9700_u8981_u6CE8_u610F_u7684_u4E00_u4E2A_u5751" class="headerlink" title="åˆ›ä¸–åŒºå—çš„ç®€å•é…ç½®ä»¥åŠéœ€è¦æ³¨æ„çš„ä¸€ä¸ªå‘"></a>åˆ›ä¸–åŒºå—çš„ç®€å•é…ç½®ä»¥åŠéœ€è¦æ³¨æ„çš„ä¸€ä¸ªå‘</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"config"</span>: &#123;</span><br><span class="line">    	<span class="attr">"chainId"</span>: <span class="number">10</span>,</span><br><span class="line">    	<span class="attr">"homesteadBlock"</span>: <span class="number">0</span>,</span><br><span class="line">    	<span class="attr">"eip150Block"</span>: <span class="number">0</span>,</span><br><span class="line">    	<span class="attr">"eip150Hash"</span>: <span class="string">"0x0000000000000000000000000000000000000000000000000000000000000000"</span>,</span><br><span class="line">    	<span class="attr">"eip155Block"</span>: <span class="number">0</span>,</span><br><span class="line">    	<span class="attr">"eip158Block"</span>: <span class="number">0</span>,</span><br><span class="line">    	<span class="attr">"byzantiumBlock"</span>: <span class="number">0</span>,</span><br><span class="line">  	&#125;</span><br><span class="line">    <span class="string">"nonce"</span>: <span class="string">"0Ã—0000000000000042"</span>,</span><br><span class="line">    <span class="attr">"mixhash"</span>: <span class="string">"0Ã—0000000000000000000000000000000000000000000000000000000000000000"</span>,</span><br><span class="line">    <span class="attr">"difficulty"</span>: <span class="string">"0Ã—4000"</span>,</span><br><span class="line">    <span class="attr">"alloc"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"coinbase"</span>: <span class="string">"0Ã—0000000000000000000000000000000000000000"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="string">"0Ã—00"</span>,</span><br><span class="line">    <span class="attr">"parentHash"</span>: <span class="string">"0Ã—0000000000000000000000000000000000000000000000000000000000000000"</span>,</span><br><span class="line">    <span class="attr">"extraData"</span>: <span class="string">"GenesisBlock"</span>,</span><br><span class="line">    <span class="attr">"gasLimit"</span>: <span class="string">"0xffffffff"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å¯åŠ¨é“¾ä¹‹å‰é¦–å…ˆè¦åˆå§‹åŒ–åˆ›ä¸–åŒºå—ï¼Œåˆ›ä¸–åŒºå—çš„å‡ ä¸ªåŸºæœ¬å‚æ•°çš„è¯´æ˜åœ¨ç½‘ä¸Šæ¯”è¾ƒå¥½æ‰¾ï¼Œåœ¨è¿™å°±ä¸è¯¦ç»†å±•å¼€äº†ã€‚å¦‚æœéœ€è¦é¢„å…ˆåˆ†é…å¥½å‡ ä¸ªè´¦æˆ·åŠå…¶å¯¹åº”çš„ balanceï¼Œå¯ä»¥åœ¨ alloc é‡Œé¢å£°æ˜ã€‚</p>
<p>ä¸€ä¸ªå·¨å¤§çš„å‘åœ¨äº <code>chainID</code> çš„è®¾ç½®ï¼Œå¦‚æœè®¾ç½®ä¸º 0 åˆ™ä¼šåœ¨ä¹‹åäº§ç”Ÿä»»ä½•äº‹åŠ¡çš„æ—¶å€™æŠ¥é”™ <code>invlid sender</code>ï¼Œå¹¶ä¸”<strong>è¿™é‡Œçš„ <code>chainID</code> å¿…é¡»å’Œå‘½ä»¤è¡Œå¯åŠ¨å®¢æˆ·ç«¯çš„æ—¶å€™æŒ‡å®šçš„ <code>networkID</code> ä¸€è‡´</strong>ï¼Œè¿™ä¸¤è€…å®é™…ä¸Šæ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œä¹Ÿä¼šå¯¼è‡´åé¢å†å‘é€äº‹åŠ¡çš„æ—¶å€™éªŒè¯å¤±è´¥ã€‚</p>
<p>ä¸ºäº†åœ¨æœ¬åœ°å¯åŠ¨ä¸¤ä¸ªèŠ‚ç‚¹å¹¶ç›¸äº’è¿æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸¤æ¬¡åˆ›ä¸–èŠ‚ç‚¹åˆ°ä¸¤ä»½ä¸åŒçš„æ•°æ®ç›®å½•ä¸‹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./geth --datadir ~/chain2/ init init.json</span><br><span class="line">./geth --datadir ~/chain/ init init.json</span><br></pre></td></tr></table></figure>
<h3 id="Command_Line__u8FD0_u884C_u53C2_u6570_u89E3_u6790"><a href="#Command_Line__u8FD0_u884C_u53C2_u6570_u89E3_u6790" class="headerlink" title="Command Line è¿è¡Œå‚æ•°è§£æ"></a>Command Line è¿è¡Œå‚æ•°è§£æ</h3><p>å®˜æ–¹çš„å®Œæ•´å‚æ•°è¯´æ˜<a href="https://github.com/ethereum/go-ethereum/wiki/Command-Line-Options" target="_blank" rel="external">åœ¨è¿™</a>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./geth --port "30303" --rpc --rpccorsdomain "*" --datadir "~/chain" --rpcaddr "0.0.0.0" --rpcport "8545" --rpcapi "db,eth,net,web3,admin,personal,txpool" --networkid 10 --verbosity 3 --syncmode fast --gasprice 0 -gcmode archive console</span><br><span class="line">./geth --port "30304" --rpc --rpccorsdomain "*" --datadir "~/chain2" --rpcaddr "0.0.0.0" --rpcport "8546" --rpcapi "db,eth,net,web3,admin,personal,txpool" --networkid 10 --verbosity 3 --syncmode fast --gasprice 0 -gcmode archive console</span><br></pre></td></tr></table></figure>
<p>åˆ†åˆ«åœ¨ä¸åŒçš„ terminal çª—å£ä¸‹è¿è¡Œè¿™ä¸¤æ¡å‘½ä»¤ã€‚æ³¨æ„æœ€åçš„ console å‚æ•°å¯ä»¥ä¸éœ€è¦æˆ–ç”¨ <code>&gt;&gt;</code>å°†æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ ï¼Œå³ä¸è¿›å…¥äº¤äº’å¼çš„å‘½ä»¤ç•Œé¢ï¼Œç„¶ååœ¨å¦å¤–çš„å‘½ä»¤è¡Œé‡Œé€šè¿‡ <code>geth attach xxx</code>å›åˆ°äº¤äº’å¼ç•Œé¢ã€‚</p>
<p><code>--rpc</code> é’±åŒ…å’Œåº”ç”¨ä¸é“¾çš„äº¤äº’éƒ½æ˜¯é€šè¿‡ JSON RPC æ¥å®Œæˆçš„ï¼Œå› æ­¤åœ¨è¿™é‡Œéœ€è¦æ˜ç¡® rpc æœåŠ¡å™¨çš„åœ°å€ã€ç«¯å£ä»¥åŠå¼€æ”¾è°ƒç”¨çš„ api å‘½åç©ºé—´ã€‚è¿™é‡Œå¦‚æœå¸Œæœ› rpc æœåŠ¡å™¨å¯ä»¥è¢«å¤–ç½‘è®¿é—®çš„è¯ï¼Œéœ€è¦æŒ‡å®š ip ä¸º <code>0.0.0.0</code>ï¼Œå†…ç½‘è®¿é—®çš„è¯å°±æŒ‡å®šå†…ç½‘ ipï¼Œæœ¬åœ°è®¿é—®çš„è¯å®é™…ä¸ŠæŒ‡å®š <code>127.0.0.1</code>å³å¯ï¼Œè¿™æ ·å¯ä»¥é¿å…è¢«ä¸çŸ¥åçš„å…¶ä»–èŠ‚ç‚¹ä¸åœåœ°å°è¯•è¿æ¥ã€‚rpc çš„ api å¯ä»¥å‚è€ƒ<a href="https://github.com/ethereum/wiki/wiki/JSON-RPC" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œå¦‚æœæ˜¯å¼€å‘ç½‘é¡µæˆ– native çš„åº”ç”¨çš„è¯å¯ä»¥ç›´æ¥ä½¿ç”¨åŒ…è£…å¥½çš„ web3 åº“æ¥è°ƒç”¨ã€‚</p>
<p><code>â€”networkid</code>è¿™é‡Œéœ€è¦å’Œåˆ›ä¸–åŒºå—é‡Œå®šä¹‰çš„ chainID ä¸€è‡´ã€‚</p>
<p><code>â€”verbosity</code>è¿™æ˜¯æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ï¼Œ3 æ˜¯åˆ° INFOï¼Œ4 æ˜¯åˆ° DEBUGï¼Œä¸€èˆ¬æƒ…å†µ 3 å°±è¶³å¤Ÿäº†ï¼ŒDEBUG æ¨¡å¼ä¸‹æ—¥å¿—åˆ·æ–°çš„å¤ªå¿«ï¼Œå‘½ä»¤è¡Œäº¤äº’åŸºæœ¬æ²¡æ³•ä½¿ç”¨ã€‚</p>
<p><code>â€”syncmode</code>èŠ‚ç‚¹ä¹‹é—´åŒæ­¥åŒºå—å’Œäº‹åŠ¡çš„æ¨¡å¼ï¼Œåœ¨èŠ‚ç‚¹æ•°å°‘çš„æƒ…å†µä¸‹ï¼Œå°½é‡é€‰æ‹©å®Œæ•´åŒæ­¥ï¼Œé¿å…å› ä¸ºä¸åŒæ­¥è€Œäº§ç”Ÿå†²çªä»è€Œå¯¼è‡´ä¸€äº›å·²ç»è¢«è®¤ä¸ºå‘ç”Ÿçš„äº‹åŠ¡ç»™ä¸¢å¼ƒäº†ã€‚ä½†æ˜¯è¿™é‡Œæœ€å¥½é€‰æ‹© <code>fast</code>ï¼Œåœ¨å®é™…è¿è¡Œä¸­ï¼Œå¦‚æœé€‰æ‹©å®Œæ•´åŒæ­¥ï¼Œå¯¹ CPU çš„æ¶ˆè€—éå¸¸å¤§ï¼Œå› æ­¤å¦‚æœé…ç½®ä¸å¤Ÿçš„è¯ï¼Œç»å¸¸å‡ºç°è¢«ç³»ç»Ÿæ€æ­»è¿›ç¨‹çš„æƒ…å†µï¼Œåœ¨è¿™é‡Œæœ€å¥½é€‰æ‹©é»˜è®¤çš„ã€‚</p>
<blockquote>
<p>P.S ä¸­é—´æˆ‘è¿˜å¦å¤–å°è¯•äº†ä¸€ä¸‹ iOS ä¸Šçš„ Geth åº“ï¼Œå¦‚æœä½ çš„èŠ‚ç‚¹å¸Œæœ›èƒ½è¢« iOS æˆ– Android ä¸Šçš„å®¢æˆ·ç«¯ï¼ˆä¸æ˜¯é’±åŒ…æˆ–åº”ç”¨ï¼Œæ˜¯å®¢æˆ·ç«¯ï¼‰è¿æ¥ï¼Œè¿™é‡Œéœ€è¦å°†åŒæ­¥æ¨¡å¼å»æ‰ï¼ŒåŠ ä¸Š â€”lightserver xxx çš„å‚æ•°ï¼Œå› ä¸ºç›®å‰å®ç°åœ¨ç§»åŠ¨å¹³å°ä¸Šçš„èŠ‚ç‚¹å®¢æˆ·ç«¯éƒ½æ˜¯ light ç‰ˆæœ¬çš„ï¼Œå› æ­¤è¿æ¥çš„é“¾èŠ‚ç‚¹ä¹Ÿéœ€è¦ç›¸åº”çš„é…ç½®è¿™ä¸ªå‚æ•°ã€‚</p>
</blockquote>
<p><code>â€”gcmode</code>è¿™ä¸ªå‚æ•°è®¾ç½®çš„é—®é¢˜è§<a href="https://ethereum.stackexchange.com/questions/39922/ethereum-private-chain-resets-back-to-block-0-when-restarted" target="_blank" rel="external">è¿™é‡Œ</a>ï¼Œæˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œé€€å‡ºå‘½ä»¤è¡Œé‡å¯å®¢æˆ·ç«¯ï¼Œæœ‰çš„æ—¶å€™å°±å‘ç°åˆšæ‰å‘ç”Ÿçš„ transaction éƒ½è¢«å›æ»šäº†ï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹æœ€è¿‘çš„ 128 ä¸ªåŒºå—éƒ½æ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œå‘½ä»¤è¡Œç»“æŸäº†è¿™ä¸ªè¿›ç¨‹ï¼Œè¿™éƒ¨åˆ†å†…å­˜ä¹Ÿå°±ä¸¢äº†ï¼Œå› æ­¤éœ€è¦æ”¹æˆ <code>archive</code>ï¼Œä¼šå°†æ‰€æœ‰çš„åŒºå—å­˜ä¸‹æ¥ï¼Œé¿å…ä¸­æ­¢å®¢æˆ·ç«¯è¿›ç¨‹å½±å“åŒºå—çš„æ•°æ®ã€‚</p>
<h3 id="Geth__u57FA_u672C_u4EA4_u4E92_u64CD_u4F5C"><a href="#Geth__u57FA_u672C_u4EA4_u4E92_u64CD_u4F5C" class="headerlink" title="Geth åŸºæœ¬äº¤äº’æ“ä½œ"></a>Geth åŸºæœ¬äº¤äº’æ“ä½œ</h3><p>é¦–å…ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦æœ‰ä¸€ä¸ªé»˜è®¤çš„ <code>coinbase</code> è´¦æˆ·ï¼Œè€Œåˆšå¯åŠ¨çš„æ—¶å€™é™¤éä½ åœ¨å¯åŠ¨çš„æ—¶å€™å¯¼å…¥ä¸€ä¸ªè´¦æˆ·çš„ private keyï¼Œå¦åˆ™å°±å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">personal.<span class="keyword">new</span><span class="type">Account</span>(<span class="string">"xxx"</span>)</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„åœ°å€ã€‚æŒ–çŸ¿æŒ–åˆ°çš„ ETH ä¹Ÿä¼šå­˜å…¥è¿™ä¸ªè´¦æˆ·é‡Œã€‚</p>
<h4 id="u67E5_u770B_u4F59_u989D"><a href="#u67E5_u770B_u4F59_u989D" class="headerlink" title="æŸ¥çœ‹ä½™é¢"></a>æŸ¥çœ‹ä½™é¢</h4><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">eth</span><span class="selector-class">.getBalance</span>(<span class="string">'xxxx'</span>)</span><br></pre></td></tr></table></figure>
<p>æ˜¯è·å–æŒ‡å®šåœ°å€ï¼ˆåŒ…æ‹¬åˆçº¦ï¼‰ä¸Šçš„ ETH æ•°é‡ï¼Œå•ä½ä¸º weiã€‚</p>
<p>ETH æœ€å°çš„å•ä½æ˜¯ weiï¼Œä¹Ÿæ˜¯å‘½ä»¤è¡Œé»˜è®¤çš„å•ä½, ç„¶åæ¯ 1000  è¿›ä¸€ä¸ªå•ä½ï¼Œä¾æ¬¡æ˜¯</p>
<ul>
<li>kwei (1000 wei)</li>
<li>mwei (1000 kwei)</li>
<li>gwei (1000 mwei)</li>
<li>szabo (1000 gwei)</li>
<li>finney (1000 szabo)</li>
<li>ether (1000 finney)</li>
</ul>
<p>åœ¨å‘½ä»¤è¡Œé‡Œï¼Œå¯ä»¥è¾“å…¥</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">web3</span><span class="selector-class">.fromWei</span>(<span class="selector-tag">eth</span><span class="selector-class">.getBalance</span>(<span class="selector-tag">eth</span><span class="selector-class">.coinbase</span>))</span><br></pre></td></tr></table></figure>
<p>æ¥ç®€ä¾¿çš„æŸ¥çœ‹å½“å‰çŸ¿å·¥è´¦æˆ·çš„ ether ä½™é¢ã€‚</p>
<h4 id="u5F00_u59CB_u6316_u77FF__26amp_3B__u505C_u6B62_u6316_u77FF"><a href="#u5F00_u59CB_u6316_u77FF__26amp_3B__u505C_u6B62_u6316_u77FF" class="headerlink" title="å¼€å§‹æŒ–çŸ¿ &amp; åœæ­¢æŒ–çŸ¿"></a>å¼€å§‹æŒ–çŸ¿ &amp; åœæ­¢æŒ–çŸ¿</h4><p>è¿™ä¸ªå°±æ¯”è¾ƒç®€å•äº†ã€‚</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">miner.<span class="literal">start</span>()</span><br><span class="line">miner.<span class="literal">stop</span>()</span><br></pre></td></tr></table></figure>
<p>åœ¨æŒ–çŸ¿çš„è¿‡ç¨‹ä¸­ï¼ŒçŸ¿å·¥ä¸åœåœ°ç¡®è®¤å’Œæ‰“åŒ…æ–°çš„åŒºå—ï¼Œå…¶ä»–åŒæ­¥çš„èŠ‚ç‚¹ä¸Šåº”è¯¥æ˜¾ç¤º</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Importer new chain segment               <span class="attribute">blocks</span>=1 <span class="attribute">txs</span>=0 <span class="attribute">mgas</span>=0.000 <span class="attribute">elapsed</span>=17.040ms mgasp</span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºåŒºå—åŒæ­¥æ˜¯æ­£å¸¸è¿›è¡Œçš„ã€‚</p>
<h4 id="u8FDE_u63A5_u5176_u4ED6_u7684_u8282_u70B9"><a href="#u8FDE_u63A5_u5176_u4ED6_u7684_u8282_u70B9" class="headerlink" title="è¿æ¥å…¶ä»–çš„èŠ‚ç‚¹"></a>è¿æ¥å…¶ä»–çš„èŠ‚ç‚¹</h4><p>åœ¨å¯åŠ¨çš„æ—¶å€™è¾“å‡ºçš„ä¸€äº›ä¿¡æ¯ä¸­èƒ½å¤Ÿæ‰¾åˆ° <code>enode</code> ä¿¡æ¯ï¼Œå¦‚æœé”™è¿‡äº†ä¹Ÿå¯ä»¥é€šè¿‡</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">admin<span class="selector-class">.nodeinfo</span><span class="selector-class">.enode</span></span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ°å½“å‰èŠ‚ç‚¹çš„è¿æ¥åœ°å€ï¼Œå°†å…¶ä¸­çš„ <code>@[::]:30303</code>ä¸­é—´æ‹¬å·é—´çš„ä¸¤ä¸ªå†’å·æ”¹ä¸ºä½ å¸Œæœ›å¦ä¸€ä¸ªèŠ‚ç‚¹è®¿é—®åˆ°çš„ ip åœ°å€ï¼Œä¾‹å¦‚å†…ç½‘è®¿é—®å°±å¡«å†…ç½‘åœ°å€ï¼Œå¤–ç½‘è®¿é—®å°±å¡«å…¬ç½‘ ipï¼Œç„¶ååœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ§åˆ¶å°é‡Œè¾“å…¥</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">admin.addPeer(<span class="string">"xxx@xx:xx:xx:xx:xxxx"</span>)</span><br><span class="line">admin<span class="selector-class">.peers</span> <span class="comment">// æŸ¥çœ‹æ˜¯å¦è¿æ¥æˆåŠŸ</span></span><br></pre></td></tr></table></figure>
<p>å³å¯ä½¿ä¸¤ä¸ªèŠ‚ç‚¹ P2P è¿æ¥ã€‚åŒæ—¶ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯é•¿æœŸèŠ‚ç‚¹ï¼Œå³ä½œä¸ºåŸºç¡€çš„èŠ‚ç‚¹åœ¨è¿è½¬çš„è¯ï¼Œåœ¨å…¶ä»–è¿æ¥èŠ‚ç‚¹å¯åŠ¨çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œè®¾ç½® <code>â€”bootnodes</code> æ¥ä½¿æ–°çš„èŠ‚ç‚¹å¯åŠ¨çš„æ—¶å€™å°±å»å°è¯•è¿æ¥è¿™ä¸ªå·²ç»åœ¨çº¿çš„èŠ‚ç‚¹ã€‚</p>
<h4 id="u4EA4_u6613"><a href="#u4EA4_u6613" class="headerlink" title="äº¤æ˜“"></a>äº¤æ˜“</h4><p>æŒ–çŸ¿äº§ç”Ÿäº† ETHï¼Œå°±å¯ä»¥è¿›è¡Œäº¤æ˜“äº†ã€‚äº¤æ˜“ï¼ˆè°ƒç”¨æ™ºèƒ½åˆçº¦ä¹Ÿæ˜¯ï¼‰éœ€è¦æœ‰è‡³å°‘ä¸€ä¸ªçŸ¿å·¥åœ¨æŒ–çŸ¿ï¼Œæ‰èƒ½å¤Ÿå®Œæˆï¼Œå¦åˆ™å°±æ²¡äººå¤„ç†äº†ã€‚åœ¨äº¤æ˜“å‰ï¼Œæ‰€æœ‰æ¶‰åŠäº§ç”Ÿäº‹åŠ¡ï¼Œå³ sendTransaction çš„æ“ä½œï¼ˆè°ƒç”¨æ™ºèƒ½åˆçº¦ä¹Ÿæ˜¯ï¼‰ï¼Œéƒ½éœ€è¦ unlock è´¦æˆ·åœ°å€ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">personal.unlockAccount(eth<span class="selector-class">.coinbase</span>,<span class="string">"&#123;your password&#125;"</span>,<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<p>æœ€åçš„ 3000 å•ä½ä¸ºç§’ï¼Œå³æ¥ä¸‹æ¥çš„å¤šå°‘ç§’å†…ä¿æŒè´¦æˆ·å¯ä»¥æäº¤äº‹åŠ¡çš„çŠ¶æ€ï¼Œå¯ä»¥è‡ªè¡Œè°ƒèŠ‚ã€‚æ¥ä¸‹æ¥å°±æ˜¯å…·ä½“çš„è½¬è´¦æ“ä½œï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">eth</span><span class="selector-class">.sendTransaction</span>(&#123;<span class="attribute">from</span>:<span class="string">'xxx'</span>,to:<span class="string">'xxx'</span>,value:web3.<span class="built_in">toWei</span>(1)&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ value å•ä½ä»ç„¶æ˜¯ <code>wei</code>ï¼Œå› æ­¤è¾“å…¥çš„æ˜¯ ether ä¸ºå•ä½çš„è¯éœ€è¦è½¬æ¢ã€‚æ“ä½œæˆåŠŸåç­‰å¾…çŸ¿å·¥ç¡®è®¤å’Œæ‰“åŒ…å®Œæˆï¼Œå°±å¯ä»¥æŸ¥çœ‹åœ°å€å¯¹åº”çš„ä½™é¢äº†ã€‚</p>
<h4 id="u67E5_u770B_u4E8B_u52A1_u7684_u72B6_u6001"><a href="#u67E5_u770B_u4E8B_u52A1_u7684_u72B6_u6001" class="headerlink" title="æŸ¥çœ‹äº‹åŠ¡çš„çŠ¶æ€"></a>æŸ¥çœ‹äº‹åŠ¡çš„çŠ¶æ€</h4><p>ç”±äºçŸ¿å·¥æœ‰äº›æ—¶å€™ä¸æ˜¯æ­£å¥½å°±èƒ½å¤„ç†åˆ°åˆšæäº¤çš„äº‹åŠ¡å¹¶æ‰“åŒ…ï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥é€šè¿‡</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">txpool</span><span class="selector-class">.content</span></span><br></pre></td></tr></table></figure>
<p>æ¥æŸ¥çœ‹å½“å‰äº‹åŠ¡æ± å­é‡Œå¤„äºç­‰å¾…çŠ¶æ€çš„äº‹åŠ¡ï¼Œå¯ä»¥ç¡®è®¤ä½ çš„è°ƒç”¨æ˜¯å¦æˆåŠŸã€‚</p>
<h3 id="u5B9E_u73B0_u4E00_u4E2A_u9F99_u5934_u667A_u80FD_u5408_u7EA6"><a href="#u5B9E_u73B0_u4E00_u4E2A_u9F99_u5934_u667A_u80FD_u5408_u7EA6" class="headerlink" title="å®ç°ä¸€ä¸ªé¾™å¤´æ™ºèƒ½åˆçº¦"></a>å®ç°ä¸€ä¸ªé¾™å¤´æ™ºèƒ½åˆçº¦</h3><p>åœ¨ Ethereum çš„æµ‹è¯•ç½‘ç»œä¸Šï¼Œéƒ½æœ‰é¾™å¤´è¿™æ ·ä¸€ä¸ªåœ°å€ï¼Œä½ å¯ä»¥è¯·æ±‚è¿™ä¸ªåœ°å€ï¼Œä»–ä¼šå‘æ”¾ä¸€å®šé‡çš„æµ‹è¯• ETH ç»™å¼€å‘è€…ä»¥ä¾›ä½¿ç”¨ã€‚å¹¶ä¸”ç”¨æˆ·ç”¨å®Œåå¯ä»¥ç»§ç»­æèµ ç»™å®ƒï¼Œä¾‹å¦‚ <code>Ropsten Network</code>ã€‚å› æ­¤æˆ‘ä¹Ÿåœ¨è¿™é‡Œå¾ˆç®€å•çš„å®ç°ä¸€ä¸ªé¾™å¤´åˆçº¦ã€‚</p>
<p>ä¸ºäº†å¼€å‘æ–¹ä¾¿ï¼Œç›®å‰å·²ç»æœ‰ Solidity çš„ IDE å¯ä»¥ä½¿ç”¨äº†ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ <a href="http://remix.ethereum.org/" target="_blank" rel="external">Remix</a>ï¼Œåªè¦åœ¨ environment é‡Œè®¾ç½®ä¸º <code>web3 provider</code> å¹¶å¡«ä¸Šè‡ªå·±çš„ rpc åœ°å€ï¼Œå°±å¯ä»¥è¿ä¸Šä½ åˆšåˆšæ–°å»ºçš„ç§æœ‰é“¾è¿›è¡Œæµ‹è¯•äº†ã€‚</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4.</span><span class="number">20</span>;</span><br><span class="line">contract faucet &#123;</span><br><span class="line">    uint <span class="keyword">public</span> totalEther;</span><br><span class="line">    address <span class="keyword">public</span> _owner;</span><br><span class="line">    </span><br><span class="line">   constructor () <span class="keyword">public</span> &#123;</span><br><span class="line">        totalEther = <span class="number">0</span>;</span><br><span class="line">        _owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span></span> donate() <span class="keyword">public</span> payable &#123;</span><br><span class="line">         totalEther += msg.<span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span></span> requestSomeEther(uint amount) <span class="keyword">public</span> &#123;</span><br><span class="line">         totalEther -= amount;</span><br><span class="line">         <span class="keyword">if</span> (totalEther &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  			totalEther = <span class="number">0</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			msg.sender.<span class="built_in">transfer</span>(amount);</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>deploy ä»¥ä¸Šåˆçº¦ï¼Œæ‹·è´åœ°å€å¹¶åŠ è½½ã€‚é€šè¿‡å¤§çš„æŒ–çŸ¿èŠ‚ç‚¹è°ƒç”¨åˆçº¦çš„ <code>donate</code> æ–¹æ³•å°† ether è½¬åˆ°åˆçº¦çš„åœ°å€ä¸Šï¼Œå…¶ä»–æ–°çš„æµ‹è¯•è´¦æˆ·å¯ä»¥ç›´æ¥è°ƒç”¨ <code>requestSomeEther</code>æ¥è·å–æŒ‡å®šæ•°é‡çš„ etherï¼Œå½“ç„¶è¿™ä¸ªå•ä½æ˜¯ weiã€‚</p>
<p>ä¸‹é¢æˆ‘ä¼šæŒç»­è¡¥å……ä¸€äº›é™†é™†ç»­ç»­ç§¯ç´¯çš„ç»éªŒã€‚</p>
<h3 id="u7EED_0x0001_uFF1AGeth__u7684_u5185_u5B58_u6CC4_u6F0F"><a href="#u7EED_0x0001_uFF1AGeth__u7684_u5185_u5B58_u6CC4_u6F0F" class="headerlink" title="ç»­ 0x0001ï¼šGeth çš„å†…å­˜æ³„æ¼"></a>ç»­ 0x0001ï¼šGeth çš„å†…å­˜æ³„æ¼</h3><p>åœ¨åˆå§‹å‡ å¤©çš„å®é™…è¿è¡Œä¸­ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œä»¥è‡³äºåæ‚”å…¥äº†è¿™ä¸ªå‘ã€‚Geth åœ¨é•¿æ—¶é—´è¿è¡Œåï¼Œæœ‰çš„æ—¶å€™ä¼šè‡ªåŠ¨æŠ¥é”™ crashï¼Œæœ‰çš„æ—¶å€™åˆ™æ˜¯ç›´æ¥åœ¨å‘½ä»¤è¡Œæ˜¾ç¤º <code>å·²æ€æ­»</code>ï¼Œè¿™æ˜¯å…¸å‹çš„å ç”¨ç³»ç»Ÿèµ„æºè¿‡å¤šæˆ– IO æ—¶é—´å¤ªé•¿è¢«ç³»ç»Ÿå¼ºåˆ¶ç»“æŸçš„æƒ…å†µã€‚æŠ¥çš„é”™éå¸¸éå¸¸é•¿ï¼Œä½†æ˜¯è¿½æº¯åˆ°æºå¤´å°±æ˜¯ <code>out of memory</code>ï¼Œè§‚å¯ŸæœåŠ¡å™¨çš„ç›‘æ§å†…å­˜æ›²çº¿å°±èƒ½å‘ç°ï¼Œæ¯è¿‡ä¸€æ®µæ—¶é—´ï¼Œå†…å­˜å°±ä¼šé€æ¸å¢åŠ ï¼Œç›´åˆ°å æ»¡ 100%ï¼Œåœ¨æ»¡è´Ÿè·è¿è¡Œä¸ä¹…åï¼Œè¦ä¹ˆè¢«ç³»ç»Ÿå¼ºåˆ¶ç»“æŸï¼Œè¦ä¹ˆè‡ªå·±å°± gg äº†ã€‚äºæ˜¯å¼€å§‹äº†æ¼«é•¿çš„æŸ¥æ‰¾é—®é¢˜è§£å†³åŠæ³•ä¹‹è·¯ã€‚ç„¶è€Œæˆ‘ç»æœ›çš„å‘ç°ï¼Œæ— è®ºæ˜¯ SO è¿˜æ˜¯ Github çš„ issueï¼Œéƒ½æœ‰å¤§é‡çš„å¼€å‘è€…æäº†ç›¸åŒçš„é—®é¢˜ï¼Œåœ¨ Geth æœ€æ–°çš„ 1.8.12 release ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªå†…å­˜æ³„æ¼çš„é—®é¢˜ä»ç„¶æ²¡æœ‰æ‰¾åˆ°æ ¹æºã€‚å› æ­¤å¦‚æœä½ ä¹Ÿé‡åˆ°äº†ï¼Œä¸ç”¨å¤§æƒŠå°æ€ªçš„æ€€ç–‘è‡ªå·±å§¿åŠ¿ä¸å¯¹ï¼Œè€è€å®å®çš„ä¸Š supervisor æ¥ä¿æŠ¤è¿™ä¸ªè¿›ç¨‹å³å¯ã€‚ç›®å‰æ²¡æœ‰æ›´å¥½çš„è§£å†³åŠæ³•ï¼Œé—®é¢˜å¾ˆæ—©å°±å·²ç»è¢«è®¸å¤šäººå‘ç°äº†ï¼Œåˆ°ç°åœ¨ä¹Ÿæ²¡äººèƒ½è§£å†³ï¼Œå®ä¹ƒå‘çˆ¹ã€‚</p>
<p>è¿™é‡Œæä¾›å…¶ä¸­<a href="https://github.com/ethereum/go-ethereum/issues/16728" target="_blank" rel="external">ä¸€ä¸ªé—®é¢˜çš„åœ°å€</a>ï¼Œæœ‰å¾ˆå¤šç›¸å…³çš„å¯ä»¥æŸ¥ã€‚</p>
<p>ä»¤äººæƒŠå¥‡çš„æ˜¯ï¼Œæ— è®ºæ˜¯å…¶ä»–äººè¿˜æ˜¯æˆ‘çš„ç»å†ï¼Œåœ¨ supervisor ç›‘æ§é‡å¯äº†å‡ åå›è¿›ç¨‹ä¹‹åï¼ŒGeth å¯¹äºå†…å­˜çš„å ç”¨ç«Ÿç„¶ç¨³å®šç»´æŒåœ¨äº†æˆ‘è®¾ç½®çš„ 2G ä»¥å†…ï¼Œç›®å‰ä¸ºæ­¢è¿ç»­è¿è¡Œäº†ä¸€å‘¨ï¼Œæ²¡æœ‰å‘ç”Ÿä¸€æ¬¡å´©æºƒã€‚Hell knowsï¼ŒğŸ¤¦â€â™€ï¸ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>è¿™ä¸¤å¤©æ ¹æ®ç½‘ä¸Šèƒ½æœåˆ°çš„æ‰€æœ‰çš„æ•™ç¨‹å’Œæ–‡æ¡£ï¼Œè¯•ç€æ­å»ºäº†ä¸€ä¸ªä»¥å¤ªåŠç§æœ‰é“¾ + iOS é’±åŒ… / åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œè¸©äº†ä¸€äº›å‘ï¼Œä¸€æ¥è¦æ‰¾åˆ°è¿™äº›å‘çš„è§£å†³åŠæ³•æ¯”è¾ƒæ›²æŠ˜ï¼ŒäºŒæ¥è¿™ç±»æ•™ç¨‹çš„åŒè´¨åŒ–å¤ª]]>
    </summary>
    
      <category term="Ethereum" scheme="http://sergiochan.github.io/tags/Ethereum/"/>
    
      <category term="Blockchain è¸©å‘æ—¥è®°" scheme="http://sergiochan.github.io/categories/Blockchain-%E8%B8%A9%E5%9D%91%E6%97%A5%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å°‘å¹´ç»´ç‰¹ä¹‹çƒ¦æ¼-ç®—æ³•å¥½åƒä¹ˆ]]></title>
    <link href="http://sergiochan.github.io/2016/12/23/%E5%B0%91%E5%B9%B4%E7%BB%B4%E7%89%B9%E4%B9%8B%E7%83%A6%E6%81%BC-%E7%AE%97%E6%B3%95%E5%A5%BD%E5%90%83%E4%B9%88/"/>
    <id>http://sergiochan.github.io/2016/12/23/å°‘å¹´ç»´ç‰¹ä¹‹çƒ¦æ¼-ç®—æ³•å¥½åƒä¹ˆ/</id>
    <published>2016-12-23T09:07:22.000Z</published>
    <updated>2016-12-23T09:09:08.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>â€”â€”â€”â€”èœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœåˆ†å‰²çº¿â€”â€”â€”â€”</p>
<p>æ˜¨å¤©åœ¨ HackerRank ä¸Šåˆ·äº†å››é“é¢˜ï¼Œå…¶å®å‰ä¸‰é“èŠ±äº†ä¸åˆ°ä¸€ä¸ªå°æ—¶ï¼Œæœ€åä¸€é“çœŸæ˜¯ç‚¸è£‚æˆ‘çš„èŠèŠ±ï¼Œ10 ä¸ª Test Case å°½åŠ›ä¼˜åŒ–åä¹Ÿæ‰è¿‡äº† 8 ä¸ªï¼Œä¸åœçš„è¶…æ—¶ï¼Œå¦‚æœåœ¨å››åäº”åˆ†é’Ÿä¹‹å†…åšå‡ºçš„è§£æ³•ä¼°è®¡æˆ‘åªèƒ½è¿‡ä¸¤ä¸ª Test Caseï¼Œæ‰‹åŠ¨å¾®ç¬‘ã€‚çœŸæ˜¯èœçš„æŠ è„šã€‚è¿™ç¯‡åšå®¢å†™çš„å·®ä¸å¤šçš„æ—¶å€™åˆç»§ç»­å»ä¼˜åŒ–äº†ä¸€ç•ªæ‰æŠŠæ‰€æœ‰çš„ Test Case éƒ½è¿‡äº†â€¦â€¦</p>
<p>ä¸‹é¢è®°å½•ä¸€ä¸‹è¿™å¥‡è‘©çš„å‡ é¢˜ï¼ŒçœŸæ˜¯å’Œ LeetCode æˆªç„¶ä¸åŒçš„é£æ ¼ã€‚</p>
<p>â€”â€”â€”â€”èœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœåˆ†å‰²çº¿â€”â€”â€”â€”</p>
<h3 id="Encircular"><a href="#Encircular" class="headerlink" title="Encircular"></a>Encircular</h3><p>åŸé¢˜ï¼š</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>Determine whether a sequence of commands will restrict the robotâ€™s movements within a circle.</p>
<p>You are working on a computer simulation of a mobile robot. The robot moves on an infinite plane, starting from position <strong>(0, 0)</strong>. Its movements are described by a command string consisting of one or more of the following three letters:</p>
<ul>
<li>G instructs the robot to move forward one step</li>
<li>L instructs the robot to turn left.</li>
<li>R instructs the robot to turn right.</li>
</ul>
<p>The robot performs the instructions in a command and repeats them for an infinite time. You want to know whether or not there exists some circle whose radius is a positive real number such that the robot always moves within the circle and never leaves it.</p>
<p>Complete the <strong>doesCircleExist</strong> function in the editor below. It has one parameter: an array of strings, <strong>commands</strong>. The function must return an array of <strong>n</strong> strings where each element <strong>i</strong> denotes whether or not performing <strong>commands i</strong> on an infinite loop will restrict the robotâ€™s movements to a circle. If the instruction restricts the robotâ€™s movement to a circle, set index <strong>i</strong> to <strong>â€œYESâ€</strong>; otherwise, set it to <strong>â€œNOâ€</strong>.</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>å¤§æ„å°±æ˜¯æœ‰ä¸‰ç§æ“ä½œï¼Œå‰è¿›ï¼ˆåœ¨å½“å‰å‘é‡ä¸ŠåŠ ä¸Šæ–¹å‘å‘é‡ <em> è·ç¦» 1ï¼‰ï¼Œå·¦è½¬ï¼Œå³è½¬ï¼ˆå·¦å³è½¬éƒ½æ˜¯åœ¨ä¿®æ”¹å½“å‰çš„æ–¹å‘å‘é‡ï¼‰ï¼Œç„¶åç»™ä½ ä¸€ä¸ªå‘½ä»¤ä¸²ï¼Œä¾‹å¦‚ <strong>GLGLGLGR</strong> ï¼Œè¿™ä¸ªå‘½ä»¤ä¸²ä¼šæ— é™å¾ªç¯é‡å¤ï¼Œé—®æœ€ç»ˆä¼šä¸ä¼šå½¢æˆä¸€ä¸ªé—­åˆçš„å›¾å½¢ã€‚æ²¡é”™ï¼Œä¸ç”¨æƒ³çš„å¤ªå¤æ‚ï¼Œå°±æ˜¯é—®ä½ æœ€ç»ˆä¼šä¸ä¼šå½¢æˆä¸€ä¸ªé—­åˆçš„å›¾å½¢ï¼Œå› ä¸ºæ¯ä¸€æ®µå‘½ä»¤æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ–¹å‘åªæœ‰å››ç§ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´ï¼Œ<em>*å¦‚æœåœ¨å››æ­¥æ“ä½œç»“æŸçš„æ—¶å€™æ²¡æœ‰å›åˆ°åŸç‚¹ï¼Œå®ƒå°±å†ä¹Ÿå›ä¸æ¥äº†ï¼Œä¹Ÿä¸å¯èƒ½æˆä¸ºä¸€ä¸ª é™å®šèŒƒå›´ å†…è¿åŠ¨çš„è½¨è¿¹äº†</em></em>ã€‚</p>
<p>è¿™ä¸€ç‚¹éå¸¸é‡è¦ = = ä¸ç„¶ç”»äº†åŠå¤©è½¨è¿¹æ‰¾äº†åŠå¤©è§„å¾‹ä¹Ÿçœ‹ä¸å‡ºä¸ªæ‰€ä»¥ç„¶ï¼Œæ€»æ˜¯å»æƒ³ <strong>å¯èƒ½å‘ç”Ÿ</strong> çš„ Corner caseã€‚ç„¶è€Œå°±è¿™ä¹ˆç®€å•ã€‚è‡³äºæ–¹å‘å‘é‡ï¼Œæˆ–è€…ç”¨ä¸ç”¨å‘é‡æ¥è®¡ç®—ç§»åŠ¨éƒ½å¯ä»¥ç”±ä½ å†³å®šï¼Œæˆ‘é¡ºä¾¿æ¸©ä¹ äº†ä¸€ä¸‹å‘é‡æ—‹è½¬çš„çŸ©é˜µä¹˜æ³•ï¼Œæ‰‹åŠ¨å¾®ç¬‘ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">turnRight</span><span class="params">(directionVector)</span>:</span></span><br><span class="line">    x = directionVector[<span class="number">1</span>] * <span class="number">1</span></span><br><span class="line">    y = directionVector[<span class="number">0</span>] * - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (x,y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">turnLeft</span><span class="params">(directionVector)</span>:</span></span><br><span class="line">    x = directionVector[<span class="number">1</span>] * <span class="number">-1</span></span><br><span class="line">    y = directionVector[<span class="number">0</span>] * <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (x,y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fuck</span><span class="params">(commands)</span>:</span></span><br><span class="line">    r = list()</span><br><span class="line">    <span class="keyword">for</span> command <span class="keyword">in</span> commands:</span><br><span class="line">        direction_vector = (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        current_point = (<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>,<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> command:</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> item:</span><br><span class="line">                    <span class="keyword">if</span> c == <span class="string">"G"</span>:</span><br><span class="line">                        current_point = (current_point[<span class="number">0</span>] + direction_vector[<span class="number">0</span>], current_point[<span class="number">1</span>] + direction_vector[<span class="number">1</span>],)</span><br><span class="line">                    <span class="keyword">elif</span> c == <span class="string">"R"</span>:</span><br><span class="line">                        direction_vector = turnRight(direction_vector)</span><br><span class="line">                    <span class="keyword">elif</span> c == <span class="string">"L"</span>:</span><br><span class="line">                        direction_vector = turnLeft(direction_vector)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_point[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> current_point[<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            r.append(<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r.append(<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure>
<h3 id="Elements_in_Tree"><a href="#Elements_in_Tree" class="headerlink" title="Elements in Tree"></a>Elements in Tree</h3><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>You are provided a binary search tree with integers.  Each node has three primary members: <strong>an Integer</strong> (which it holds), <strong>a pointer to its left child</strong>, and <strong>a pointer to its right child</strong>. A function stub is provided in multiple languages.  You need to complete so this function so that it will search for the presence of a specified integer in this tree. If the element (<em>val</em>) is found, return 1. Otherwise return 0. </p>
<p>Each function stub will have its prototype, and an explanation of the data types or classes involved. The section of the program which parses the input and displays the output is complete in each language and will not need to be modified. Your task is to complete the body of the function provided so it returns the correct output.</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>ç®€å•çš„æ ‘æŸ¥æ‰¾ã€‚ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPresent</span><span class="params">(root,val)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> root.value == val:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> root.left <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> isPresent(root.left,val):</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> root.right <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            <span class="keyword">if</span> isPresent(root.right,val):</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure>
<h3 id="Spiral_Matrix"><a href="#Spiral_Matrix" class="headerlink" title="Spiral Matrix"></a>Spiral Matrix</h3><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>Example:</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span></span><br><span class="line"><span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"><span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span></span><br></pre></td></tr></table></figure>
<p>should be printed as 1,2,3,6,9,8,7,4,5</p>
<p><strong>Input:</strong></p>
<p>You will read input from STDIN and print output to STDOUT.</p>
<p>The first line of input consists of 2 numbers, separated by a comma. The first number denotes the number of rows in the matrix, while the second number specifies the number of columns (the matrix doesnâ€™t have to be square).</p>
<p>The remaining lines specify the actual values inside of the matrix. Each line represents a row, the values inside a separated by commas.</p>
<p><strong>Output:</strong></p>
<p>All values from the matrix in the spiral order (clockwise, starting from top left), separated by commas. </p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>è¿™ä¹Ÿæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ç®€å•çš„ç§»åŠ¨å½“å‰è¾“å‡ºçš„ x,y æŒ‡é’ˆç„¶åéå†äºŒç»´æ•°ç»„å³å¯ï¼Œåœ¨æŒ‡é’ˆè½¬å¼¯çš„æ—¶å€™ç»´æŠ¤ä¸€ä¸‹å½“å‰çš„è¾¹ç•Œã€‚ä»£ç ï¼š</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line"><span class="attr">k</span> = raw_input().split(<span class="string">","</span>)</span><br><span class="line"><span class="attr">row_num</span> = int(k[<span class="number">0</span>])</span><br><span class="line"><span class="attr">column_num</span> = int(k[<span class="number">1</span>])</span><br><span class="line"><span class="attr">g</span> = list()</span><br><span class="line"><span class="attr">output</span> = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">0</span>,row_num):</span><br><span class="line">    <span class="attr">t</span> = raw_input().split(<span class="string">","</span>)</span><br><span class="line">    g.append(t)</span><br><span class="line"></span><br><span class="line"><span class="attr">left</span> = row_num * column_num</span><br><span class="line"><span class="attr">pointer_x</span> = <span class="attr">pointer_y</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">left_x</span> = <span class="attr">top_y</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">right_x</span> = column_num - <span class="number">1</span></span><br><span class="line"><span class="attr">bottom_y</span> = row_num - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">direction</span> = <span class="number">1</span></span><br><span class="line">while left &gt; <span class="number">0</span> :</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">left</span> == <span class="number">1</span>:</span><br><span class="line">        output += str(g[pointer_y][pointer_x])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += str(g[pointer_y][pointer_x]) + <span class="string">","</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="attr">direction</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">pointer_x</span> == right_x:</span><br><span class="line">            pointer_y += <span class="number">1</span></span><br><span class="line">            <span class="attr">direction</span> = <span class="number">2</span></span><br><span class="line">            <span class="attr">top_y</span> = pointer_y</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pointer_x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    elif <span class="attr">direction</span> == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">pointer_y</span> == bottom_y:</span><br><span class="line">            pointer_x <span class="attr">-=</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">direction</span> = <span class="number">3</span></span><br><span class="line">            <span class="attr">right_x</span> = pointer_x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pointer_y += <span class="number">1</span></span><br><span class="line">    elif <span class="attr">direction</span> == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">pointer_x</span> == left_x:</span><br><span class="line">            pointer_y <span class="attr">-=</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">direction</span> = <span class="number">4</span></span><br><span class="line">            <span class="attr">bottom_y</span> = pointer_y</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pointer_x <span class="attr">-=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="attr">pointer_y</span> == top_y:</span><br><span class="line">            pointer_x += <span class="number">1</span></span><br><span class="line">            <span class="attr">direction</span> = <span class="number">1</span></span><br><span class="line">            <span class="attr">left_x</span> = pointer_x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pointer_y <span class="attr">-=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">left</span> = left - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print output</span><br></pre></td></tr></table></figure>
<h3 id="Lego_Block"><a href="#Lego_Block" class="headerlink" title="Lego Block"></a>Lego Block</h3><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>You have 4 types of Legoâ„¢ blocks, of sizes (1 x 1 x 1), (1 x 1 x 2), (1 x 1 x 3), and (1 x 1 x 4). Assume that you have an infinite number of blocks of each type. For brevity, we can call these types, respectively, the 1-block, 2-block, 3-block and 4-block, or even (1), (2), (3) and (4).</p>
<p>Using these blocks, you want to make a wall of height <strong>*N*</strong> and width <strong>*M*</strong>. The wall should be a solid continuous structure with no holes. The wall should be structurally connected, so no straight vertical should exist that would allow the wall to be separated in two without cutting one or more bricks.</p>
<p><strong>Input:</strong><br>The first line contains the number of test cases <strong>*T*</strong>. <strong>*T*</strong> test cases follow. Each case contains two integers, <strong>*N*</strong> and <strong>*M*</strong>.</p>
<p><strong>Output:</strong><br>Output <strong>*T*</strong> lines, one for each test case, containing the number of ways to build the wall.<br>As the numbers can be very large, output the result modulo 1,000,000,007.</p>
<p><strong>Constraints:</strong><br>1 â‰¤ T â‰¤ 100<br>1 â‰¤ N,M â‰¤ 1000</p>
<p><strong>Sample Input:</strong><br>4<br>2 2<br>3 2<br>2 3<br>4 4</p>
<p><strong>Sample Output:</strong><br>3<br>7<br>9<br>3375</p>
<p><strong>Explanation:</strong></p>
<ul>
<li><p>For the first case, the 3 ways are:two 2-blocks stacked one on top of another.one 2-block  stacked on top of two 1-blocks.two 1-blocks stacked on top of one 2-block.</p>
</li>
<li><p>For the second case,</p>
<ul>
<li>each row of the wall can contain either two blocks of width 1, or one block of width 2. However, the wall where all rows contain two blocks of width 1 is not a solid one as it can be divided vertically.</li>
<li>Thus, the number of ways is 2 Ã— 2 Ã— 2 - 1 = 7.</li>
</ul>
</li>
<li><p>For the third case,</p>
<ul>
<li>A 3-unit course of brick can be built four ways:<ul>
<li>Three singles (1,1,1)</li>
<li>One triple (3)</li>
<li>A double before a single (2,1)</li>
<li>A single before a double (1,2)</li>
</ul>
</li>
<li>Any of the four patterns above can go on top of the (3) or on bottom of the (3). Total: 8.</li>
<li>If we do not use a 3, then the only other stable pattern is (2,1) on top of (1,2). Cumulative total: 9.</li>
</ul>
</li>
<li><p>For the fourth case, we have</p>
<ul>
<li><p>8 ways of building each of the four layers of bricks:</p>
<ul>
<li>1,1,1,1</li>
<li>1,1,2</li>
<li>1,2,1</li>
<li>2,1,1</li>
<li>1,1</li>
<li>1,3</li>
<li>3,1 </li>
<li>4</li>
</ul>
<p>Total number of patterns: </p>
<p>8^4= 4,096</p>
</li>
<li><p>Of these <em>4,096</em> patterns, some will fail to satisfy the structural integrity condition. So we need to subtract the patterns that contain a vertical split. There are <em>3</em> vertical seams that provide possible locations for the vertical split, and <em>7</em> ways of placing any of 1, 2 or 3 splits among these 3 seams.There is exactly one way to have three splits, one on each of the three vertical seams (4 4-high towers of 1-block bricks) .  </p>
<p><strong>Cumulative: <em>4,096 - 1 = 4,095</em>.</strong></p>
</li>
<li><p>If we have two splits, along the left and middle seams, then there are two 1-block towers and one 4-high, 2-wide tower.Exactly one way to build two 4-high towers of 1-blocks15 ways to build the 4-high, 2-wide sub-wall:(1,1) or (2)repeated for at any of four layers,minus the separable pattern where the (1,1) layer repeats 4 times.<em>15 Ã— 1 = 15 ways</em> to have two splits, one along the left seam an done along the middle seam.Similarly, two splits, left and right seams: <em>15 ways</em>And two splits, middle and right seams <em>15 ways</em></p>
<p><strong>Cumulative <em>4,095 - 15 - 15 - 15 = 4,050</em>.</strong></p>
</li>
<li><p>If we have exactly one split down the middle, this meansthere are two separate non-splitting 4-high, 2-wide walls.Each such wall can be built 24-1=15 ways (as above).The count of walls that can split once down the middle is thus <em>15 Ã— 15 = 225.</em> </p>
<p><strong>Cumulative: <em>4,050 - 225 = 3,825.</em></strong></p>
</li>
<li><p>Exactly one split along the leftmost seam:There is one tower of 1-bricks on the left next to a 4-high, 3-wide wall.The ways of building the 4-high, 3-wide wall are: 44 = 256 <em>is the number of ways of repeating any of (1,1,1) or (3) or (2,1) or (1,2) four timesof these 256 patterns, some are separable, hence already accounted for before in the enumerationthe three 1-block towers: one patternone two-wide, four-high tower on the right next to a 1-block tower: 15 patterns (derivation above)ditto on the left: 15 patterns</em></p>
<p><strong>Total: 256* - 15 - 15 - 1 = 225</strong></p>
</li>
<li><p>Ditto for a split along the rightmost seam: 225 <em>ways</em></p>
<p><strong>Cumulative : <em>3,825 - 225 - 225 = 3,375</em>.</strong></p>
</li>
</ul>
</li>
</ul>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>è¯´å®è¯ï¼Œé¢˜ç›®æˆ‘çœ‹äº†ä¸€ä¸ªå°æ—¶æ‰ä»å¤´çœ‹æ‡‚åˆ°å°¾ï¼ˆç¬‘ï¼Œå…¶å®é¢˜ç›®é‡Œæä¾›äº†å¾ˆå¤šä¿¡æ¯ï¼Œè§£é¢˜çš„æ—¶å€™å¿½ç•¥äº†ï¼Œç„¶ååˆå›å¤´è¯»é¢˜ï¼Œåˆ°æœ€åæ‰¾åˆ°è§£æ³•äº†æ‰å½»åº•è¯»é€ï¼Œè¿™é¢˜å’Œç¬¬ä¸€é¢˜å¥½åƒéƒ½å‡ºç°åœ¨è°·æ­Œçš„é¢è¯•é¢˜ä¸­è¿‡ï¼Œä½†æ˜¯è¿™é¢˜æœ€å¤§çš„é—®é¢˜ä¸åœ¨äºè§£æ³•ï¼Œåœ¨äºæ—¶é—´å¤æ‚åº¦å’Œå®é™…çš„è¿è¡Œæ—¶é—´ä¸Šã€‚</p>
<p>è¿™é“é¢˜ç®€å•æ¥è¯´å¯ä»¥ç†è§£ä¸ºæ¨ªç€æ”¾çš„ä¹é«˜ç§¯æœ¨ï¼Œæ€»å…±æœ‰å››ç§å—ï¼Œåˆ†åˆ«é•¿ 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œç”¨è¿™äº›é•¿åº¦çš„ç§¯æœ¨æ¥å †ç§¯ä¸€ä¸ª N <em> M çš„å¢™ï¼Œç”±äºæ¯ä¸€å±‚çš„å®½åº¦ä¸€è‡´ï¼Œå¦‚æœæˆ‘ä»¬ä»¤ K ä¸ºæ¯ä¸€å±‚çš„æ‰€æœ‰ç»„åˆå¯èƒ½æ€§çš„æ•°é‡ï¼ŒM ä¸ºå…¶é«˜åº¦ï¼Œå³å±‚æ•°ï¼Œé‚£ä¹ˆ<em>*æ•´ä½“æ’å¸ƒçš„å¯èƒ½æ€§å°±ç­‰äº K çš„ M æ¬¡å¹‚</em></em>ï¼Œç”±äºè¿™é‡Œæ¶‰åŠåˆ°äº† Bignumï¼Œè¿™é‡Œè¿˜è¦åœ¨å¹‚è¿ç®—çš„åŒæ—¶åšä¸ªæ¨¡ 1,000,000,007 çš„è¿ç®—ã€‚</p>
<p>è®¡ç®— K çš„æ–¹æ³•å°±æ˜¯ä¸ªç®€å•çš„åŠ¨æ€è§„åˆ’ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">K</span><span class="params">(N)</span></span> = K(N-<span class="number">1</span>) + K(N-<span class="number">2</span>) + K(N-<span class="number">3</span>) + K(N-<span class="number">4</span>)</span><br><span class="line"><span class="function"><span class="title">K</span><span class="params">(<span class="number">1</span>)</span></span> = <span class="number">1</span></span><br><span class="line"><span class="function"><span class="title">K</span><span class="params">(<span class="number">2</span>)</span></span> = <span class="number">2</span></span><br><span class="line"><span class="function"><span class="title">K</span><span class="params">(<span class="number">3</span>)</span></span> = <span class="number">4</span></span><br><span class="line"><span class="function"><span class="title">K</span><span class="params">(<span class="number">4</span>)</span></span> = <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>åŠ¨æ€è§„åˆ’ç®—å‡ºäº†æ¯ä¸€å±‚çš„å¯èƒ½æ€§ä¹‹åï¼Œè¿˜è¦ç»§ç»­è€ƒè™‘å¤šå±‚ä¹‹é—´ä¸èƒ½å‡ºç°è¿ç»­åˆ†å‰²çš„æƒ…å†µã€‚ä¾‹å¦‚æ¯ä¸€å±‚çš„æœ€å³è¾¹éƒ½æ˜¯ 1 å•ä½çš„å—ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªè¿ç»­çš„åˆ†å‰²ï¼Œè¿™ç§æƒ…å†µå°±éœ€è¦è¢«æ’é™¤ã€‚è¿™é‡Œä¹Ÿæ˜¯ä¸€å±‚åŠ¨æ€è§„åˆ’ï¼Œå³å¦‚æœå®½åº¦ä¸º Nï¼Œé‚£ä¹ˆå®½åº¦ä¸º n ï¼Œé«˜åº¦ä¸º M çš„å¢™ä¸ä¼šå‡ºç°è¿ç»­åˆ†å‰²çš„å¯èƒ½æƒ…å†µï¼ˆé¢˜ä¸­çš„ Solid Wallï¼‰ï¼Œå°±ç­‰äºå®½åº¦ä¸º n é«˜åº¦ä¸º M çš„æ‰€æœ‰å¯èƒ½æ€§ç»„åˆï¼Œå‡å»<strong>æ‰€æœ‰å‡ºç°è¿ç»­åˆ†å‰²çš„æƒ…å†µæ•°</strong>ã€‚</p>
<p>ä¸ºäº†è®¡ç®—æ‰€æœ‰<strong>å‡ºç°è¿ç»­åˆ†å‰²</strong>çš„æƒ…å†µæ•°ï¼Œæˆ‘ä»¬éœ€è¦å°†å®½åº¦ä¸º n çš„å¢™åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ Solid Wallï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å‡ºç°åˆ†å‰²çš„æƒ…å†µ S(n)ï¼Œä¹˜ä»¥å‰©ä¸‹çš„éƒ¨åˆ†æ‰€æœ‰çš„å¯èƒ½æ€§ <em>è¿™é‡Œçš„ S(n) ä¹Ÿå°±æ˜¯è‡ªèº«ï¼Œæˆ‘ä»¬å¯ä»¥é€’å½’å°†å…¶åˆ†å‰²åˆ°æœ€å°çš„ S(1) = 1</em>ã€‚å¦‚æœå®½åº¦ä¸º 4 ï¼Œåˆ™å®½åº¦ä¸º 4 å‡ºç°è¿ç»­åˆ†å‰²çš„æƒ…å†µï¼Œåˆ†åˆ«æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>å·¦è¾¹ä¸€åˆ—å…¨æ˜¯ 1ï¼Œå³è¾¹ä¸‰åˆ—ä»»æ„æ’å¸ƒï¼›</li>
<li>å·¦è¾¹ä¸¤åˆ—ä¸å‡ºç°è¿ç»­åˆ†å‰²ï¼ˆè‹¥å‡ºç°è¿ç»­åˆ†å‰²ï¼Œå³åŒ…å«äº†å‰é¢çš„é‚£ç§æƒ…å†µï¼‰ï¼Œå³è¾¹ä¸¤åˆ—ä»»æ„æ’åˆ—ï¼›</li>
<li>å·¦è¾¹ä¸‰åˆ—ä¸å‡ºç°è¿ç»­åˆ†å‰²ï¼ˆè‹¥å‡ºç°è¿ç»­åˆ†å‰²ï¼Œåˆ™åŒ…å«äº†å‰é¢ä¸¤ç§æƒ…å†µï¼‰ï¼Œå³è¾¹ä¸€åˆ—å…¨æ˜¯ 1ã€‚</li>
</ul>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿˜æœ‰ä¸€ç§å·¦è¾¹ä¸€åˆ— 1 å³è¾¹ä¸€åˆ— 1 ä¸­é—´ä¸€åˆ— 2 çš„æƒ…å†µï¼Œä½†æ˜¯å…¶å®ä»–ä»¬åŒ…å«åœ¨äº†ç¬¬ä¸€ç§æƒ…å†µé‡Œï¼Œå› ä¸ºç¬¬ä¸€ç§æƒ…å†µé‡Œå³è¾¹ä¸‰åˆ—æ˜¯ä»»æ„æ’å¸ƒçš„ã€‚å…¶å®è¿™ä¸ªè§„å¾‹ï¼Œé¢˜ç›®çš„ä¸€å¤§å †å™è¿°ä¸­ç¡®å®ç»™å‡ºäº†çº¿ç´¢â€¦â€¦å°±æ˜¯éœ€è¦è¯»é¢˜äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºå…¬å¼ï¼š</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">S<span class="comment">(N)</span> = K<span class="comment">(N)</span> ^ M - SUM<span class="comment">(i)</span><span class="comment">(S(i)</span> * <span class="comment">(K(N - i)</span> ^ M)) <span class="comment">(0 &lt; i &lt; N)</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œæ¥ä¸‹æ¥æœ€ä¸»è¦çš„äº‹æƒ…å‡ºç°äº†ï¼ŒæŒ‰ç…§ä»¥ä¸Šé€»è¾‘å†™å‡ºçš„åµŒå¥—åŠ¨æ€è§„åˆ’ï¼ˆ K(N) éœ€è¦åŠ¨æ€è§„åˆ’æ¥è®¡ç®—å‡ºæ¥ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦åœ¨ <strong>ç¼“å­˜äº† K (N)</strong> ä¹‹åæ˜¯ O(N^2)ï¼Œ ç„¶è€Œç”±äºæ¯ä¸€æ¬¡ K (N) å³ä½¿æ˜¯ä»ç¼“å­˜ä¸­è¯»å–ï¼Œä¹Ÿä»ç„¶éœ€è¦åšä¸€æ¬¡å¹‚æ¨¡è¿ç®—ï¼Œå› ä¸ºæ¯ä¸€æ¬¡è§£çš„æ—¶å€™ M éƒ½æ˜¯ä¸åŒçš„ï¼Œè€Œå®ƒè¦æ±‚æœ€å¤šä¸€æ¬¡ input 100 ä¸ª N * M ï¼Œè¿™å°±è¦æ±‚å¤æ‚åº¦æ›´åŠ ç²¾ç®€ã€‚åœ¨åŒä¸€æ¬¡è§£çš„è¿‡ç¨‹ä¸­ï¼ŒS(i) ä¹Ÿæ˜¯å¯ä»¥ç¼“å­˜çš„ã€‚</p>
<p>ä»£ç ï¼š</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">import <span class="built_in">time</span></span><br><span class="line">import <span class="built_in">array</span></span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.cache_count_fuck_dict = [None] * <span class="number">1000</span></span><br><span class="line">        self.cache_count = [<span class="number">0</span>] * <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">    def findSolutionCount(self,<span class="built_in">width</span>):</span><br><span class="line">        # <span class="built_in">print</span> <span class="built_in">width</span></span><br><span class="line">        g = <span class="built_in">width</span> - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.cache_count[g] != <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">return</span> self.cache_count[g]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">width</span> &gt; <span class="number">4</span>:</span><br><span class="line">            f = int(pow(self.findSolutionCount(g) + self.findSolutionCount(<span class="built_in">width</span> - <span class="number">2</span>) + self.findSolutionCount(<span class="built_in">width</span> - <span class="number">3</span>) + self.findSolutionCount(<span class="built_in">width</span> - <span class="number">4</span>),<span class="number">1</span>,<span class="number">1000000007</span>))</span><br><span class="line">            self.cache_count[g] = f</span><br><span class="line">            <span class="built_in">return</span> f</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">return</span> int(pow(<span class="number">2</span>,<span class="built_in">width</span> - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    def findTotalSolutionCountForWidth(self,<span class="built_in">width</span>,<span class="built_in">height</span>):</span><br><span class="line">        <span class="keyword">if</span> self.cache_count_fuck[<span class="built_in">width</span> - <span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">            # self.totalKTime += <span class="built_in">time</span>.<span class="built_in">time</span>() - now_f</span><br><span class="line">            <span class="built_in">return</span> self.cache_count_fuck[<span class="built_in">width</span> - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            f = int(pow(self.findSolutionCount(<span class="built_in">width</span>),<span class="built_in">height</span>,<span class="number">1000000007</span>))</span><br><span class="line">            self.cache_count_fuck[<span class="built_in">width</span> - <span class="number">1</span>] = f</span><br><span class="line">            # self.totalKTime += <span class="built_in">time</span>.<span class="built_in">time</span>() - now_f</span><br><span class="line">            <span class="built_in">return</span> f</span><br><span class="line"></span><br><span class="line">    def findBlock(self,<span class="built_in">height</span>,<span class="built_in">width</span>):</span><br><span class="line"></span><br><span class="line">        self.<span class="built_in">height</span> = <span class="built_in">height</span></span><br><span class="line">        <span class="keyword">if</span> self.cache_count_fuck_dict[<span class="built_in">height</span>] <span class="built_in">is</span> <span class="keyword">not</span> None:</span><br><span class="line">            self.cache_count_fuck = self.cache_count_fuck_dict[<span class="built_in">height</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cache_count_fuck = [<span class="number">0</span>] * <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">        self.cache_count_block = [None] * <span class="built_in">width</span></span><br><span class="line">        g = [<span class="number">0</span>] * <span class="number">1000</span></span><br><span class="line">        self.cache_block = <span class="built_in">array</span>.<span class="built_in">array</span>('l', g)</span><br><span class="line"></span><br><span class="line">        d = self.<span class="built_in">block</span>(<span class="built_in">width</span>,<span class="built_in">height</span>)</span><br><span class="line">        self.cache_count_fuck_dict[<span class="built_in">height</span>] = self.cache_count_fuck</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> d</span><br><span class="line"></span><br><span class="line">    def <span class="built_in">block</span>(self,<span class="built_in">width</span>,<span class="built_in">height</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">width</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">width</span>,<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> self.cache_count_block[i] <span class="built_in">is</span> <span class="keyword">not</span> None:</span><br><span class="line">                b_count = self.cache_count_block[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                b_count = self.<span class="built_in">block</span>(i,<span class="built_in">height</span>)</span><br><span class="line">                self.cache_count_block[i] = b_count</span><br><span class="line">            <span class="keyword">if</span> self.cache_count_fuck[<span class="built_in">width</span> - i - <span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">                b_count *= self.cache_count_fuck[<span class="built_in">width</span> - i - <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                k = self.findTotalSolutionCountForWidth(<span class="built_in">width</span> - i,<span class="built_in">height</span>)</span><br><span class="line">                self.cache_count_fuck[<span class="built_in">width</span> - i - <span class="number">1</span>] = k</span><br><span class="line">                b_count *= k</span><br><span class="line"></span><br><span class="line">            count += b_count</span><br><span class="line">        r = int((self.findTotalSolutionCountForWidth(<span class="built_in">width</span>,<span class="built_in">height</span>)  - count) <span class="symbol">%</span> <span class="number">1000000007</span>)</span><br><span class="line">        <span class="built_in">return</span> r</span><br><span class="line">            </span><br><span class="line">t = Solution()</span><br><span class="line"></span><br><span class="line"># l = [(<span class="number">2</span>,<span class="number">3</span>),(<span class="number">3</span>,<span class="number">2</span>),(<span class="number">4</span>,<span class="number">4</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">200</span>,<span class="number">800</span>),(<span class="number">300</span>,<span class="number">800</span>),(<span class="number">400</span>,<span class="number">800</span>),(<span class="number">500</span>,<span class="number">800</span>),(<span class="number">600</span>,<span class="number">800</span>),(<span class="number">700</span>,<span class="number">800</span>),(<span class="number">340</span>,<span class="number">800</span>),(<span class="number">750</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">800</span>,<span class="number">800</span>),(<span class="number">4</span>,<span class="number">4</span>)]</span><br><span class="line">l = [(<span class="number">800</span>,<span class="number">800</span>)]</span><br><span class="line"></span><br><span class="line">import <span class="built_in">time</span></span><br><span class="line">now_f = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,len(l),<span class="number">1</span>):</span><br><span class="line">    now = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">    <span class="built_in">print</span> t.findBlock(l[i][<span class="number">0</span>],l[i][<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span> <span class="string">"takes : "</span> + str(<span class="built_in">time</span>.<span class="built_in">time</span>() - now) + <span class="string">" s"</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">"total takes : "</span> + str(<span class="built_in">time</span>.<span class="built_in">time</span>() - now_f) + <span class="string">" s"</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ±‚å¹‚æ¨¡æ“ä½œçš„æ—¶å€™ï¼Œç”±äº Math.pow ä¸æ”¯æŒ Bigint è¿ç®—ï¼Œæ‰€ä»¥æˆ‘ä¸€å¼€å§‹æ¢äº† **ï¼Œåæ¥æŸ¥äº†ä¸€ä¸‹å‘ç°ç”¨ pow(x,y,z) æ˜¯å¯ä»¥ç›´æ¥æ±‚å¹‚æ¨¡çš„ï¼Œè€Œä¸”æ€§èƒ½æ›´å¥½ï¼š</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">pow(x, y[, z]) -&gt; <span class="built_in">number</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">With</span> two arguments, equivalent <span class="keyword">to</span> x**y.  <span class="keyword">With</span> three arguments,</span><br><span class="line">equivalent <span class="keyword">to</span> (x**y) % z, but may be more efficient (e.g. <span class="keyword">for</span> longs).</span><br></pre></td></tr></table></figure>
<p>å°†ç¼“å­˜ä» Dict æ¢æˆ List ä¹Ÿæœ‰ä¸€å®šæ€§èƒ½æå‡ï¼Œè¿™é¢˜æ€»å…±æœ‰åä¸ª Test Caseï¼ŒåŸºæœ¬ä¸Šå‰ä¸¤ä¸ªæ•°å€¼å°å’Œå°‘çš„ case è¿‡äº†å°±åŸºæœ¬è¯´æ˜ç®—æ³•æ²¡ä»€ä¹ˆé—®é¢˜äº†ï¼Œä¸€å¼€å§‹åé¢å…«ä¸ª Case å…¨éƒ¨éƒ½è¶…æ—¶ï¼Œåæ¥ä¸æ–­åœ°ä¼˜åŒ–ï¼Œæ¢æˆäº† List ç¼“å­˜ï¼Œæ¢æˆäº† powï¼Œå ªå ªè¿‡åˆ°ç¬¬å…«ä¸ª Caseï¼Œå‰©ä¸‹ä¸¤ä¸ªä»ç„¶æ˜¯è¶…æ—¶ã€‚è™½ç„¶æ˜¨å¤©å·²ç»æäº¤å®Œäº†è¿›ä¸å»äº†ï¼Œç„¶è€Œå†™è¿™äº›çš„æ—¶å€™è¿˜æ˜¯ä¸æœæ°”æƒ³ä¼˜åŒ–ä¸€ç•ªï¼Œäºæ˜¯å¼€å§‹äº†é€è¡Œçš„æ—¶é—´è°ƒè¯•ï¼Œæœ€åè¿˜æ˜¯åœ¨ S (N) è¿™ä¸ªå‡½æ•°è¿™é‡Œå†åŠ äº†ä¸€å±‚ç¼“å­˜ä¼˜åŒ–ï¼Œæ€§èƒ½åˆå·®ä¸å¤šæå‡äº†ä¸‰åˆ†ä¹‹ä¸€ã€‚åˆæ³¨å†Œäº†ä¸ªæ–°å·ï¼Œç»ˆäºæŠŠåä¸ª Test Case å…¨è¿‡äº†ã€‚</p>
<p><strong>å°† Dict ç¼“å­˜ä¼˜åŒ–æˆ List å’Œ Array ç¼“å­˜å‰</strong>ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/12/23/585ce726b7a1e.jpeg" alt=""></p>
<p><strong>** æ›¿æ¢æˆ pow(x,y,z)</strong> ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/12/23/585ce726ba3c7.jpeg" alt=""></p>
<p>æœ€ç»ˆï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/12/23/585ce726b9890.jpeg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>â€”â€”â€”â€”èœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœèœåˆ†å‰²çº¿â€”â€”â€”â€”</p>
<p>æ˜¨å¤©åœ¨ HackerRank ä¸Šåˆ·äº†å››é“é¢˜ï¼Œå…¶å®å‰ä¸‰é“èŠ±äº†ä¸åˆ°ä¸€ä¸ªå°æ—¶ï¼Œæœ€åä¸€é“çœŸæ˜¯ç‚¸è£‚æˆ‘çš„èŠèŠ±]]>
    </summary>
    
      <category term="ç®—æ³•" scheme="http://sergiochan.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[åš Custom Keyboard çš„æ—¶å€™é‡åˆ°çš„å‡ ä¸ªé—®é¢˜]]></title>
    <link href="http://sergiochan.github.io/2016/12/07/%E5%81%9A-Custom-Keyboard-%E7%9A%84%E6%97%B6%E5%80%99%E9%81%87%E5%88%B0%E7%9A%84%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98/"/>
    <id>http://sergiochan.github.io/2016/12/07/åš-Custom-Keyboard-çš„æ—¶å€™é‡åˆ°çš„å‡ ä¸ªé—®é¢˜/</id>
    <published>2016-12-07T07:05:19.000Z</published>
    <updated>2016-12-07T07:07:39.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘åˆåœ¨æä¸ªå¤§æ–°é—»ã€‚è®°å½•äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜å’Œçªé—¨ã€‚</p>
<h2 id="Customize_your_keyboard_height"><a href="#Customize_your_keyboard_height" class="headerlink" title="Customize your keyboard height"></a>Customize your keyboard height</h2><p>åœ¨ <strong>ViewDidLoad</strong> åŠ å…¥è¿™æ®µä»£ç ï¼Œåœ¨ä»»æ„ä½ç½®ä¿®æ”¹è¿™ä¸ª constraint çš„å€¼ç„¶åè°ƒç”¨ <strong>updateViewConstraint</strong> :</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">CGFloat</span> _expandedHeight = <span class="number">300</span>;</span><br><span class="line">_heightConstraint = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem: <span class="keyword">self</span>.view</span><br><span class="line">                             attribute: <span class="built_in">NSLayoutAttributeHeight</span></span><br><span class="line">                             relatedBy: <span class="built_in">NSLayoutRelationEqual</span></span><br><span class="line">                                toItem: <span class="literal">nil</span></span><br><span class="line">                             attribute: <span class="built_in">NSLayoutAttributeNotAnAttribute</span></span><br><span class="line">                            multiplier: <span class="number">0.0</span></span><br><span class="line">                              constant: _expandedHeight];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint: _heightConstraint];</span><br></pre></td></tr></table></figure>
<h2 id="Network_Access_and_other_accesses"><a href="#Network_Access_and_other_accesses" class="headerlink" title="Network Access and other accesses"></a>Network Access and other accesses</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ Keyboard Extension æ˜¯æ²¡æœ‰è®¿é—®ç½‘ç»œçš„æƒé™çš„ï¼Œå› ä¸ºé”®ç›˜æ˜¯æ¯”è¾ƒæ¶‰åŠç”¨æˆ·éšç§çš„æ’ä»¶ï¼Œè™½ç„¶å…¶å®çœŸæ­£èƒ½è·å¾—çš„ä¿¡æ¯å¾ˆå°‘çš„ =ã€‚= éƒ½è¢«æ²™ç›’ä¿æŠ¤èµ·æ¥äº†ã€‚ä½†æ˜¯æ¯•ç«Ÿèƒ½è·å¾—ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬ä¿¡æ¯ï¼Œæœ‰å¯èƒ½ä½ å°±æ˜¯ä¸ªåäººæ¥æ”¶é›†ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå¯†ç ä»€ä¹ˆçš„ï¼Œå¯¹å§ã€‚æ‰€ä»¥éœ€è¦åœ¨å–å¾—ç”¨æˆ·ä¿¡ä»»çš„åŸºç¡€ä¸Šï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨å»è®¾ç½®é‡Œä¸ºé”®ç›˜æ’ä»¶æ‰“å¼€ <strong>å®Œå…¨è®¿é—®</strong> ï¼Œä½ çš„æ’ä»¶æ‰å¯ä»¥è®¿é—®ç½‘ç»œï¼Œä½ç½®ä¿¡æ¯è¿™äº›ã€‚</p>
<p>åœ¨è·å¾—æƒé™ä¹‹å‰ï¼Œä»»ä½•å¯¹ç½‘ç»œçš„è®¿é—®éƒ½ä¼šæŠ¥ä¸€å¤§ä¸²é”™è¯¯ï¼Œæ‰¾ä¸åˆ° DNSï¼ŒæœåŠ¡æœªå¯åŠ¨ä»€ä¹ˆçš„ã€‚ä½ åªéœ€è¦åœ¨ <strong>info.plist</strong> ä¸­è®¾ç½® <strong>NSExtensionAttributes</strong> ä¸­çš„ <strong>RequestsOpenAccess</strong> ä¸º YESï¼Œ ç”¨æˆ·å°±å¯ä»¥åœ¨è®¾ç½®é¡µé¢ä¸­æ‰¾åˆ°æ‰“å¼€å®Œå…¨è®¿é—®çš„å¼€å…³äº†ã€‚</p>
<h2 id="OpenURL_in_Keyboard_Extension"><a href="#OpenURL_in_Keyboard_Extension" class="headerlink" title="OpenURL in Keyboard Extension"></a>OpenURL in Keyboard Extension</h2><p>ç”±äº <strong>[UIApplication sharedApplication]</strong> åœ¨ Extension ä¸­ä¸å¯ç”¨ï¼ŒopenURL åªèƒ½é€šè¿‡ <strong>extensionContext</strong> :</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">[self.extensionContext <span class="string">openURL:</span><span class="string">completionHandler:</span>];</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œå°´å°¬çš„æ˜¯åœ¨ Today Extension ä¸­æ˜¯å¯ä»¥ç”¨çš„ï¼Œåœ¨ Keyboard Extension ä¸­å´æ²¡æœ‰ç”¨ã€‚äºæ˜¯æ‰¾åˆ°äº†ä¸‹é¢è¿™ä¸ªæ›´æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œç›´æ¥é€šè¿‡ <strong>responder chain</strong> æ‰¾åˆ° UIApplication = =</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">UIResponder* responder = self;</span><br><span class="line"><span class="keyword">while</span> ((responder = [responder nextResponder]) != nil) &#123;</span><br><span class="line">    <span class="keyword">if</span> ([responder <span class="string">respondsToSelector:</span><span class="meta">@selector</span>(<span class="string">openURL:</span>)] == YES) &#123;</span><br><span class="line">        [responder <span class="string">performSelector:</span><span class="meta">@selector</span>(<span class="string">openURL:</span>)</span><br><span class="line"><span class="symbol">                        withObject:</span>[NSURL <span class="string">URLWithString:</span>@<span class="string">"sergio.chan.xxx://"</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘åˆåœ¨æä¸ªå¤§æ–°é—»ã€‚è®°å½•äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜å’Œçªé—¨ã€‚</p>
<h2 id="Customize_your_keyboard_height"><a href="#Customize]]>
    </summary>
    
      <category term="Custom Keyboard Extension" scheme="http://sergiochan.github.io/tags/Custom-Keyboard-Extension/"/>
    
      <category term="iOS" scheme="http://sergiochan.github.io/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å‘ - 2016.11.30]]></title>
    <link href="http://sergiochan.github.io/2016/11/30/%E5%9D%91-2016-11-30/"/>
    <id>http://sergiochan.github.io/2016/11/30/å‘-2016-11-30/</id>
    <published>2016-11-30T02:18:29.000Z</published>
    <updated>2016-11-30T02:19:22.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä»Šå¤©å‘å¸ƒä¼šï¼Œå¿™äº†å‡ ä¸ªæœˆçš„æ–°äº§å“ç»ˆäºè¦å‘å¸ƒäº†ã€‚åº”è¯¥ä»Šæ™š<a href="https://www.raventech.com/" target="_blank" rel="external">å®˜ç½‘</a>å°±ä¼šä¸Šçº¿äº†ã€‚</p>
<p>æœ€è¿‘å‡ å¤©éƒ½åœ¨ iOS å®‰å“å’Œ Unity åˆ‡æ¥åˆ‡å»çš„å†™ï¼Œå¤´å¤§çš„å’Œä¸€é”…ç²¥ä¸€æ ·ã€‚é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜æ¯”è¾ƒå‘ï¼š</p>
<h2 id="Unity__u97F3_u7BB1_u566A_u97F3_u95EE_u9898"><a href="#Unity__u97F3_u7BB1_u566A_u97F3_u95EE_u9898" class="headerlink" title="Unity éŸ³ç®±å™ªéŸ³é—®é¢˜"></a>Unity éŸ³ç®±å™ªéŸ³é—®é¢˜</h2><p>åªè¦ Unity è¿è¡Œï¼ŒAndroid å¤–æ¥çš„éŸ³ç®±åœ¨é»˜è®¤åœºæ™¯å°±ä¼šæœ‰ä¸€ä¸ä¸å¥‡æ€ªç”µç£å¹²æ‰°çš„å£°éŸ³ã€‚Unity å½“ä¸­æ²¡æœ‰ä»»ä½• Audio Sourceï¼Œæˆ‘è¯•ç€æŠŠæ‰€æœ‰ Camera ä¸Šçš„ Audio Listener éƒ½ç¦ç”¨äº†ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚</p>
<p>åœ¨ Unity Forum ä¸Šå‘ç°äº†ä¸€ä¸ª<a href="http://answers.unity3d.com/answers/1278290/view.html" target="_blank" rel="external">ç›¸åŒé—®é¢˜</a>ï¼Œä½†æ˜¯ä¸€å¹´äº†å¹¶æ²¡æœ‰äººè§£å†³ã€‚æ©ï¼Œå¦‚æœä½ çœ‹åˆ°äº†ä¸€ä¸ªå›ç­”é‚£æ˜¯æˆ‘åˆšå›ç­”çš„â€¦â€¦æœ€åè¯•äº†å‡ ç§æ–¹æ³•ï¼Œä¸»è¦éƒ½æ˜¯å»ä¿®æ”¹ Project Setting é‡Œé¢çš„ Audio Settingï¼Œé™¤äº† <strong>Disable Unity Audio</strong> å¯ä»¥è§£å†³è¿™ä¸ªå¥‡æ€ªçš„å™ªéŸ³é—®é¢˜ï¼Œåˆ«æ— ä»–æ³•ï¼Œè¿˜å¥½ Unity å¹¶ä¸è´Ÿè´£æ’­æ”¾å£°éŸ³ã€‚</p>
<p>æ›´è¹Šè··çš„æ˜¯æ’ä¸Šè€³æœºå°±å¬ä¸åˆ°è¿™ä¸ªå™ªéŸ³ = = çŒœæµ‹å¯èƒ½æ˜¯éŸ³ç®±æœ‰ç±»ä¼¼æ”¾å¤§å™¨çš„éƒ¨åˆ†ï¼Œå°†åŸæœ¬éå¸¸å¾®å¼±çš„ç”± Unity äº§ç”Ÿçš„å£°éŸ³æ”¾å¤§äº†ä¹‹åå˜æˆäº†å¬åˆ°çš„å™ªéŸ³ã€‚</p>
<p>å‘ã€‚</p>
<h2 id="u5B89_u5353_u542F_u52A8_u84DD_u7259_u670D_u52A1_u7684_u95EE_u9898"><a href="#u5B89_u5353_u542F_u52A8_u84DD_u7259_u670D_u52A1_u7684_u95EE_u9898" class="headerlink" title="å®‰å“å¯åŠ¨è“ç‰™æœåŠ¡çš„é—®é¢˜"></a>å®‰å“å¯åŠ¨è“ç‰™æœåŠ¡çš„é—®é¢˜</h2><p>ç”¨å®‰å“ BluetoothBLE å’Œ iOS çš„ CoreBluetooth è¿æ¥ï¼ŒiOS åšå¤–è®¾ï¼Œå®‰å“åšä¸»æœºã€‚BLE å–æ¶ˆäº† 2.0 æ—¶ä»£çš„è“ç‰™ Socket è¿æ¥æ–¹å¼ï¼Œæ”¹æˆäº†ç°åœ¨çš„<strong>æ ¹æ®ç‰¹å¾å€¼è¯»å–ï¼Œå†™å…¥å’Œè®¢é˜…</strong>çš„è¿™ç§ä¼ è¾“æ•°æ®æ–¹å¼ã€‚ç”¨æ¡†æ¶å¼€å‘å¹¶ä¸å›°éš¾ï¼Œé—®é¢˜å°±å‡ºåœ¨å½“åº”ç”¨åœ¨å¼€æœºè‡ªå¯åŠ¨çš„æ—¶å€™ï¼Œå¯èƒ½åœ¨åˆ›å»º BluetoothManager çš„æ—¶å€™ï¼Œç³»ç»Ÿè“ç‰™æœåŠ¡å°šæœªåˆå§‹åŒ–æˆåŠŸï¼Œå› æ­¤å°±ä¼šæŠ¥é”™ï¼Œè€Œä½ ä¹Ÿä¸çŸ¥é“è¦ä»€ä¹ˆæ—¶å€™æ‰èƒ½å»åˆå§‹åŒ–ã€‚</p>
<p>å› æ­¤åœ¨è¿™é‡Œä½ éœ€è¦åŠ ä¸€ä¸ª BroadCastReceiver æ¥ç›‘å¬ç³»ç»Ÿè“ç‰™æœåŠ¡çŠ¶æ€å˜åŒ–çš„é€šçŸ¥ï¼Œç„¶åæ ¹æ®é€šçŸ¥æ¥å†³å®šåˆå§‹åŒ–çš„æ—¶æœºï¼Œè€Œä¸æ˜¯åœ¨ä½ åº”ç”¨å¯åŠ¨çš„æ—¶å€™å°±å»åˆå§‹åŒ–ã€‚</p>
<p>åœ¨åº”ç”¨æˆ–æœåŠ¡ create çš„æ—¶å€™æ³¨å†Œ Receiver :</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">IntentFilter filter1 = new IntentFilter(<span class="name">BluetoothAdapter</span>.ACTION_STATE_CHANGED)<span class="comment">;</span></span><br><span class="line">registerReceiver(<span class="name">mBroadcastReceiver</span>, filter1)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>å£°æ˜ Receiver :</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> BroadcastReceiver mBroadcastReceiver = <span class="keyword">new</span> BroadcastReceiver() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> onReceive(Context context, Intent intent) &#123;</span><br><span class="line">            <span class="keyword">final</span> String action = intent.getAction();</span><br><span class="line">            <span class="keyword">if</span> (action.equals(BluetoothAdapter.ACTION_STATE_CHANGED)) &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> state = intent.getIntExtra(BluetoothAdapter.EXTRA_STATE, BluetoothAdapter.ERROR);</span><br><span class="line">                <span class="keyword">switch</span> (state) &#123;</span><br><span class="line">                    <span class="keyword">case</span> BluetoothAdapter.<span class="string">STATE_OFF:</span></span><br><span class="line">                        Log.d(<span class="string">"FUCK"</span>,<span class="string">"STATE_OFF"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> BluetoothAdapter.<span class="string">STATE_TURNING_OFF:</span></span><br><span class="line">                        Log.d(<span class="string">"FUCK"</span>,<span class="string">"STATE_TURNING_OFF"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> BluetoothAdapter.<span class="string">STATE_ON:</span></span><br><span class="line">                        Log.d(<span class="string">"FUCK"</span>,<span class="string">"STATE_ON"</span>);</span><br><span class="line">                        <span class="comment">// å¦‚æœè“ç‰™æœåŠ¡ä¸­é€”é‡å¯ï¼Œè¿™é‡Œéœ€è¦å…³é—­ä¹‹å‰çš„ Manager æ‰€é™„å¸¦çš„æ‰€æœ‰è¿æ¥</span></span><br><span class="line">                        <span class="keyword">if</span> (bleManager != <span class="literal">null</span>) close();</span><br><span class="line">                        bleManager = BleManager.getInstance();</span><br><span class="line">                        bleManager.init(BleController.<span class="keyword">this</span>);</span><br><span class="line">                        close();</span><br><span class="line">                        scanAndConnect();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> BluetoothAdapter.<span class="string">STATE_TURNING_ON:</span></span><br><span class="line">                        Log.d(<span class="string">"FUCK"</span>,<span class="string">"STATE_TURNING_ON"</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ çš„åº”ç”¨æˆ–æœåŠ¡ Destroy çš„æ—¶å€™æ³¨é”€è¿™ä¸ª Receiver :</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">unregisterReceiver(<span class="name">mBroadcastReceiver</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>å®Œäº‹ï¼Œä¸å¾—ä¸è¯´ BLE çš„è¿æ¥è¿˜æ˜¯å¾ˆç¨³å®šçš„ã€‚</p>
<p>è®°å¾—æœ€æ—©çœ‹å®‰å“å’Œ iOS è“ç‰™è¿æ¥çš„æ—¶å€™çœ‹åˆ°äº†çŸ¥ä¹<a href="https://www.zhihu.com/question/23246210" target="_blank" rel="external">è¿™ç¯‡å›ç­”</a>ï¼Œçœ‹æ¥æ•´ç†ä¸€ä¸‹ä»£ç ä¹Ÿå¯ä»¥å»å¥½å¥½å›ç­”ä¸€ä¸‹äº†ğŸŒš éƒ½æ²¡å‡ ä¸ªæœ‰ç”¨çš„å›ç­”ã€‚</p>
<p>å‘ã€‚</p>
<h2 id="u95F2_u626F"><a href="#u95F2_u626F" class="headerlink" title="é—²æ‰¯"></a>é—²æ‰¯</h2><p>æ©ã€‚å‘¨æœ«ç»ˆäºå¼ºé€¼è‡ªå·±æ’¸å®Œäº† <a href="http://sergiochan.xyz/Popularity/" target="_blank" rel="external">Popularity Widget for GitHub</a> ï¼Œ è¿˜åœ¨å®¡æ ¸ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç»Ÿè®¡ä½ è¿‡å¾€äº”ä¸ªæœˆæ¯å¤©çš„æ–°å¢ star å˜åŒ–è¶‹åŠ¿ï¼Œå…¶å®æ˜¯å¯ä»¥ç»†åŒ–åˆ°æ¯ä¸€ä¸ª star ä½ çš„ç”¨æˆ·å’Œå¯¹åº”çš„ä»“åº“çš„ï¼Œåé¢ç‰ˆæœ¬æ…¢æ…¢ä¼šæ›´æ–°ï¼Œä¹Ÿå¯ä»¥ç»Ÿè®¡åˆ°ï¼ˆè™½ç„¶æ²¡æœ‰æœ‰æ•ˆå†å²æ•°æ®ï¼‰è¿‡å¾€å››å‘¨çš„ follower å˜åŒ–è¶‹åŠ¿ã€‚å¯¹äºæƒ³è¦è¿è¥æˆ–ç»´æŠ¤ï¼Œæˆ–è€…åªæ˜¯äº†è§£ä¸€ä¸‹è‡ªå·±åœ¨ GitHub ä¸Šçš„äººæ°”å€¼çš„æœ‹å‹ä»¬åº”è¯¥æŒºæœ‰ç”¨ã€‚</p>
<p>è¿˜æœ‰ç»™ <a href="https://earthquick.github.io/" target="_blank" rel="external">EarthQuick</a> åœ¨ GitHub æ­çš„åç«¯ = = å› ä¸ºæ‹¿ Mac mini åšæœåŠ¡ç«¯å¤„ç†æ•°æ®å­˜åˆ° GitHub çš„ä»“åº“ä½œä¸º RESTful API è®¿é—®ç«Ÿç„¶è¿˜è¢«äººå–·äº†ï¼Œä¸å¤ªæ˜ç™½ç°åœ¨ GitHub æ—©éƒ½å»æ‰äº†è¿ç»­æäº¤æˆå°±ä¹‹åè¿˜åœ¨å…³å¿ƒå°ç»¿å—çš„äººçš„å¿ƒæ€â€¦â€¦æœ€ä¸»è¦çš„æ˜¯ï¼Œæˆ‘å“ªæœ‰æ—¶é—´å’Œé’±ï¼ˆå¦ˆä¸ªé¸¡åˆ«å’Œæˆ‘æé’±ï¼‰å•ç‹¬å»æä¸ªæœåŠ¡å™¨ç»´æŠ¤å•Š word å“¥ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä»Šå¤©å‘å¸ƒä¼šï¼Œå¿™äº†å‡ ä¸ªæœˆçš„æ–°äº§å“ç»ˆäºè¦å‘å¸ƒäº†ã€‚åº”è¯¥ä»Šæ™š<a href="https://www.raventech.com/" target="_blank" rel="ext]]>
    </summary>
    
      <category term="NONSENSE" scheme="http://sergiochan.github.io/tags/NONSENSE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[How to build a simple RESTful service using Github and your Mac mini]]></title>
    <link href="http://sergiochan.github.io/2016/11/20/How-to-build-a-simple-RESTful-service-using-Github-and-your-Mac-mini/"/>
    <id>http://sergiochan.github.io/2016/11/20/How-to-build-a-simple-RESTful-service-using-Github-and-your-Mac-mini/</id>
    <published>2016-11-20T04:00:57.000Z</published>
    <updated>2016-11-20T15:22:44.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="Recent_Work"><a href="#Recent_Work" class="headerlink" title="Recent Work"></a>Recent Work</h2><p><a href="https://earthquick.github.io/" target="_blank" rel="external">EarthQuick</a> </p>
<p><img src="https://ooo.0o0.ooo/2016/11/19/582fcb8440a7f.png" alt=""></p>
<h2 id="Point_Of_Interests"><a href="#Point_Of_Interests" class="headerlink" title="Point Of Interests"></a>Point Of Interests</h2><p>I built this service through Github repo, having not used any cloud server, cloud database or even a single domain name. And I can assume that some day, some one may write a blog which telling us how to build a fully-functional backend service through Github .. :-) It may cost some time and work on both client and server side, maybe SDK or something, while simple write operation can be wrapped into simple Git operation, and use HTTPS to transmit operation to server or something ..</p>
<p>Ok, back to reality, what I gonna make is just a small and simple data fetching RESTful API: you can retrieve well formatted data from various different source with different format. Well, I run a script periodly on my <strong>useless</strong> Mac mini to execute the Python extractor and data processor every Five minutes in order to make sure the data update in time, then through <strong>git commit &amp; push</strong> operation upload the constructed data to Github. Yes, every piece of data you get from this API is pre-processed on my Mac mini, and what you get is kind of a image of the data. So this is it - render locally, access remotely. (If you are willing to do more work on client side, itâ€™s possible)</p>
<h3 id="How_to_use_launchctl_run_your_script_periodly_on_macOS"><a href="#How_to_use_launchctl_run_your_script_periodly_on_macOS" class="headerlink" title="How to use launchctl run your script periodly on macOS"></a>How to use launchctl run your script periodly on macOS</h3><ul>
<li>Create your Shell script <strong>xx.sh</strong> in your work directory <strong>/Users/xxx</strong></li>
<li>Change permission of your script <strong>sudo chmod 777 xx.sh</strong></li>
<li>There are five destinations for you <code>launch.plist</code> file :</li>
</ul>
<p>â€‹    <strong>~/Library/LaunchAgents</strong>  per-user agents provided by specific user</p>
<p>â€‹    <strong>/Library/LaunchAgents</strong> per-user agents provided by the administrator </p>
<p>â€‹    <strong>/Library/LaunchDeamons</strong> Deamons provided by the administrator</p>
<p>â€‹    <strong>/System/Library/LaunchDeamons</strong> per-user agents provided by OSX</p>
<p>â€‹    <strong>/System/Library/LaunchDeamons</strong> Deamons provided by OSX</p>
<p>In which <code>agents</code> means application or script will only be running when specific user has logged in. When <code>agents</code> is provided by superior users, it means no matter user A or user B has logged in, this script will always be executed by this superior users. On the contrary, <code>deamons</code> means scripts can also be executed even when system has not been logged in. Here, the provider means you have to set the permission of the  <code>plist</code> file in these directory to support <strong>only</strong> the specific user group can operate. For example, if you place your <code>plist</code> file in <strong>/Library/LaunchDeamons</strong>, you should </p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">sudo chmod <span class="number">600</span> sergio<span class="selector-class">.chan</span><span class="selector-class">.cron</span><span class="selector-class">.plist</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Detailed description of parameters in <code>launchd.plist</code> can be found <a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man5/launchd.plist.5.html" target="_blank" rel="external">here</a></li>
<li>Finshed <code>plist</code> file according to the documents, for example :</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">string</span>&gt;</span>sergio.chan.cron.plist<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ProgramArguments<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">string</span>&gt;</span>/Users/xx/xx.sh<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>RunAtLoad<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>StartInterval<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">integer</span>&gt;</span>300<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>StandardOutPath<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">string</span>&gt;</span>/../../Log.log<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>StandardErrorPath<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">string</span>&gt;</span>/../../Error.err<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Using <code>launchctl</code> command to control the script</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">launchctl load   /Library/LaunchDeamons/sergio<span class="selector-class">.chan</span><span class="selector-class">.cron</span><span class="selector-class">.plist</span></span><br><span class="line">launchctl unload /Library/LaunchDeamons/sergio<span class="selector-class">.chan</span><span class="selector-class">.cron</span><span class="selector-class">.plist</span></span><br><span class="line">launchctl start  /Library/LaunchDeamons/sergio<span class="selector-class">.chan</span><span class="selector-class">.cron</span><span class="selector-class">.plist</span></span><br><span class="line">launchctl stop   /Library/LaunchDeamons/sergio<span class="selector-class">.chan</span><span class="selector-class">.cron</span><span class="selector-class">.plist</span></span><br><span class="line">launchctl list</span><br></pre></td></tr></table></figure>
<p>Notice that whenever you make any changes to the <code>plist</code> file, you should run <code>unload</code> first, then <code>load</code> again to make the changes effective. Rememer to enter <strong>full path</strong> of your <code>plist</code> file to guarantee the executed file is correct.</p>
<h2 id="EarthQuick_on_macOS"><a href="#EarthQuick_on_macOS" class="headerlink" title="EarthQuick on macOS"></a>EarthQuick on macOS</h2><p>Will come out sooooon.</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="Recent_Work"><a href="#Recent_Work" class="headerlink" title="Recent Work"></a>Rec]]>
    </summary>
    
      <category term="NONSENSE" scheme="http://sergiochan.github.io/tags/NONSENSE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äº EarthQuick - My new side project]]></title>
    <link href="http://sergiochan.github.io/2016/11/11/%E5%85%B3%E4%BA%8E-EarthQuick-My-new-side-project/"/>
    <id>http://sergiochan.github.io/2016/11/11/å…³äº-EarthQuick-My-new-side-project/</id>
    <published>2016-11-11T14:27:52.000Z</published>
    <updated>2016-11-11T14:28:24.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>å…³äºå¯åŠ¨ä¸€ä¸ªæ–°çš„ Side Project çš„è®°å½•ã€‚</p>
</blockquote>
<p><img src="https://ooo.0o0.ooo/2016/11/11/5825d2917d68b.png" width="40%" style="text-align:center"></p>
<p>å› ä¸ºå‰å‡ å¹´ç‰¹åˆ«å…³æ³¨åœ°éœ‡çš„æ¶ˆæ¯ï¼Œç‰¹åˆ«æ˜¯ 2011 å¹´çš„æ—¶å€™çœ‹äº†ç”µå½± ã€Š2012ã€‹ ä¹‹åï¼Œå¯¹åœ°éœ‡æå…¶å…³æ³¨ï¼Œæ­£å¥½é‚£å¹´åˆæœ‰ä¸“å®¶è¯´åœ°çƒè¿›å…¥äº†ä»€ä¹ˆåœ°éœ‡æ´»è·ƒæœŸï¼Œå› æ­¤é‚£æ—¶å€™æ—¶å¸¸å…³æ³¨ä¸€äº›åœ°éœ‡ç›‘æµ‹ä¸­å¿ƒçš„å®æ—¶ä¿¡æ¯ã€‚</p>
<p>å‰æ®µæ—¶é—´æ‰‹æœºä¸Šè£…äº†æˆéƒ½é«˜æ–°å‡ç¾ç ”ç©¶æ‰€çš„åœ°éœ‡é¢„è­¦ Appï¼Œè™½ç„¶åšçš„å¾ˆçƒ‚ï¼Œä½†æ˜¯é‡Œé¢çš„ä¿¡æ¯è‡³å°‘æ˜¯æ­£ç¡®çš„ï¼Œåæ¥æ¸æ¸çš„ä¹Ÿå°±ä¸ç”¨äº†ã€‚ä»Šå¤©å¿½ç„¶æƒ³èµ·æ¥ï¼ŒMac ä¸Šè¿˜æ²¡æœ‰ä¸€ä¸ªç±»ä¼¼çš„åœ°éœ‡é¢„è­¦è½¯ä»¶ï¼Œæ›´å¯æ€•çš„æ˜¯ï¼Œå›½å†…<strong>ç«Ÿç„¶æ²¡æœ‰</strong>ä¸€ä¸ªåƒæ ·çš„åœ°éœ‡ä¿¡æ¯æº APIï¼Œçœ‹åˆ°å¾®åšå’Œåœ°éœ‡å°ç½‘åˆä½œæäº†ä¸€ä¸ªä»€ä¹ˆå¼€æ”¾å¹³å°ï¼Œç„¶è€Œä¿¡æ¯çš„éªŒè¯å’Œç”³è¯·å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œå’Œç¾å›½åœ°è´¨å‹˜æ¢å±€ USGS æä¾›çš„ä¸€ç³»åˆ—ç¬¦åˆæŠ€æœ¯äººå‘˜æ¥å…¥æ ‡å‡†çš„ API å’Œæ•°æ®æ¯”è¾ƒèµ·æ¥ï¼Œå›½å†…è¿™æ–¹é¢çš„å®åœ¨æ˜¯å¯¹å¼€å‘è€…ä¸å¤Ÿå‹å¥½ã€‚å¤§æ¦‚å›½å†…æœ‰ä¸‹åˆ—æ¯”è¾ƒå®˜æ–¹ï¼ˆè™½ç„¶è¿™ç§æ•°æ®ä¹Ÿåªæœ‰å®˜æ–¹æ¥æºï¼Œå› ä¸ºéœ€è¦å¾ˆå¤šç›‘æµ‹åŸºç«™ï¼‰çš„æ•°æ®æ¥æºï¼š</p>
<ul>
<li><a href="http://data.earthquake.cn/index.jsp" target="_blank" rel="external">å›½å®¶åœ°éœ‡ç§‘å­¦æ•°æ®å…±äº«ä¸­å¿ƒ</a></li>
<li><a href="http://www.ceic.ac.cn/" target="_blank" rel="external">ä¸­å›½åœ°éœ‡å°ç½‘</a></li>
<li><a href="http://www.csi.ac.cn/publish/main/index.html" target="_blank" rel="external">ä¸­å›½åœ°éœ‡ä¿¡æ¯ç½‘</a></li>
</ul>
<p>æ‰€ä»¥å‡†å¤‡åŸºäº USGS çš„æ•°æ®æºå’Œ RESTful APIï¼Œæ•´åˆä¸€åˆ‡èƒ½ç”¨çš„å›½å†…æ•°æ®æºï¼Œå…ˆåšä¸€å¥—æ¯”è¾ƒå¥½ç”¨çš„ï¼Œ<strong>ç¬¦åˆ RESTful åŸåˆ™çš„åœ°éœ‡ä¿¡æ¯å®æ—¶é€ŸæŠ¥çš„ API</strong>ï¼Œå¼€æºå‡ºæ¥ã€‚å¹¶ä¸”åœ¨è¿™å¥— API çš„åŸºç¡€ä¸Šï¼Œå…ˆåšä¸€ä¸ª <strong>Mac ä¸Šçš„ App</strong>ï¼Œå°±å«åš <strong>EarthQuick</strong>ï¼Œæ„æ€æ˜¯å¿«é€Ÿçš„å°†åœ°éœ‡ä¿¡æ¯ä¼ é€’ç»™æ‰€æœ‰å…³æ³¨çš„äººã€‚æˆ‘æƒ³ï¼Œå¯¹äºç”Ÿæ´»åœ¨æ¹¾åŒºï¼Œå°æ¹¾æˆ–è€…æ—¥æœ¬è¿™äº›åœ°åŒºçš„æœ‹å‹ä»¬ï¼Œå¤šå…³æ³¨åœ°éœ‡ä¿¡æ¯åº”è¯¥æ˜¯ç”Ÿæ´»ä¸­çš„ä¸€ç§å¸¸æ€äº†å§ã€‚</p>
<p>è®¾è®¡ç¨¿å¤§æ¦‚å¦‚ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„ Menu Bar åº”ç”¨ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/11/5825a308e9c20.png" alt=""></p>
<p>æ©ã€‚å‡†å¤‡è¿™å‡ å¤©å°±å¼€å§‹æ’¸ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>å…³äºå¯åŠ¨ä¸€ä¸ªæ–°çš„ Side Project çš„è®°å½•ã€‚</p>
</blockquote>
<p><img src="https://ooo.0o0.]]>
    </summary>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/tags/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[How to draw a Wireframe Shader for a Cube in Rajawali under OpenGL ES 2.0]]></title>
    <link href="http://sergiochan.github.io/2016/11/09/How-to-draw-a-Wireframe-Shader-for-a-Cube-in-Rajawali-under-OpenGL-ES-2-0/"/>
    <id>http://sergiochan.github.io/2016/11/09/How-to-draw-a-Wireframe-Shader-for-a-Cube-in-Rajawali-under-OpenGL-ES-2-0/</id>
    <published>2016-11-09T09:41:34.000Z</published>
    <updated>2016-11-09T09:52:18.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>PS. This will be my first blog totally written in english.</p>
</blockquote>
<p><img src="https://ooo.0o0.ooo/2016/11/09/58227c9f45765.png" alt=""></p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><blockquote>
<p><strong>Environment:</strong> </p>
<p>GLSL ES Version 100</p>
<p>OpenGL ES Version 2.0</p>
<p>Android 6.0</p>
<p>Android OpenGL ES 2.0/3.0 Engine <a href="https://github.com/Rajawali/Rajawali" target="_blank" rel="external">Rajawali</a></p>
</blockquote>
<h2 id="First_Discuss"><a href="#First_Discuss" class="headerlink" title="First Discuss"></a>First Discuss</h2><p>There are several ways to draw a wireframe for a cube in Rajawali engine. We can use </p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">cube</span><span class="selector-class">.setDrawingMode</span>(<span class="selector-tag">GLES20</span><span class="selector-class">.GL_LINE_STRIP</span>);</span><br></pre></td></tr></table></figure>
<p>to tell the cube to draw in wireframe mode. But because a Cube, or we can say, every Polygons or 3D Objects in OpenGL are formed by lots of dots, lines and triangles, setting drawing mode will only show you such images like below : </p>
<p><img src="https://ooo.0o0.ooo/2016/11/09/5822d63584db6.png" alt=""></p>
<p>Also, when you set DrawingMode to GL_LINE_STRIP, your custom vertex or fragment shader wonâ€™t work as usual. So you will see a cube full of lines, doesnâ€™t it look messy to you?</p>
<p>In order to draw wireframe using fragment shader, we can simply use following fragement shader :</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">precision</span> <span class="keyword">mediump</span> <span class="type">float</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> vTextureCoord;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> vColor;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main() &#123;</span><br><span class="line">        <span class="type">vec4</span> newColor = <span class="type">vec4</span>(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">        <span class="type">float</span> x = <span class="built_in">min</span>(vTextureCoord.s, <span class="number">1.0</span> - vTextureCoord.s);</span><br><span class="line">        <span class="type">float</span> y = <span class="built_in">min</span>(vTextureCoord.t, <span class="number">1.0</span> - vTextureCoord.t);</span><br><span class="line"></span><br><span class="line">        <span class="type">float</span> line_width = <span class="number">0.01</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (x &lt; line_width) &#123;</span><br><span class="line">            newColor.g = <span class="number">1.0</span>;</span><br><span class="line">            newColor.r = <span class="number">1.0</span>;</span><br><span class="line">            newColor.b = <span class="number">1.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (y &lt; line_width) &#123;</span><br><span class="line">            newColor.g = <span class="number">1.0</span>;</span><br><span class="line">            newColor.r = <span class="number">1.0</span>;</span><br><span class="line">            newColor.b = <span class="number">1.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">gl_FragColor</span> = newColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, there is still a problem here. While using this shader, if you make your cube scale in whichever direction, this drawing â€˜Lineâ€™ will always scale along with the cube. Obviously itâ€™s because the 0.01 we set here is a relative value. But the <code>vTextureCoord</code> we can get here which was passed by our vertex shader is only a <code>vec2</code> vector represented a 2D coordinate on this mesh, which can only range from (0.0 , 0.0) to (1.0 , 1.0). This means <code>vTextureCoord</code> can only represent a relative coordinate, which doesnâ€™t help us at all.</p>
<p>So, here we have to use the help from vertex shader. In vertex shader, we could get some <code>attribute</code> variables that are somehow useful. In OpenGL ES, we have three kinds of type specifiers: <strong>uniform</strong>, <strong>attribute</strong> and <strong>varying</strong>. Uniform variables are used for transmitting datas from CPU to GPU, the usage is as below :</p>
<ul>
<li>Uniform variables are binded in your shader class in CPU and GPU so you have to subclass the Shader Base Class and override some methods here. First declare an int handle for binding location  and the variables that hold your data along with the variable name in your shader (glsl) file.</li>
</ul>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">private</span> <span class="keyword">String</span> uMyDataName = <span class="string">"uMyData"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> muMyDataHandle;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">float</span> MyData;</span><br></pre></td></tr></table></figure>
<ul>
<li>Remember to set the default value for your data when initializing.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">MyShader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	MyData = <span class="number">1.0f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Override setLocations method to get uniform variable location from programHandle.</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> setLocations(<span class="keyword">final</span> <span class="keyword">int</span> programHandle)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">super</span>.setLocations(programHandle);</span><br><span class="line">	muMyDataHandle = getUniformLocation(programHandle, uMyDataName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Override applyParams method to apply every change of your uniform variable, also you can call <code>glUniform1f</code> method directly to pass the value into shader.</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">applyParams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">super</span>.applyParams();</span><br><span class="line">	GLES20.glUniform1f(muMyDataHandle, MyData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>In your shader (glsl) file, add your new variable and call this variable wherever you want.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">uniform <span class="keyword">float</span> uMyData;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// get uMyData here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>When you want to change the value of <code>uMyData</code> , just change  the value of <code>MyShader.MyData</code>.</li>
</ul>
<p>Attribute variables can only be used in vertex shaders. In Rajawali, you can call <code>addAttribute</code> to directly add custom attribute and use <code>GLES20.glVertexAttribPointer</code> to set value for the attribute variable handler. Here we have several attribute variables as below :</p>
<ul>
<li>aPosition</li>
<li>aTextureCoord</li>
<li>aNormal</li>
<li>aVertexColor</li>
</ul>
<p>Among them, <strong>aPosition</strong> is the most useful variable for us, it represents the vector from (0,0,0) for current vertex in model projection. <strong>aTextureCoord</strong> is the source of <strong>vTextureCoord</strong> in fragment shader. As you can see, <strong>vTextureCoord</strong> has a type specifier â€˜<strong>varying</strong>â€˜, itâ€™s used for transmitting variables from vertex shader to fragment shader. Here itâ€™s involved with some concept of the <strong>pipline</strong> procedure for OpenGL, what we need to know is that we could declare <strong>â€˜varying float Aâ€™</strong> both in vertex shader and fragment shader at the same time, while write in vertex shader and read in fragment shader.</p>
<h3 id="Let_u2019s_begin_21"><a href="#Let_u2019s_begin_21" class="headerlink" title="Letâ€™s begin!"></a>Letâ€™s begin!</h3><p>So, here, in order to solve the scaling problem mentioned above, we declare three scale value for x, y and z :</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">uniform</span> <span class="type">float</span> uScaleZ;</span><br><span class="line"><span class="keyword">uniform</span> <span class="type">float</span> uScaleX;</span><br><span class="line"><span class="keyword">uniform</span> <span class="type">float</span> uScaleY;</span><br><span class="line"></span><br><span class="line"><span class="comment">// We should get current width from CPU</span></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">float</span> uWidth;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Pass everything above to fragment shader</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleZ;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleX;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleY;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vWidth;</span><br></pre></td></tr></table></figure>
<p>And make the vertex scale in vertex shader by changing its position :</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">vec3 <span class="attr">directionVec</span> = vec3(aPosition.x,aPosition.y,aPosition.z);</span><br><span class="line">vec4 <span class="attr">timeVec</span> = vec4(directionVec, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">// Scale each axis</span><br><span class="line">timeVec.<span class="attr">x</span> = directionVec.x * uScaleX;</span><br><span class="line">timeVec.<span class="attr">y</span> = directionVec.y * uScaleY;</span><br><span class="line">timeVec.<span class="attr">z</span> = directionVec.z * uScaleZ;</span><br><span class="line"></span><br><span class="line">vec4 <span class="attr">newPosition</span> = uMVPMatrix * timeVec;</span><br><span class="line"><span class="attr">gl_Position</span> = newPosition;</span><br><span class="line"><span class="attr">vTextureCoord</span> = aTextureCoord;</span><br></pre></td></tr></table></figure>
<p>In fact, because we are going to draw colors on mesh in fragment shader, we should pass all the variables about scaling and position from vertex shader to fragment shader. So we have to add a <code>vec3</code> :</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> vTimeVec;</span><br></pre></td></tr></table></figure>
<p>And in <code>main()</code> add :</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="type">vec3</span> tmpVec = <span class="type">vec3</span>(timeVec.x,timeVec.y,timeVec.z);</span><br><span class="line">vTimeVec = tmpVec;</span><br></pre></td></tr></table></figure>
<h3 id="Next_2C_what_should_we_do_in_fragment_shader_3F"><a href="#Next_2C_what_should_we_do_in_fragment_shader_3F" class="headerlink" title="Next, what should we do in fragment shader?"></a>Next, what should we do in fragment shader?</h3><p>First, declare everything we need to get from vertex shader :</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">varying</span> <span class="type">vec2</span> vTextureCoord;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> vColor;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> vTimeVec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleZ;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleX;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vScaleY;</span><br><span class="line"></span><br><span class="line"><span class="keyword">varying</span> <span class="type">float</span> vWidth;</span><br></pre></td></tr></table></figure>
<p>The most important step here is that when we set width for line, fragment shader should exactly split it into two parts which are drawn on different meshes. Itâ€™s easy to understand, 1/2 for left side and the other 1/2 for the right side.</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">const float <span class="attr">GT</span> = <span class="number">1.0</span>;</span><br><span class="line">const float <span class="attr">LT</span> = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">    vec4 <span class="attr">newColor</span> = vec4(<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>);</span><br><span class="line">    float <span class="attr">lineWidth</span> = <span class="number">0.004</span>;</span><br><span class="line"></span><br><span class="line">    float <span class="attr">leftX</span> = - (vWidth * vScaleX / <span class="number">2.0</span>) + lineWidth;</span><br><span class="line">    float <span class="attr">rightX</span> = (vWidth * vScaleX / <span class="number">2.0</span>) - lineWidth / <span class="number">2.0</span>;</span><br><span class="line">    </span><br><span class="line">    float <span class="attr">bottomY</span> = - (vWidth * vScaleY / <span class="number">2.0</span>) + lineWidth;</span><br><span class="line">    float <span class="attr">topY</span> = (vWidth * vScaleY / <span class="number">2.0</span>) - lineWidth / <span class="number">2.0</span>;</span><br><span class="line"></span><br><span class="line">    float <span class="attr">backZ</span> = - (vWidth * vScaleZ / <span class="number">2.0</span>) + lineWidth;</span><br><span class="line">    float <span class="attr">frontZ</span> = (vWidth * vScaleZ / <span class="number">2.0</span>) - lineWidth / <span class="number">2.0</span>;</span><br><span class="line"></span><br><span class="line">    float <span class="attr">rX</span> = smoothstep(leftX,rightX,vTimeVec.x);</span><br><span class="line">    float <span class="attr">rZ</span> = smoothstep(backZ,frontZ,vTimeVec.z);</span><br><span class="line">    float <span class="attr">rY</span> = smoothstep(bottomY,topY,vTimeVec.y);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">    (<span class="attr">rX</span> == GT &amp;&amp; <span class="attr">rY</span> == GT) ||</span><br><span class="line">    (<span class="attr">rX</span> == GT &amp;&amp; <span class="attr">rZ</span> == GT) ||</span><br><span class="line">    (<span class="attr">rY</span> == GT &amp;&amp; <span class="attr">rZ</span> == GT) ||</span><br><span class="line">    (<span class="attr">rX</span> == LT &amp;&amp; <span class="attr">rY</span> == LT) ||</span><br><span class="line">    (<span class="attr">rX</span> == LT &amp;&amp; <span class="attr">rZ</span> == LT) ||</span><br><span class="line">    (<span class="attr">rY</span> == LT &amp;&amp; <span class="attr">rZ</span> == LT) ||</span><br><span class="line">    (<span class="attr">rX</span> == GT &amp;&amp; <span class="attr">rY</span> == LT) ||</span><br><span class="line">    (<span class="attr">rX</span> == GT &amp;&amp; <span class="attr">rZ</span> == LT) ||</span><br><span class="line">    (<span class="attr">rY</span> == GT &amp;&amp; <span class="attr">rZ</span> == LT) ||</span><br><span class="line">    (<span class="attr">rX</span> == LT &amp;&amp; <span class="attr">rY</span> == GT) ||</span><br><span class="line">    (<span class="attr">rX</span> == LT &amp;&amp; <span class="attr">rZ</span> == GT) ||</span><br><span class="line">    (<span class="attr">rY</span> == LT &amp;&amp; <span class="attr">rZ</span> == GT))&#123;</span><br><span class="line">    	// Set your custom line color here</span><br><span class="line">         newColor.<span class="attr">g</span> = <span class="number">0.659</span>;</span><br><span class="line">         newColor.<span class="attr">r</span> = <span class="number">0.976</span>;</span><br><span class="line">         newColor.<span class="attr">b</span> = <span class="number">0.192</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="attr">gl_FragColor</span> = newColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Some_more_tricks_with_scaling"><a href="#Some_more_tricks_with_scaling" class="headerlink" title="Some more tricks with scaling"></a>Some more tricks with scaling</h3><p><img src="https://ooo.0o0.ooo/2016/11/09/5822e8cb5bcc5.png" alt=""></p>
<p>As you can see from the image above, the 0 point for y and z axis of the model projection is in the middle of the cube. Itâ€™s hard to modify a cubeâ€™s anchor point here because there is no concept of anchor point here. But when we scale our cube, we may want it to scale based on one of its surfaces. How can we do that? I used method below to implement a demo for bottom-based and top-based scaling :</p>
<ul>
<li>In vertex shader, change the shader script here :</li>
</ul>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">// uScaleMode :</span><br><span class="line">// <span class="number">1</span>: top based</span><br><span class="line">// <span class="number">2</span>: bottom based</span><br><span class="line"></span><br><span class="line">timeVec.<span class="attr">x</span> = directionVec.x * uScaleX;</span><br><span class="line">timeVec.<span class="attr">y</span> = directionVec.y * uScaleY * <span class="number">2.0</span>;</span><br><span class="line">timeVec.<span class="attr">z</span> = directionVec.z * uScaleZ;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (<span class="attr">uScaleMode</span> == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (timeVec.y &lt; <span class="number">0.0</span>) &#123;</span><br><span class="line">        timeVec.<span class="attr">y</span> = <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (timeVec.y &gt; <span class="number">0.0</span>) &#123;</span><br><span class="line">        timeVec.<span class="attr">y</span> = <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>In fragment shader :</li>
</ul>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">float</span> bottomY;</span><br><span class="line"><span class="attribute">float</span> topY;</span><br><span class="line"></span><br><span class="line"><span class="attribute">if</span> (vScaleMode == <span class="number">1</span>.<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="attribute">bottomY</span> = lineWidth;</span><br><span class="line">    <span class="attribute">topY</span> = vWidth * vScaleY - lineWidth / <span class="number">2</span>.<span class="number">0</span>;</span><br><span class="line">&#125; <span class="section">else</span> &#123;</span><br><span class="line">    <span class="attribute">bottomY</span> =  - vWidth * vScaleY + lineWidth;</span><br><span class="line">    <span class="attribute">topY</span> = - lineWidth / <span class="number">2</span>.<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="How_to_rorate_using_MVPMatrix__3F"><a href="#How_to_rorate_using_MVPMatrix__3F" class="headerlink" title="How to rorate using MVPMatrix ?"></a>How to rorate using MVPMatrix ?</h3><p>Here is a discussion on <a href="http://stackoverflow.com/questions/15837177/using-matrix-rotate-in-opengl-es-2-0" target="_blank" rel="external">stackoverflow</a>.</p>
<p>In Rajawali, we can also use MVPMatrix to rotate the object. Although Rajawali provides us method like <code>material.setMVPMatrix(mvpMatrix);</code> to set MVPMatrix, I found it not working correctly. The matrix cannot be correctly passed into vertex shader. So I add another uniform variable here, named it <code>uCMVPMatrix</code>.</p>
<p>In our custom Renderer which is a subclass of <code>RajawaliRenderer</code>,  add these variables :</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Matrix4 mvpMatrix;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">double</span>[] mvpMatrixValue = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">double</span>[] mModelMatrix = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">16</span>];</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">double</span>[] mTempMatrix = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">16</span>];</span><br></pre></td></tr></table></figure>
<p>When you finished initialization of your cube, get the MVPMatrix from it directly using :</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cube</span> = new Cube(...)<span class="comment">;</span></span><br><span class="line"><span class="attribute">mvpMatrix</span> = cube.getModelViewProjectionMatrix()<span class="comment">;</span></span><br><span class="line"><span class="attribute">mvpMatrixValue</span> = mvpMatrix.getDoubleValues()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>Then, in <code>onRender</code>, doing Matrix calculation to rotate the cube :</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onRender</span><span class="params">(<span class="keyword">final</span> <span class="keyword">long</span> elapsedTime, <span class="keyword">final</span> <span class="keyword">double</span> deltaTime)</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">	Matrix.setIdentityM(mModelMatrix, <span class="number">0</span>); <span class="comment">// initialize to identity matrix</span></span><br><span class="line">    <span class="keyword">long</span> time = SystemClock.uptimeMillis() % <span class="number">4000</span>L;</span><br><span class="line">    <span class="keyword">float</span> mAngle = <span class="number">0.090</span>f * ((<span class="keyword">int</span>) time);</span><br><span class="line">    Matrix.setRotateM(mModelMatrix, <span class="number">0</span>, mAngle, <span class="number">0</span>, <span class="number">1.0</span>f, <span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    mTempMatrix = mvpMatrixValue.clone();</span><br><span class="line">    Matrix.multiplyMM(mvpMatrixValue, <span class="number">0</span>, mTempMatrix, <span class="number">0</span>, mModelMatrix, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    mvpMatrix = mvpMatrix.setAll(mvpMatrixValue);</span><br><span class="line">    vertShader.CMVPMatrix = mvpMatrix.getFloatValues();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In our custom vertex shader, add a uniform handle for this <code>uCMVPMatrix</code> and send value to it :</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> muCMVPMatrixHandle;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">float</span>[] CMVPMatrix;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> setLocations(<span class="keyword">final</span> <span class="keyword">int</span> programHandle)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">super</span>.setLocations(programHandle);</span><br><span class="line">    ...</span><br><span class="line">    muCMVPMatrixHandle = getUniformLocation(programHandle, uCMVPMatrixName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">applyParams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.applyParams();</span><br><span class="line">    ...</span><br><span class="line">    GLES20.glUniformMatrix4fv(muCMVPMatrixHandle, <span class="number">1</span>, <span class="keyword">false</span>, CMVPMatrix, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Thus, rotation using Matrix should be easy in Rajawali !</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>PS. This will be my first blog totally written in english.</p>
</blockquot]]>
    </summary>
    
      <category term="Android" scheme="http://sergiochan.github.io/tags/Android/"/>
    
      <category term="GLSL" scheme="http://sergiochan.github.io/tags/GLSL/"/>
    
      <category term="OpenGL ES" scheme="http://sergiochan.github.io/tags/OpenGL-ES/"/>
    
      <category term="Shader" scheme="http://sergiochan.github.io/tags/Shader/"/>
    
      <category term="Wireframe" scheme="http://sergiochan.github.io/tags/Wireframe/"/>
    
      <category term="å®‰å“èœé¸Ÿå¿ƒå¾—" scheme="http://sergiochan.github.io/categories/%E5%AE%89%E5%8D%93%E8%8F%9C%E9%B8%9F%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Multi-Touch Bar UI å¼€å‘å…¥é—¨æŒ‡å—]]></title>
    <link href="http://sergiochan.github.io/2016/11/02/Multi-Touch-Bar-UI-%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"/>
    <id>http://sergiochan.github.io/2016/11/02/Multi-Touch-Bar-UI-å¼€å‘å…¥é—¨æŒ‡å—/</id>
    <published>2016-11-02T11:03:05.000Z</published>
    <updated>2016-11-02T11:08:26.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h3 id="u5927_u81F4"><a href="#u5927_u81F4" class="headerlink" title="å¤§è‡´"></a>å¤§è‡´</h3><p>å½“ä½ å­¦ä¼šå¦‚ä½•åœ¨ä½ çš„ NSViewController ä¸­ç”¨ä»£ç å»åˆå§‹åŒ– Multi-Touch Bar ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦å¼€å§‹äº†è§£å¦‚ä½•æ·±å…¥çš„å¼€å‘ Touch Bar ä¸Šçš„ UI äº†ã€‚æ ¹æ® Apple å†…éƒ¨çš„ä¸€ä¸ªè¯´æ³•å°±æ˜¯ Multi-Touch Bar å®é™…ä¸Šæ˜¯è¿è¡Œäº†ä¸€ä¸ª watchOS æ¥ç®¡ç†å®ƒçš„è§†å›¾å’Œé€»è¾‘ï¼Œæ‰€ä»¥ä¸æ­¤åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°è‹¹æœå®˜æ–¹ä¸º Multi-Touch Bar æä¾›çš„ä¸€å¥— UI æ§ä»¶ï¼Œæ€»å…±åŒ…å«ä¸‹é¢è¿™äº›æ§ä»¶ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯ Touch Barã€‚</p>
<p><img src="https://ooo.0o0.ooo/2016/11/01/58181fbf140db.jpg" alt=""></p>
<ul>
<li>Touch Bar Fixed Space</li>
<li>Touch Bar Flexible Space</li>
</ul>
<p>è¿™ä¸¤ä¸ªæ˜¯ç”¨äºåœ¨ UI ä¸Šç”¨æ¥å¡«å……çš„ç©ºé—´ï¼ŒTouch Bar é»˜è®¤çš„ UI æ˜¯ä»å·¦åˆ°å³ï¼Œé»˜è®¤å·¦å³å°±æ˜¯æŒ¨ç€çš„ï¼Œå¦‚æœä½ éœ€è¦å°†ä¸¤ä¸ªæŒ‰é’®ä»€ä¹ˆçš„åˆ†å¼€ä¸€äº›ï¼Œå®šä¹‰ä»–ä»¬ä¹‹é—´çš„é—´éš”ï¼Œä½ éœ€è¦åœ¨ä»–ä»¬ä¸­é—´å¡ Spaceã€‚</p>
<ul>
<li>Touch Bar Popover</li>
</ul>
<ul>
<li>Touch Bar Group</li>
</ul>
<p>/// BarItem çš„é›†åˆï¼Œå¯ä»¥ä¸€èµ·å—åˆ°çº¦æŸå’Œç”¨æˆ·çš„ Customizationã€‚</p>
<ul>
<li>Touch Bar Other Items Proxy</li>
</ul>
<p>/// åé¢è¯¦ç»†æè¿°ï¼Œè¿™æ˜¯å’Œ Responder Chain ç›¸å…³çš„ä¸€ä¸ªæ§ä»¶ï¼Œå¯ä»¥è®©å“åº”é“¾ä¸‹å±‚çš„ Touch Bar å’Œä¸Šå±‚çš„ Touch Bar ä¸€èµ·æ˜¾ç¤ºã€‚</p>
<ul>
<li>Touch Bar Scrubber</li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/11/01/581837cc4601b.png" alt="https://ooo.0o0.ooo/2016/11/01/581837cc4601b.png"></p>
<p>/// è¿™æ˜¯ä¸€ä¸ªæ”¾è¿› NSCustomTouchBarItem çš„ NSScrubber å¯¹è±¡ã€‚</p>
<ul>
<li>Touch Bar Color Picker</li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/11/01/5818386c45463.png" alt=""></p>
<p>/// ä¸€ä¸ª NSColorPickerTouchBarItem å¯¹è±¡ã€‚</p>
<ul>
<li>Touch Bar Character Picker</li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/11/01/581838cf69274.png" alt=""></p>
<p>/// ä¸€ä¸ª  NSCandidateListTouchBarItem å¯¹è±¡ã€‚</p>
<ul>
<li>Touch Bar Sharing Service Picker</li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/11/01/5818393054d89.png" alt=""></p>
<p>/// ä¸€ä¸ª NSSharingServicePickerTouchBarItem å¯¹è±¡ã€‚</p>
<p>è¿™é‡Œçš„ Scrubberï¼ŒColor Picker å’Œ Character Picker è¿™äº›æ§ä»¶å°±ä¼šæœ‰äº›é™Œç”Ÿäº†ï¼Œè™½ç„¶çœ‹è¿‡è‹¹æœå‘å¸ƒä¼šçš„åŒå­¦ä»¬å¯¹ä»–ä»¬åº”è¯¥ä¹Ÿé™Œç”Ÿä¸åˆ°å“ªé‡Œå»ã€‚è¿™å‡ ä¸ªæ§ä»¶åœ¨å½“æ—¶å‘å¸ƒä¼šéƒ½æœ‰å±•ç¤ºã€‚åˆ†åˆ«æ˜¯æ»‘åŠ¨å›¾ç‰‡æˆ–æ–‡å­—é€‰æ‹©å™¨ï¼Œé¢œè‰²é€‰æ‹©å™¨ï¼ŒEmoji è¡¨æƒ…é€‰æ‹©å™¨ä»¥åŠåˆ†äº«é€‰æ‹©å™¨ï¼Œä»–ä»¬éƒ½æœ‰è‡ªå·±ç›¸åº”çš„ Delegate æ¥å¤„ç†äº‹ä»¶ã€‚</p>
<ul>
<li>Touch Bar Label</li>
<li>Touch Bar Button</li>
<li>Touch Bar Slider</li>
<li>Touch Bar Segmented Control</li>
<li>Touch Bar View</li>
</ul>
<p>æœ€åçš„äº”é¡¹å¯¹äºå¤§å®¶éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œéƒ½æ˜¯ä¸€äº› AppKit ä¸­çš„æ§ä»¶åœ¨ Touch Bar ä¸­çš„ç§»æ¤ï¼Œå¯¹äºäº‹ä»¶çš„å“åº”å’Œ AppKit åšæ³•ç›¸åŒã€‚</p>
<blockquote>
<p>å½“ä½ çš„ macOS åº”ç”¨ä¸­åŒ…å«äº†ä¸€äº›è‡ªå¸¦ Touch Bar çš„æ§ä»¶çš„æ—¶å€™ï¼Œä¾‹å¦‚ NSTextFieldï¼Œå¦‚æœä½ æ²¡æœ‰è‡ªå®šä¹‰ä½ çš„ Touch Barï¼Œé‚£ä¹ˆåœ¨ Touch Bar ä¸Šä¹Ÿä¼šæ˜¾ç¤ºç›¸åº”çš„æ§ä»¶ã€‚è¿™æ˜¯é¢„è®¾å¥½çš„ã€‚</p>
</blockquote>
<h3 id="NSTouchBar"><a href="#NSTouchBar" class="headerlink" title="NSTouchBar"></a>NSTouchBar</h3><p>ä½ å¯ä»¥å°† NSTouchBar çœ‹æˆæ˜¯ä¸€ä¸ª NSTouchBarItem çš„æ•°ç»„ã€‚åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå¯¹äºä¸åŒçš„ NSResponder å¯¹åº”çš„ Touch Bar å’Œè¿™äº› Touch Bar æ‰€å¯¹åº”çš„ BarItemï¼Œéƒ½æ˜¯ç”¨ Identifier æ¥æ ‡è¯†çš„ï¼Œå°½é‡ä½¿ç”¨ reverse-DNS æ–¹å¼çš„ Identifierï¼Œä¾‹å¦‚ <code>com.company-name.app-name.alphanumeric-ID</code>ã€‚</p>
<blockquote>
<p>è¿™é‡Œæ’ä¸€å¥ï¼Œä¸ºäº†æ¥ä¸‹æ¥çš„è¯´æ˜ï¼šç”±äºç°åœ¨å¹¶æ²¡æœ‰è§åˆ°è¿‡æ–°çš„ MBP çœŸæœºï¼Œå°šä¸æ¸…æ¥š Touch Bar æä¾›ç»™ç”¨æˆ·çš„ Customization æ˜¯ä»€ä¹ˆæ ·çš„æœºåˆ¶ï¼Œä¸è¿‡å¤§æ¦‚ä¹Ÿå°±å’Œ Finder çš„è‡ªå®šä¹‰ç±»ä¼¼ï¼ŸæŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ¥è¯´ï¼Œåº”è¯¥æ˜¯ç”¨æˆ·åœ¨è¿è¡Œçš„æ—¶å€™å¯ä»¥é€‰æ‹©æ˜¾ç¤ºæˆ–åˆ é™¤å“ªäº› BarItem æˆ–è€…ä¿®æ”¹ BarItem çš„æ’åˆ—é¡ºåºï¼Œè¿™å¤§æ¦‚ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ Touch Bar çš„ UI æ˜¯å§‹ç»ˆå‘å·¦é é½çš„å§ã€‚</p>
</blockquote>
<p>NSTouchBar è‡ªèº«æœ‰ä¸€ä¸ª Identifierï¼š <strong>customizationIdentifier</strong>ï¼Œè¿™æ˜¯åœ¨è¿è¡Œæ—¶å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ UI çš„æ ‡è¯†ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œç”¨æˆ·å°±æ— æ³•é€šè¿‡ç³»ç»Ÿæ¥è‡ªå®šä¹‰ Touch Bar çš„ UIã€‚</p>
<p><strong>customizationAllowedItemIdentifiers</strong>ï¼Œä¸€ä¸ªæ•°ç»„ï¼Œåœ¨è¿™é‡Œé¢å­˜æ”¾çš„ Identifier å¯¹åº”çš„ BarItem æ˜¯å…è®¸åœ¨è¿è¡Œæ—¶è¢«ç”¨æˆ·ä¿®æ”¹æ ·å¼çš„ã€‚</p>
<p><strong>customizationRequiredItemIdentifiers</strong>ï¼Œè¿™ä¸ªæ•°ç»„é‡Œé¢å­˜æ”¾çš„æ˜¯ä¸èƒ½è¢«ç§»é™¤ï¼Œä¸€å®šä¼šåŠ è½½çš„ BarItem å¯¹åº”çš„ Identifierã€‚</p>
<p><strong>defaultItemIdentifiers</strong>ï¼Œè¿™æ˜¯ Touch Bar é»˜è®¤æ˜¾ç¤ºçš„å…¨éƒ¨ BarItemï¼Œè¿™ä¸ªå‚æ•°æ˜¯<strong>å¿…é¡»</strong>è¢«åˆå§‹åŒ–çš„ã€‚åœ¨è¿™é‡Œé¢å£°æ˜çš„ Identifier éšåå°±ä¼šåœ¨ <code>-itemForIdentifier:</code> è¿™ä¸ª Delegate æ–¹æ³•ä¸­åˆå§‹åŒ–æˆ BarItemã€‚ç»™äºˆ BarItem çš„ Identifier å¿…é¡»ä¿æŒ<strong>å…¨å±€å”¯ä¸€</strong>ï¼Œç³»ç»Ÿæœ‰å¦å¤–å››ä¸ªé¢„ç•™çš„ Identifierï¼š</p>
<ul>
<li>NSTouchBarItemIdentifierFixedSpaceSmall</li>
<li>NSTouchBarItemIdentifierFixedSpaceLarge</li>
<li>NSTouchBarItemIdentifierFlexibleSpace</li>
<li>NSTouchBarItemIdentifierOtherItemsProxy</li>
</ul>
<p>å¦å¤–ï¼ŒNSTouchBar è¿˜æœ‰ä¸€ä¸ªåªè¯»çš„å±æ€§ <strong>itemIdentifiers</strong>ï¼Œè¿™ä¸ªæ•°ç»„é‡ŒåŒ…å«çš„æ˜¯è¿è¡Œæ—¶å½“å‰æ˜¾ç¤ºçš„ BarItem å¯¹åº”çš„ Identifierï¼Œæ— è®ºç”¨æˆ·åœ¨è¿è¡Œçš„æ—¶å€™å¯¹ Touch Bar åšäº†ä½•ç§çš„ Customizationï¼Œä½ éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§è·å¾—å½“å‰çš„çŠ¶æ€ã€‚</p>
<h4 id="u5982_u4F55_u8BA9_u4E00_u4E2A_BarItem__u5728_Touch_Bar__u4E0A_u5C45_u4E2D_u663E_u793A_uFF1F"><a href="#u5982_u4F55_u8BA9_u4E00_u4E2A_BarItem__u5728_Touch_Bar__u4E0A_u5C45_u4E2D_u663E_u793A_uFF1F" class="headerlink" title="å¦‚ä½•è®©ä¸€ä¸ª BarItem åœ¨ Touch Bar ä¸Šå±…ä¸­æ˜¾ç¤ºï¼Ÿ"></a>å¦‚ä½•è®©ä¸€ä¸ª BarItem åœ¨ Touch Bar ä¸Šå±…ä¸­æ˜¾ç¤ºï¼Ÿ</h4><p><strong>principalItemIdentifier</strong> è¿™ä¸ªå±æ€§æ‰€å¯¹åº”çš„ BarItem ä¼šåœ¨ Touch Bar <strong>å±…ä¸­</strong>ï¼Œæ˜¯æ‰€è°“çš„æœ€é«˜ä¼˜å…ˆçº§çš„ Itemï¼Œå¦‚æœæœ‰å¤šå±‚ Touch Bar å­˜åœ¨ï¼Œä¹Ÿåªä¼šæœ‰æœ€ä¸Šå±‚çš„ principalItem æ˜¾ç¤ºå‡ºæ¥ã€‚è¿™é‡Œï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ç‰¹åˆ«æåˆ°ï¼š</p>
<blockquote>
<p>Do not hard-code spacing in an attempt to ensure an item is centered. If you want a group of items to appear centered in the Touch Bar, designate the group NSTouchBarItem as the principal item.</p>
<p>ä¸è¦å°è¯•é€šè¿‡æ·»åŠ  Space çš„æ–¹æ³•æ¥è®©ä¸€ä¸ª Item å±…ä¸­ï¼Œå¦‚æœä½ éœ€è¦è®©ä¸€ç»„ Item å±…ä¸­ï¼Œä½ å¯ä»¥ç”¨ä¸€ä¸ª BarItem Group å°†ä»–ä»¬åŒ…èµ·æ¥ç„¶åå°†æ•´ä¸ª Group è®¾ç½®ä¸ºå±…ä¸­ã€‚</p>
</blockquote>
<h4 id="NSTouchBarDelegate"><a href="#NSTouchBarDelegate" class="headerlink" title="NSTouchBarDelegate"></a>NSTouchBarDelegate</h4><p><strong>delegate</strong>ï¼ŒNSTouchBarDelegate åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£å°±æ˜¯  </p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSTouchBarItem</span> *)touchBar:(<span class="built_in">NSTouchBar</span> *)touchBar makeItemForIdentifier:(<span class="built_in">NSTouchBarItemIdentifier</span>)identifier;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯åˆå§‹åŒ–æ‰€æœ‰ BarItem çš„åœ°æ–¹ã€‚ä¸€èˆ¬æ¥è¯´å†™æ³•å°±æ˜¯æ ¹æ® Identifier æ¥åˆå§‹åŒ–å¯¹åº”çš„ BarItemï¼Œåƒè¿™æ ·</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ([identifier <span class="string">isEqualToString:</span>@<span class="string">"..."</span>])</span><br><span class="line">&#123; </span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">return</span> BarItem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Layout__26amp_3B_Nesting"><a href="#Layout__26amp_3B_Nesting" class="headerlink" title="Layout &amp; Nesting"></a>Layout &amp; Nesting</h3><p>ç”±äºç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰éœ€è¦æ˜¾ç¤ºçš„ Touch Bar å®½åº¦ï¼Œä½ å®šä¹‰å¥½çš„ Touch Bar å®½åº¦æ˜¯å¯å˜çš„ã€‚æ‰€ä»¥è‹¹æœçš„å»ºè®®æ˜¯<strong>åœ¨è®¾è®¡çš„æ—¶å€™ä¸è¦æŒ‰ç…§ç¡®å®šçš„å®½åº¦æ¥è®¾è®¡ï¼Œè€Œæ¤å…¥ä¸€äº›åŠ¨æ€å¸ƒå±€çš„æ–¹</strong>æ¡ˆã€‚å¦‚æœä½ éœ€è¦æ›´å®½çš„å®½åº¦ï¼Œä½ å¯ä»¥ä½¿ç”¨ Popoverï¼Œscrubber æˆ–è€… scroll viewã€‚</p>
<p>åœ¨ Layout çš„æ—¶å€™ï¼Œå“åº”é“¾ä¸Šå±‚çš„ Touch Bar æ˜¯å¯ä»¥åŒ…å«ä¸‹å±‚çš„ Touch Bar çš„ï¼Œä¸Šé¢åœ¨ç»¼è¿°çš„æ—¶å€™æåˆ°è¿‡çš„ <strong>Other Items Proxy</strong> å°±æ˜¯ç”¨æ¥å®ç°è¿™ä¸ªåŠŸèƒ½çš„ã€‚åªè¦ä½ åœ¨åˆå§‹åŒ– Touch Bar çš„æ—¶å€™ä¸ºå®ƒçš„ defaultIdentifiers åŠ ä¸Š NSTouchBarItemIdentifierOtherItemsProxyï¼Œä»–å°±ä¼šåœ¨è¿è¡Œæ—¶<strong>éœ€è¦çš„æ—¶å€™åœ¨è¿™ä¸ª Identifier æ‰€åœ¨çš„ä½ç½®</strong>åŒ…å«ä¸Šæ¥è‡ªä¸‹å±‚çš„åˆé€‚çš„ Touch Barã€‚è¿™ä¸ª<strong>éœ€è¦çš„æ—¶å€™</strong>æŒ‡çš„æ˜¯ä¸‹å±‚çš„ NSResponder è°ƒç”¨ becomeFirstResponder çš„æ—¶å€™ã€‚ä¾‹å¦‚æœ‰ä¸€ä¸ª ViewController è‡ªèº«å¸¦æœ‰ä¸€ä¸ª Touch Barï¼Œè€Œè¿™ä¸ª ViewController ä¸­å¸¦æœ‰ä¸€ä¸ª NSTextViewï¼Œé‚£ä¹ˆå½“ç‚¹å‡»è¿™ä¸ª NSTextview ï¼Œä¹Ÿå°±æ˜¯<strong>å“åº”é“¾ä¸‹å±‚ NSResponder è°ƒç”¨ becomeFirstResponder</strong> çš„æ—¶å€™ï¼ŒTouch Bar æ˜¾ç¤ºçš„æ˜¯ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/01/5818435fa4fdd.png" alt=""></p>
<p>è€Œå¦‚æœç„¦ç‚¹ä» TexView å¤±å»ï¼Œåˆ™æ¢å¤æˆ ViewController è¿™ä¸€å±‚çš„ Touch Barï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/01/58184323610b8.png" alt=""></p>
<p>å¦‚æœä¸€ä¸ª Touch Bar æ²¡æœ‰æ¤å…¥ NSTouchBarItemIdentifierOtherItemsProxy ï¼Œé‚£ä¹ˆå¦‚æœåœ¨å“åº”é“¾æ›´åº•å±‚å‡ºç°äº†ä¸€ä¸ªå¯ä»¥åŠ è½½çš„ Touch Barï¼Œé‚£ä¹ˆä¸Šå±‚çš„ Touch Bar éƒ½ä¼šè¢«éšè—ã€‚å“¦ï¼Œå¹¶ä¸” NSTouchBar çš„ visible å±æ€§æ˜¯å¯ä»¥ KVO çš„ã€‚</p>
<h4 id="Responder_Chain_Search"><a href="#Responder_Chain_Search" class="headerlink" title="Responder Chain Search"></a>Responder Chain Search</h4><p>æ‰€ä»¥ Touch Bar UI çš„åŠ è½½é¡ºåºå’Œ UIView çš„å“åº”é“¾ç±»ä¼¼ï¼Œéƒ½æ˜¯ç©¿è¿‡æ•´ä¸ªå“åº”é“¾ï¼Œä»æœ€åº•å±‚å¼€å§‹å‘ä¸Šå¯»æ‰¾ï¼Œå¦‚æœé‡åˆ°äº† otherItemsProxy ï¼Œ åˆ™ä¼šå°†ä¸¤è€…åˆå¹¶èµ·æ¥ä¹‹åç»§ç»­å¾€ä¸Šéå†ï¼Œç›´åˆ°æ‰¾åˆ°æœ€ä¸Šå±‚ï¼Œç”Ÿæˆä¸€ä¸ªæœ€ååŠ è½½å‡ºæ¥çš„ Touch Barã€‚</p>
<blockquote>
<p>Touch bars çš„åŠ è½½æ˜¯é€šè¿‡æŸ¥æ‰¾æŒ‡å®šçš„éµå¾ªäº† NSTouchBarProvider Protocol çš„ç»„ä»¶æ¥å®Œæˆçš„ã€‚æŒ‰ç…§ä»å“åº”é“¾ä¸Šå±‚å¾€ä¸‹çš„é¡ºåºä¾æ¬¡æ˜¯ï¼š</p>
<ul>
<li>the application delegate</li>
<li>the application object itself</li>
<li>the main windowâ€™s window controller</li>
<li>the main windowâ€™s delegate</li>
<li>the main window itself</li>
<li>the main windowâ€™s first responder</li>
<li>the key windowâ€™s window controller</li>
<li>the key windowâ€™s delegate</li>
<li>the key window itself</li>
<li>the key windowâ€™s first responder</li>
</ul>
<p>å¦‚æœä¸Šé¢è¿™äº›å¯¹è±¡æ˜¯ NSResponder æˆ–è€… NSResponder çš„å­ç±»ï¼Œä»¥è¯¥å¯¹è±¡ä¸ºèµ·ç‚¹çš„å“åº”é“¾ä¹Ÿä¼šè¢«åŒ…æ‹¬è¿›æ¥ã€‚ä¾‹å¦‚ AppDelegate åŸæœ¬æ˜¯ NSObjectï¼Œä½†æ˜¯<a href="http://stackoverflow.com/questions/6893221/why-does-appdelegate-inherit-from-uiresponder" target="_blank" rel="external">åœ¨ iOS ä¸Š AppDelegate å°±æ˜¯ç»§æ‰¿äº UIResponder</a> ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ · AppDelegate å°±å¯ä»¥æˆä¸ºæ•´ä¸ªå“åº”é“¾çš„æœ€ä¸Šå±‚äº†ã€‚å› æ­¤<strong>å¦‚æœæˆ‘ä»¬å°† AppDelegate æ”¹ä¸ºç»§æ‰¿äº NSResponder</strong> ï¼Œé‚£ä¹ˆåœ¨ AppDelegate å±‚ä¹Ÿå¯ä»¥åŠ ä¸Šä¸€å±‚ Touch Barã€‚ </p>
<p>ä¾‹å¦‚åœ¨ä¸€ä¸ªä¸€èˆ¬ç»“æ„çš„åº”ç”¨ä¸­ï¼Œè¿™ä¸ªå“åº”é“¾çš„æŸ¥æ‰¾é¡ºåºæ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>Application delegate</li>
<li>Application</li>
<li>key window controller</li>
<li>key window delegate</li>
<li>key window</li>
<li>view controller (closest to root of window)</li>
<li>view (closest to root of window)</li>
<li>intermediate view controllers and views</li>
<li>key windowâ€™s first responderâ€™s view controller</li>
<li>key windowâ€™s first responder</li>
</ul>
</blockquote>
<h4 id="Customization_Boundary"><a href="#Customization_Boundary" class="headerlink" title="Customization Boundary"></a>Customization Boundary</h4><p>é‚£ä¹ˆå¯¹äºæœ€åæ˜¾ç¤ºçš„ Touch Bar æ¥è¯´ï¼Œæ¯ä¸ª Touch Bar çš„ Customization å±æ€§ä¾ç„¶ç®¡ç”¨ã€‚å¦‚æœæ˜¯ A BaråŒ…å«äº† B Barï¼Œé‚£ä¹ˆå¯¹äº B Bar çš„ Customization æ˜¯ä¸èƒ½è¶…å‡º B Bar çš„èŒƒå›´çš„ã€‚ä¾‹å¦‚æœ‰ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bar.defaultItemIdentifiers </span>=@[IdentifierA,IdentifierB, NSTouchBarItemIdentifierOtherItemsProxy,IdentifierC]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª Bar å‡è®¾ä¸º A Barï¼Œåœ¨ä»–çš„ä¸‹å±‚æœ‰ä¸€ä¸ª B Barï¼Œé‚£ä¹ˆåœ¨ AB åŒæ—¶æ˜¾ç¤ºçš„æ—¶å€™ï¼Œå¦‚æœå¯¹ B Bar çš„ Item è¿›è¡Œ Customizationï¼Œé‚£ä¹ˆæ˜¯ä¸èƒ½ç§»åŠ¨ IdentifierAï¼ŒIdentifierB å’Œ IdentifierC çš„ä½ç½®çš„ã€‚</p>
<h4 id="Visual_Priority"><a href="#Visual_Priority" class="headerlink" title="Visual Priority"></a>Visual Priority</h4><p><strong>è§†å›¾ä¼˜å…ˆçº§</strong>ã€‚ç”±äºä½ æ‰€å¼€å‘çš„ Touch Bar åœ¨è¿è¡Œçš„æ—¶å€™æœ‰å¯èƒ½è¢«ç”¨æˆ·ä¿®æ”¹å®½åº¦ï¼Œå› æ­¤å¦‚æœä½ æœ‰ä¸€æ’ BarItemï¼Œä»–ä»¬ä¼šä»å³å¾€å·¦ä¾æ¬¡è¢«æŒ¤æ‰ï¼Œè¿™æ—¶å€™å¦‚æœå³è¾¹æœ‰ä¸€äº›é‡è¦çš„ BarItem å­˜åœ¨ï¼Œä½ å°±éœ€è¦ä¸ºä¸åŒçš„ BarItem è®¾ç½®ä¸åŒçš„è§†å›¾ä¼˜å…ˆçº§ï¼Œè¿™æ ·å³ä½¿å®½åº¦å˜åŒ–ï¼Œåœ¨é‡æ–° Layout çš„æ—¶å€™ä¹Ÿä¼šæŒ‰ç…§å®šä¹‰å¥½çš„è§†å›¾ä¼˜å…ˆçº§æ’åˆ— BarItemã€‚</p>
<p>ç³»ç»Ÿæä¾›äº†ä¸‰ç§é»˜è®¤çš„æšä¸¾ç±»å‹è§†å›¾ä¼˜å…ˆçº§ï¼Œåˆ†åˆ«ä¸º NSTouchBarItemPriorityHighï¼Œ NSTouchBarItemPriorityNormal å’Œ NSTouchBarItemPriorityLowï¼Œå¯¹åº”äº† 1000ï¼Œ0 å’Œ -1000 çš„ float ç±»å‹çš„å€¼ï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä¸º BarItem è®¾ç½® float ç±»å‹çš„ä¼˜å…ˆçº§ã€‚</p>
<h3 id="u7528_Storyboard__u6765_u5B9A_u4E49_u4F60_u7684_Multi-Touch_Bar"><a href="#u7528_Storyboard__u6765_u5B9A_u4E49_u4F60_u7684_Multi-Touch_Bar" class="headerlink" title="ç”¨ Storyboard æ¥å®šä¹‰ä½ çš„ Multi-Touch Bar"></a>ç”¨ Storyboard æ¥å®šä¹‰ä½ çš„ Multi-Touch Bar</h3><p>è®²äº†è¿™ä¹ˆå¤šï¼Œç”¨ä»£ç ç”Ÿæˆ Touch Bar å¤šç´¯å•Šï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç”¨ Storyboard æ¥åˆ›å»ºå§ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2016/11/01/581844c5bc04f.jpg" alt=""></p>
<p>æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å¾€ä½ çš„ ViewController é‡Œé¢ä»å³ä¸‹è§’æ‹–ä¸€ä¸ª Touch Bar è¿‡æ¥å°±è¡Œäº†ã€‚ç„¶åå¾€é‡Œé¢æ·»åŠ æ§ä»¶ï¼Œå¯¹äºä¸åŒçš„æ§ä»¶ï¼ŒDelegateï¼ŒDatasource å’Œæ§ä»¶çš„è§¦å‘äº‹ä»¶ï¼Œéƒ½æ˜¯ç”¨ Control-Drag çš„æ–¹æ³•å°†å¼•ç”¨åŠ åˆ°ä½ çš„ .m æ–‡ä»¶é‡Œå»ã€‚</p>
<h3 id="u5404_u79CD_u63A7_u4EF6_u7684_u5177_u4F53_u7528_u6CD5"><a href="#u5404_u79CD_u63A7_u4EF6_u7684_u5177_u4F53_u7528_u6CD5" class="headerlink" title="å„ç§æ§ä»¶çš„å…·ä½“ç”¨æ³•"></a>å„ç§æ§ä»¶çš„å…·ä½“ç”¨æ³•</h3><p>æ¥ä¸‹æ¥è¯¥æ˜¯ä¸€ä¸ªä¸ªæ¥è®²æ§ä»¶äº†ï¼Œä¹Ÿæ˜¯å¤§å®¶åœ¨ä¹‹åçš„å¼€å‘ä¸­æœ€å®ç”¨çš„éƒ¨åˆ†å•¦ã€‚</p>
<h4 id="NSColorPickerTouchBarItem"><a href="#NSColorPickerTouchBarItem" class="headerlink" title="NSColorPickerTouchBarItem"></a>NSColorPickerTouchBarItem</h4><p>colorPicker æœ‰ä¸‰ç§åˆå§‹åŒ–æ–¹æ³•ï¼š</p>
<ul>
<li>colorPickerWithIdentifier</li>
<li>textColorPickerWithIdentifier</li>
<li>strokeColorPickerWithIdentifier</li>
</ul>
<p>è¿™ä¸‰ç§æ–¹æ³•çš„åŒºåˆ«å…¶å®å°±æ˜¯åœ¨æŒ‰é’®æ˜¾ç¤ºçš„å›¾æ ‡ä¸Šï¼Œä¸€ä¸ªæ˜¯å¸¸è§„çš„é¢œè‰²é€‰æ‹©å™¨ï¼Œç¬¬äºŒä¸ªä»£è¡¨çš„æ˜¯å­—ä½“é¢œè‰²é€‰æ‹©å™¨ï¼Œç¬¬ä¸‰ç§åˆå§‹åŒ–ä»£è¡¨çš„æ˜¯è¾¹æ¡†é¢œè‰²é€‰æ‹©å™¨ã€‚åˆå§‹åŒ–ä¹‹åçš„é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼š</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line">colorPickerItem.<span class="keyword">target</span> = self;</span><br><span class="line">colorPickerItem.action = <span class="meta">@selector</span>(ColorAction:);</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ <code>ColorAction</code> è¿™ä¸ªæ–¹æ³•ä¸­è·å¾—é€‰æ‹©åˆ°çš„é¢œè‰²ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">((<span class="selector-tag">NSColorPickerTouchBarItem</span> *)<span class="selector-tag">sender</span>)<span class="selector-class">.color</span></span><br></pre></td></tr></table></figure>
<p><strong>@property colorList</strong></p>
<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ <strong>colorList</strong> è¿™ä¸ªå±æ€§æ¥è‡ªå®šä¹‰ Color Picker èƒ½å¤Ÿé€‰å–çš„é¢œè‰²åˆ—è¡¨ã€‚å¦‚æœä¸è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œåˆ™é»˜è®¤æ˜¾ç¤ºçš„æ˜¯ç³»ç»Ÿçš„å–è‰²ç›˜ï¼Œå„ç§é¢œè‰²éƒ½æœ‰ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/02/5819676729847.png" alt=""></p>
<p>å½“ç»™äº†ä¸€ä¸ª list ä¹‹åï¼š</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">colorPickerItem.colorList = [[<span class="symbol">NSColorList</span> alloc] init];</span><br><span class="line">[colorPickerItem.colorList setColor:[<span class="symbol">NSColor</span> redColor] forKey:@<span class="string">"Red"</span>];</span><br><span class="line">[colorPickerItem.colorList setColor:[<span class="symbol">NSColor</span> greenColor] forKey:@<span class="string">"Green"</span>];</span><br><span class="line">[colorPickerItem.colorList setColor:[<span class="symbol">NSColor</span> blueColor] forKey:@<span class="string">"Blue"</span>];</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºçš„å°±æ˜¯è¿™æ ·ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/02/58196802031d6.png" alt=""></p>
<h4 id="NSSliderTouchBarItem"><a href="#NSSliderTouchBarItem" class="headerlink" title="NSSliderTouchBarItem"></a>NSSliderTouchBarItem</h4><p>åˆå§‹åŒ–ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">sliderTouchBarItem.slider.minValue = <span class="number">0</span>.<span class="number">0</span>f<span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.slider.maxValue = <span class="number">100</span>.<span class="number">0</span>f<span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.slider.continuous = YES<span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.target = self<span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.action = @selector(sliderChanged:)<span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.label = @<span class="string">"Slider"</span><span class="comment">;</span></span><br><span class="line">sliderTouchBarItem.customizationLabel = @<span class="string">"Slider"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé¢çš„ action ä¼šåœ¨ slider çš„å€¼æ¯ä¸€æ¬¡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è°ƒç”¨ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ SliderItem è¿˜æä¾›äº†ä¸¤ä¸ª AccessoryView çš„è‡ªå®šä¹‰ç©ºé—´ï¼Œå·¦å³å„ä¸€ä¸ªï¼Œåˆ†åˆ«å«åš <strong>minimumValueAccessory</strong> å’Œ <strong>maximumValueAccessory</strong>ï¼Œå¯ä»¥ç”¨ NSImage æ¥åˆå§‹åŒ–ä»–ä»¬ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSSliderAccessory</span> *minSliderAccessory = [<span class="built_in">NSSliderAccessory</span> accessoryWithImage:image];</span><br></pre></td></tr></table></figure>
<p>å…¶ä»–çš„è‡ªå®šä¹‰éƒ½æ˜¯å›´ç»•ç€ NSSlider åšçš„äº†ã€‚</p>
<h4 id="NSScrubber"><a href="#NSScrubber" class="headerlink" title="NSScrubber"></a>NSScrubber</h4><p>è¿™æ˜¯ä¸€ä¸ªä¸ºäº† Touch Bar è€Œå…¨æ–°åˆ›å»ºçš„æ§ä»¶ï¼Œåœ¨å‘å¸ƒä¼šä¸Šæœ‰ç€é‡çš„å±•ç¤ºã€‚ä»–éœ€è¦å•ç‹¬çš„æ·»åŠ åˆ°ä¸€ä¸ª TouchBarItem é‡Œå»ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">scrubber = [[<span class="built_in">NSScrubber</span> alloc] initWithFrame:<span class="built_in">NSMakeRect</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">310</span>, <span class="number">30</span>)];</span><br><span class="line"><span class="comment">// Height should be 30 </span></span><br><span class="line">scrubber.delegate = <span class="keyword">self</span>;   </span><br><span class="line">scrubber.dataSource = <span class="keyword">self</span>;</span><br></pre></td></tr></table></figure>
<p>NSScrubber ç±»ä¼¼ UICollectionView ï¼Œä¹Ÿæ˜¯æœ‰åŸºäº ItemView çš„å¤ç”¨æœºåˆ¶çš„ï¼Œä½ å¯ä»¥ç»§æ‰¿ NSScrubberItemView æ¥å†™ä½ è‡ªå·±éœ€è¦çš„ CustomItemViewã€‚ç„¶ååœ¨åˆå§‹åŒ–ä¹‹åéœ€è¦ä¸º ItemView åŠ ä¸Šä¸€ä¸ªå¤ç”¨çš„æ ‡è¯†ï¼š</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line">[<span class="name">scrubber</span> registerClass:[<span class="name">NSScrubberItemView</span> class] forItemIdentifier:ScrubberItemIdentifier]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>@property showsAdditionalContentIndicators</strong> </p>
<p>ä»£è¡¨çš„æ˜¯å½“å·¦å³æ»‘åŠ¨è¿˜æœ‰æ›´å¤šå†…å®¹çš„æ—¶å€™ï¼Œåœ¨å·¦å³ä¾§ä¼šæ˜¾ç¤ºä¸€å—æ¸å˜çš„è’™å±‚ï¼Œç”¨æ¥è¡¨ç¤ºæ»‘åŠ¨è¿˜æœ‰æ›´å¤šå†…å®¹ï¼Œä½ å¯ä»¥é€‰æ‹©æ˜¯å¦æ˜¾ç¤ºã€‚</p>
<p><strong>@property selectedIndex</strong> </p>
<p>å³å½“å‰é€‰ä¸­çš„ ItemView çš„ indexï¼Œå¯ä»¥ç›´æ¥è®¾ç½®ã€‚</p>
<p><strong>@property showsArrowButtons</strong> </p>
<p>ä»£è¡¨çš„æ˜¯æ˜¯å¦æ˜¾ç¤ºå·¦å³ç§»åŠ¨çš„ç®­å¤´æŒ‰é’®ï¼Œå¦‚æœæ˜¾ç¤ºçš„è¯ä½ ä¹Ÿå¯ä»¥ç‚¹å‡»å·¦å³ç®­å¤´çš„æŒ‰é’®æ¥æ»‘åŠ¨åˆ—è¡¨ã€‚</p>
<p><strong>@property backgroundColor</strong> </p>
<p>NSScrubber çš„èƒŒæ™¯é¢œè‰²ï¼Œæ˜¾ç¤ºåœ¨å†…å®¹ä¹‹åï¼Œå¦‚æœ <strong>backgroundView</strong> ä¸ºç©ºæ‰ä¼šæ˜¾ç¤ºï¼ŒåŒæ—¶ä¹Ÿæ˜¯åªæœ‰ NSScrubberTextItemView ç±»å‹çš„ ItemView æ‰ä¼šæ˜¾ç¤ºå‡ºåé¢çš„èƒŒæ™¯é¢œè‰²ã€‚</p>
<p><strong>@property DataSource</strong></p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="built_in">NSInteger</span>)numberOfItemsForScrubber:(<span class="built_in">NSScrubber</span> *)scrubber</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSScrubberItemView</span> *)scrubber:(<span class="built_in">NSScrubber</span> *)scrubber viewForItemAtIndex:(<span class="built_in">NSInteger</span>)index</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">NSScrubberItemVie</span> *itemView = [scrubber makeItemWithIdentifier:ScrubberItemIdentifier owner:<span class="literal">nil</span>];</span><br><span class="line">	<span class="keyword">return</span> itemView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•°æ®æºåŠ è½½æ¯”è¾ƒç®€å•ï¼Œä¸€ä¸ªç»™ Item çš„æ€»æ•°ï¼Œå¦ä¸€ä¸ªç»™ ItemView å°±è¡Œï¼Œä¸Šé¢ç»™å‡ºäº†æœ€ç®€å•çš„ç¤ºä¾‹ã€‚</p>
<p><strong>@property Delegate</strong></p>
<p>NSScrubber æœ‰å¥½å‡ ä¸ª Delegate å¯ä»¥è°ƒç”¨ï¼Œä¹Ÿéƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œä¸€èˆ¬æ¥è¯´å®ç°ç¬¬ä¸€ä¸ªé€‰ä¸­å›è°ƒå°±è¶³å¤Ÿäº†ï¼š</p>
<ul>
<li>didSelectItemAtIndex:(NSInteger)selectedIndex </li>
<li>didHighlightItemAtIndex:(NSInteger)highlightedIndex </li>
<li>didChangeVisibleRange:(NSRange)visibleRange</li>
<li>didBeginInteractingWithScrubber:(NSScrubber *)scrubber</li>
<li>didFinishInteractingWithScrubber:(NSScrubber *)scrubber</li>
<li>didCancelInteractingWithScrubber:(NSScrubber *)scrubber</li>
</ul>
<p><strong>@property mode</strong></p>
<p>è¿™ä¸ªä»£è¡¨çš„æ˜¯ NSScrubber çš„æ»‘åŠ¨æ¨¡å¼ï¼Œä¸€å…±å°±ä¸¤ç§ï¼Œ<strong>NSScrubberModeFree</strong> å’Œ <strong>NSScrubberModeFixed</strong>ã€‚</p>
<p>Free æ¨¡å¼ä¸‹çš„ Scrubber å¯ä»¥è‡ªç”±çš„æ»‘åŠ¨ï¼Œä½†æ˜¯ä½ å¿…é¡»åœ¨<strong>æ»‘åŠ¨ä¹‹åå†æ¬¡å•å‡» Item</strong> æ¥é€‰ä¸­ï¼Œè€Œ Fixed æ¨¡å¼ä¸‹çš„ Scrubber æ˜¯ä¸èƒ½è‡ªç”±æ»‘åŠ¨çš„ï¼Œä½†æ˜¯å¯¹äº ItemView çš„é€‰ä¸­æ˜¯<strong>è·Ÿéšæ‰‹æŒ‡çš„æ‹–åŠ¨</strong>çš„ï¼Œä¸éœ€è¦è®©æ‰‹æŒ‡ç¦»å¼€ Touch Bar å†æ¬¡ç‚¹å‡»é€‰ä¸­ã€‚å¯¹äºå®½åº¦å›ºå®šï¼Œæˆ–è€…ä¸éœ€è¦ç”¨æˆ·å†æ»‘å‡ºèŒƒå›´çš„ Scrubber å¯ä»¥ä½¿ç”¨ Fixed æ¨¡å¼ã€‚</p>
<p><strong>@property SelectionStyle</strong></p>
<p>Scrubber ç»™é€‰ä¸­æ ·å¼æä¾›äº†å¾ˆæ–¹ä¾¿çš„è‡ªå®šä¹‰å±æ€§ï¼Œæœ‰ <strong>selectionBackgroundStyle</strong> å’Œ <strong>selectionOverlayStyle</strong>ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® <strong>floatsSelectionViews</strong> ä¸º YES è®©é€‰ä¸­ View åˆ‡æ¢çš„æ—¶å€™å¯ä»¥åŠ ä¸Šä» A ç‚¹åˆ° B ç‚¹æµç•…çš„ç§»åŠ¨åŠ¨ç”»ï¼Œè€Œä¸æ˜¯ä» A ç‚¹æ¶ˆå¤±ç„¶åä» B ç‚¹å‡ºç°è¿™æ ·çš„åŠ¨ç”»ã€‚</p>
<p>selectionBackgroundStyle å’Œ selectionOverlayStyle åˆ†åˆ«æ˜¯é€‰ä¸­çš„æ—¶å€™<strong>èƒŒæ™¯</strong>å’Œ<strong>è¡¨é¢è’™å±‚</strong>çš„æ ·å¼ï¼Œåªæä¾›äº† outlineOverlayStyle</p>
<p><img src="https://ooo.0o0.ooo/2016/11/02/5819b0f9959ad.png" alt=""></p>
<p>å’Œ roundedBackgroundStyle ä¸¤ç§é»˜è®¤æ ·å¼ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/11/02/5819b17f754fb.png" alt=""></p>
<p>å½“ç„¶ï¼Œè¿™ä¸ª SelectionStyle ä¹Ÿæ˜¯é«˜åº¦è‡ªå®šä¹‰çš„ï¼Œä½†æ˜¯ä½ éœ€è¦ç»§æ‰¿ä¸¤ä¸ªè§†å›¾çš„åŸºç±»æ¥å®ç°ï¼š</p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªç»§æ‰¿äº NSScrubberSelectionStyle çš„ CustomStyle </li>
<li>é‡è½½ <code>-(nullable __kindof NSScrubberSelectionView *)makeSelectionView</code> è¿™ä¸ªæ–¹æ³•</li>
<li>å®šä¹‰ä¸€ä¸ªç»§æ‰¿äº NSScrubberSelectionView çš„ CustomSelectionView</li>
<li>è‡ªå®šä¹‰ CustomSelectionView çš„æ ·å¼</li>
<li>åœ¨é‡è½½çš„æ–¹æ³•ä¸­è¿”å› CustomSelectionView</li>
</ol>
<p><strong>@property scrubberLayout</strong></p>
<p>ç±»ä¼¼äº UICollectionView ï¼ŒNSScrubber çš„ layout ä¹Ÿæ˜¯ç”± <strong>NSScrubberLayout</strong> æ¥æ§åˆ¶çš„ã€‚ç³»ç»Ÿæä¾›äº†ä¸¤ç§é»˜è®¤çš„ Layoutï¼Œ<strong>NSScrubberFlowLayout</strong> å’Œ <strong>NSScrubberProportionalLayout</strong>ã€‚å‰è€…å¯ä»¥é€šè¿‡ LayoutDelegate æ¥ç»™å‡ºæ¯ä¸€ä¸ª Item æ‰€å çš„å®½åº¦ï¼Œåè€…åˆ™ä¸éœ€è¦é€šè¿‡ delegate è€Œæ˜¯ç›´æ¥å°† Item çš„å®½åº¦è®¾ç½®ä¸º Scrubber çš„å¯è§†åŒºåŸŸæŒ‰ç…§ Item çš„æ•°é‡å¹³åˆ†ä¹‹åçš„å®½åº¦ã€‚ä½ å¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">NSScrubberLayout *scrubberLayout;</span><br><span class="line">scrubberLayout = <span class="comment">[<span class="comment">[NSScrubberFlowLayout alloc]</span> init]</span>;</span><br><span class="line">// or:</span><br><span class="line">scrubberLayout = <span class="comment">[<span class="comment">[NSScrubberProportionalLayout alloc]</span> init]</span>;</span><br><span class="line">scrubber.scrubberLayout = scrubberLayout;</span><br></pre></td></tr></table></figure>
<p>å¯¹äº NSScrubberFlowLayoutDelegate ä½ éœ€è¦å®ç°è¿™ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="built_in">NSSize</span>)scrubber:(<span class="built_in">NSScrubber</span> *)scrubber layout:(<span class="built_in">NSScrubberFlowLayout</span> *)layout sizeForItemAtIndex:(<span class="built_in">NSInteger</span>)itemIndex</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">NSMakeSize</span>(width, <span class="number">30</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="NSSharingServicePickerTouchBarItem"><a href="#NSSharingServicePickerTouchBarItem" class="headerlink" title="NSSharingServicePickerTouchBarItem"></a>NSSharingServicePickerTouchBarItem</h4><p>NSSharingServicePickerTouchBarItem çš„ delegate åªæœ‰ä¸€ä¸ªå§”æ‰˜æ–¹æ³•éœ€è¦å®ç°ï¼š</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (NSArray *)<span class="selector-tag">itemsForSharingServicePickerTouchBarItem</span><span class="selector-pseudo">:(NSSharingServicePickerTouchBarItem</span> *)<span class="selector-tag">pickerTouchBarItem</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="selector-tag">return</span> @<span class="selector-attr">[...]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¸€å®šè¦æ˜¯èƒ½å¤Ÿæ”¯æŒ NSPasteboardWriting åè®®æˆ–è€…æ˜¯ç»§æ‰¿äº NSItemProvider çš„å¯¹è±¡ï¼Œä¾‹å¦‚æ–‡æœ¬ï¼Œå›¾ç‰‡æˆ–è€… NSURLï¼Œå¯ä»¥å‚è€ƒ <a href="https://developer.apple.com/reference/foundation/nsitemprovider?language=objc" target="_blank" rel="external">NSItemProvider çš„å®˜æ–¹æ–‡æ¡£</a>ã€‚ç„¶åå°±ä¼šåœ¨åˆ†äº«çš„æ—¶å€™ä¼ åˆ°åˆ†äº«çš„åº”ç”¨é‡Œå»ã€‚</p>
<h4 id="NSPopoverTouchBarItem"><a href="#NSPopoverTouchBarItem" class="headerlink" title="NSPopoverTouchBarItem"></a>NSPopoverTouchBarItem</h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹å¦‚ä½•è‡ªå®šä¹‰ Popover åœ¨æœªç‚¹å‡»çŠ¶æ€ä¸‹çš„æ˜¾ç¤º Buttonã€‚</p>
<ul>
<li>collapsedRepresentation å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™æ˜¾ç¤ºä¸€ä¸ªè‡ªå®šä¹‰çš„ NSViewï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™åŠ è½½ä¸ä¸ºç©ºçš„ä¸‹é¢ä¸¤ä¸ªå±æ€§</li>
<li>collapsedRepresentationImage ç»™ Popover çš„ button æ·»åŠ ä¸€ä¸ª NSImage</li>
<li>collapsedRepresentationLabel ç»™ Popover çš„ button æ·»åŠ ä¸€ä¸ª <strong>NSString</strong></li>
</ul>
<p>Popover å…¶å®æ˜¯åœ¨ç‚¹å‡»æŒ‰é’®ä¹‹åå¼¹å‡ºä¸€ä¸ª<strong>æ–°çš„ Touch Bar</strong>ï¼Œä½ éœ€è¦å†åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ Touch Bar å¹¶åœ¨åŒæ ·çš„ Delegate ä¸­è¿”å›å¯¹åº”çš„ BarItemï¼Œæ³¨æ„å®ƒå’Œä½ ä¹‹å‰çš„ Touch Bar ä¸æ˜¯å“åº”é“¾ä¸Šä¸‹å±‚çš„å…³ç³»ï¼Œå› æ­¤ä¸ä¼šå‡ºç° Nesting å³ä¸Šå±‚çš„ Touch Bar åŒ…å«ä¸‹å±‚çš„ Touch Barï¼Œè€Œæ˜¯å®Œå…¨è¦†ç›–äº†ä¸‹é¢çš„ Touch Barã€‚å¦‚æœä½ å°†æ–°çš„ Touch Bar èµ‹å€¼ç»™äº† <strong>pressAndHoldTouchBar</strong> è€Œä¸æ˜¯ <strong>popoverTouchBar</strong>ï¼Œä½ è¿˜å¯ä»¥å®ç°æŒ‰ä½æŒ‰é’®æ˜¾ç¤º Popover ä¸”æ¾å¼€æ‰‹æŒ‡è¿”å›ã€‚</p>
<h4 id="Touch_Bar_Image_Template"><a href="#Touch_Bar_Image_Template" class="headerlink" title="Touch Bar Image Template"></a>Touch Bar Image Template</h4><p>æœ€åè¿˜è¦ä¸ºå¤§å®¶æä¾›ä¸€ä¸ªä¾¿åˆ©ï¼Œè‹¹æœä¸ºäº†æ”¯æŒ Touch Bar çš„å¼€å‘ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†ç»Ÿä¸€è®¾è®¡æ ·å¼ï¼Œåœ¨ NSImage ä¸­æ·»åŠ äº†éå¸¸å¤š Button çš„æ¨¡æ¿å›¾ç‰‡ï¼Œç”±äºæä¾›çš„æ¨¡æ¿å¤ªå¤šäº†ï¼Œä¸ä¸€ä¸€åˆ—å‡ºï¼Œå°±æŠŠåˆ—è¡¨é™„ä¸Šï¼Œå¦‚æœæœ‰åŒå­¦å¼€å‘çš„æ—¶å€™æœ‰éœ€è¦å¯ä»¥å» NSImage çš„å¤´æ–‡ä»¶é‡Œé¢æ‰¾ï¼Œå¦‚æœç³»ç»Ÿæ¨¡æ¿æœ‰çš„è¯å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2016/11/02/5819c14c90072.png" alt=""></p>
<h3 id="u6700_u540E"><a href="#u6700_u540E" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>Touch Bar å¼€å‘çš„æ–°ç‰¹æ€§å’Œå‘è‚¯å®šè¿˜æœ‰å¾ˆå¤šï¼Œç°åœ¨æ–°çš„ MBP éƒ½è¿˜æ²¡å‘è´§ï¼Œç›¸ä¿¡ç­‰æ›´å¤šçš„å¼€å‘è€…å¼€å§‹çœŸæ­£å¼€å‘ä¸Šé¢çš„æ’ä»¶ä¹‹åä¼šæœ‰æ›´ä¸°å¯Œçš„ç»éªŒå’Œæ€»ç»“äº§ç”Ÿï¼Œæˆ‘è¿™ç¯‡åšå®¢ä¹Ÿå°±æ˜¯æŠ•çŸ³é—®è·¯ã€‚ç„¶è€Œï¼Œå¯¹ Touch Bar ååˆ†æ„Ÿå…´è¶£çš„æˆ‘å·²ç»ç­‰ä¸åŠå¼€å§‹ç ”ç©¶å®ƒå¹¶ä¸”å¼€å§‹å‡†å¤‡åœ¨ä¸Šé¢åšä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿äº†ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h3 id="u5927_u81F4"><a href="#u5927_u81F4" class="headerlink" title="å¤§è‡´"></a>å¤§è‡´</h3><p>å½“ä½ ]]>
    </summary>
    
      <category term="Cocoa" scheme="http://sergiochan.github.io/tags/Cocoa/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ADB ä¸¤ä¸‰äº‹-æ®‹]]></title>
    <link href="http://sergiochan.github.io/2016/10/24/ADB-%E4%B8%A4%E4%B8%89%E4%BA%8B-%E6%AE%8B/"/>
    <id>http://sergiochan.github.io/2016/10/24/ADB-ä¸¤ä¸‰äº‹-æ®‹/</id>
    <published>2016-10-24T04:24:50.000Z</published>
    <updated>2016-10-24T14:29:43.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æŠ˜è…¾äº†ä¸¤å¤© ADBï¼Œ å®›è‹¥ä¸€ä¸ªæ™ºéšœã€‚é‡åˆ°å¦‚ä¸‹é—®é¢˜ã€‚</p>
<h2 id="u4ECE_u7535_u8111_push__u591A_u4E2A_u6587_u4EF6_u5230_u8BBE_u5907__3A_wildCard"><a href="#u4ECE_u7535_u8111_push__u591A_u4E2A_u6587_u4EF6_u5230_u8BBE_u5907__3A_wildCard" class="headerlink" title="ä»ç”µè„‘ push å¤šä¸ªæ–‡ä»¶åˆ°è®¾å¤‡ : wildCard"></a>ä»ç”µè„‘ push å¤šä¸ªæ–‡ä»¶åˆ°è®¾å¤‡ : wildCard</h2><p>å‚è€ƒ<a href="http://xmodulo.com/how-to-copy-or-transfer-multiple-files-to-android-devices.html" target="_blank" rel="external">è¿™ç¯‡</a>ã€‚</p>
<p>ä¸€å¼€å§‹ç”¨ *.* çš„æ–¹å¼å°†æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ push åˆ°è®¾å¤‡çš„ç›®å½•ä¸‹ï¼Œä½†æ˜¯å§‹ç»ˆå¤±è´¥ã€‚æŸ¥æ— æœï¼Œåªçœ‹åˆ°äº†ä¸Šé¢è¿™ç¯‡è¯´ä¸æ”¯æŒçš„ï¼Œäºæ˜¯çœ‹äº†ä¸‹è‡ªå·±çš„ ADB ç‰ˆæœ¬å·ï¼Œ1.0.32ã€‚ç¡®è®¤è¿™ä¸ªç‰ˆæœ¬æ˜¯ä¸æ”¯æŒ wildCard åŒ¹é…æ–‡ä»¶çš„ã€‚é‚å°† *.* è¿™ç§è¡¨ç¤ºæ–¹å¼æ”¹æˆäº† shell ä¸­çš„ for å¾ªç¯ã€‚</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i in <span class="string">`ls /Users/sergiochan/xxx/`</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">echo <span class="string">"/Users/sergiochan/xxx/$i"</span></span><br><span class="line">adb <span class="keyword">push</span> <span class="string">"/Users/sergiochan/xxx/$i"</span> /<span class="keyword">system</span>/<span class="string">&#123;destination&#125;</span>/</span><br><span class="line">adb <span class="keyword">push</span> <span class="string">"/Users/sergiochan/xxx/$i"</span> /<span class="keyword">system</span>/<span class="string">&#123;destination&#125;</span>/<span class="string">&#123;subDestination&#125;</span>/</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>åæ¥è¯•äº†ä¸€ä¸‹æ‰å‘ç°å‡çº§åˆ° 1.0.36 æ˜¯å¯ä»¥æ”¯æŒçš„ã€‚é‚ï¼Œå’ã€‚</p>
<h2 id="ADB_remount__u663E_u793A_succeeded__u5374_u5E76_u6CA1_u6709_u6210_u529F_u6302_u8F7D"><a href="#ADB_remount__u663E_u793A_succeeded__u5374_u5E76_u6CA1_u6709_u6210_u529F_u6302_u8F7D" class="headerlink" title="ADB remount æ˜¾ç¤º succeeded å´å¹¶æ²¡æœ‰æˆåŠŸæŒ‚è½½"></a>ADB remount æ˜¾ç¤º succeeded å´å¹¶æ²¡æœ‰æˆåŠŸæŒ‚è½½</h2><p>é‡å¯å¤§æ³•å¥½å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚</p>
<h2 id="u60F3_u8981_u5728_Android_App__u4E2D_u8FD0_u884C_shell_uFF1F"><a href="#u60F3_u8981_u5728_Android_App__u4E2D_u8FD0_u884C_shell_uFF1F" class="headerlink" title="æƒ³è¦åœ¨ Android App ä¸­è¿è¡Œ shellï¼Ÿ"></a>æƒ³è¦åœ¨ Android App ä¸­è¿è¡Œ shellï¼Ÿ</h2><p>å¯ä»¥è¯´å¾ˆéº»çƒ¦ä¹ˆ =3=</p>
<p>é™¤éä½ æ˜¯ä»¥ root ç”¨æˆ·è¿è¡Œçš„ appï¼Œå¦åˆ™å¦‚æœæ˜¯æ™®é€šç”¨æˆ·çš„è¯ï¼Œè¿ system è·¯å¾„ä¸‹çš„æ–‡ä»¶éƒ½æ²¡æ³•ä¿®æ”¹ï¼Œæ›´åˆ«è¯´ su äº†ã€‚ä¸è¿‡ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ system è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ manifest ä¸­åŠ ä¸Š <strong>android:sharedUserId=â€android.uid.systemâ€</strong> è®©ä½ çš„ app ä»¥ system ç”¨æˆ·è¿è¡Œï¼Œç„¶åå°±å¯ä»¥ç›´æ¥é€šè¿‡ <strong>FileOutputStream</strong> çš„æ–¹å¼ä¿®æ”¹ system è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚æ§åˆ¶ CPU å†…å­˜ä»€ä¹ˆçš„ã€‚</p>
<p>æƒ³è¦è¿è¡Œ shell ï¼Œå¯ä»¥åœ¨ ADB å‘½ä»¤è¡Œé€šè¿‡ ps å‘½ä»¤æŸ¥çœ‹ä½ çš„ package è¿è¡Œçš„ç”¨æˆ·æ˜¯è°ï¼Œä¾‹å¦‚ç”¨æˆ· testï¼Œå¦‚æœä½  <code>su test</code> ä¹‹åå†è¿è¡Œ <code>su</code> æ˜¾ç¤ºçš„æ˜¯ <strong>Permission Denied</strong>ï¼Œé‚£å°±æ²¡æœ‰åŠæ³•äº†ã€‚å¦‚æœ root è¿‡åçš„è®¾å¤‡ç»™ä½ çš„è¿è¡Œç”¨æˆ·é…äº†ç”¨æˆ·æƒé™ä»€ä¹ˆçš„ï¼Œé‚£è®°å¾—åœ¨ Android ä¸­æ‰§è¡Œ shell ä¹‹å‰ï¼Œæ‰§è¡Œä¸€ä¸‹ <code>su</code> :</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">try</span> &#123;</span><br><span class="line">	<span class="built_in">Process</span> <span class="built_in">process</span> = Runtime.getRuntime().exec(<span class="string">"su"</span>);</span><br><span class="line">	<span class="built_in">process</span>.waitFor();</span><br><span class="line">&#125; <span class="built_in">catch</span> (IOException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125; <span class="built_in">catch</span> (InterruptedException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æŠ˜è…¾äº†ä¸¤å¤© ADBï¼Œ å®›è‹¥ä¸€ä¸ªæ™ºéšœã€‚é‡åˆ°å¦‚ä¸‹é—®é¢˜ã€‚</p>
<h2 id="u4ECE_u7535_u8111_push__u591A_u4E2A_u6587_u4EF6_u]]>
    </summary>
    
      <category term="ADB" scheme="http://sergiochan.github.io/tags/ADB/"/>
    
      <category term="Android" scheme="http://sergiochan.github.io/tags/Android/"/>
    
      <category term="Android Debug Bridge" scheme="http://sergiochan.github.io/tags/Android-Debug-Bridge/"/>
    
      <category term="æ™ºéšœ" scheme="http://sergiochan.github.io/tags/%E6%99%BA%E9%9A%9C/"/>
    
      <category term="æ®‹å¿µ" scheme="http://sergiochan.github.io/tags/%E6%AE%8B%E5%BF%B5/"/>
    
      <category term="å®‰å“èœé¸Ÿå¿ƒå¾—" scheme="http://sergiochan.github.io/categories/%E5%AE%89%E5%8D%93%E8%8F%9C%E9%B8%9F%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åœ¨ WKWebView ä¸­å®ç° Safari åŸç”Ÿçš„é˜…è¯»æ¨¡å¼]]></title>
    <link href="http://sergiochan.github.io/2016/10/21/%E5%A6%82%E4%BD%95%E5%9C%A8-WKWebView-%E4%B8%AD%E5%AE%9E%E7%8E%B0-Safari-%E5%8E%9F%E7%94%9F%E7%9A%84%E9%98%85%E8%AF%BB%E6%A8%A1%E5%BC%8F/"/>
    <id>http://sergiochan.github.io/2016/10/21/å¦‚ä½•åœ¨-WKWebView-ä¸­å®ç°-Safari-åŸç”Ÿçš„é˜…è¯»æ¨¡å¼/</id>
    <published>2016-10-21T06:28:16.000Z</published>
    <updated>2016-10-21T07:08:23.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œé˜…è¯»æ¨¡å¼é€šå¸¸æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæœ‰äººè¯´è¿™æ˜¯è¯»å°è¯´ç¥å™¨ï¼Œæœ‰äº›äººåˆ™è®¤ä¸ºé˜…è¯»æ¨¡å¼å¯ä»¥æ”¹å–„æ–°é—»ç½‘ç«™çš„é˜…è¯»ä½“éªŒï¼Œè€Œæœ‰äº›å¹¿å‘Šå•†åˆ™å¯¹æ­¤æŠ—è®®ï¼Œè®¤ä¸ºé˜…è¯»æ¨¡å¼æŸå®³äº†å¹¿å‘Šä¸»åˆ©ç›Šã€‚å½“ç„¶ï¼Œé˜…è¯»æ¨¡å¼å¯¹äºæ™®é€šç”¨æˆ·æ¥è¯´æ˜¯ä¸€ç§å¾ˆæ–¹ä¾¿å®ç”¨çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæ— å¯åšéã€‚</p>
<p>åœ¨æ‰‹æœºä¸Šï¼Œé˜…è¯»æ¨¡å¼æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯å’Œ Safari çš„å®ç°ç±»ä¼¼çš„ï¼Œåˆ©ç”¨ js å»è§£æç½‘é¡µæ•°æ®åˆ†æå‡ºæ–‡æœ¬ï¼ŒåŸºæœ¬ä¸Šæ‰‹æœºæµè§ˆå™¨çš„å®ç°éƒ½å’Œ Safari ç±»ä¼¼ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯æŠ“å–ç½‘é¡µå¯¹åº”çš„ RSS æºï¼Œè§£æ RSS æºä¸­çš„æ•°æ®æ ¼å¼ï¼Œå–å‡ºéœ€è¦çš„æ–‡æœ¬æ¥æ˜¾ç¤ºã€‚æ¥ä¸‹æ¥æˆ‘è¦å±•å¼€è®²çš„å°±æ˜¯å’Œ Safari ç±»ä¼¼çš„é˜…è¯»æ¨¡å¼çš„å®ç°ï¼Œä¸”æ˜¯åŸºäº WKWebView æ¥å®ç°çš„ã€‚</p>
<p>è¯¦ç»†çš„é¡¹ç›®ä»£ç åœ¨è¿™ï¼š <a href="https://github.com/PerfectFreeze/PFWebViewController" target="_blank" rel="external">PFWebViewController</a></p>
<h3 id="u4E86_u89E3_Safari__u9605_u8BFB_u6A21_u5F0F_u7684_u5B9E_u73B0"><a href="#u4E86_u89E3_Safari__u9605_u8BFB_u6A21_u5F0F_u7684_u5B9E_u73B0" class="headerlink" title="äº†è§£ Safari é˜…è¯»æ¨¡å¼çš„å®ç°"></a>äº†è§£ Safari é˜…è¯»æ¨¡å¼çš„å®ç°</h3><p>å…³äºå®ç°ï¼Œä½ å¯ä»¥å…ˆå‚è€ƒä¸‹é¢è¿™ä¸¤ç¯‡åšå®¢ï¼š</p>
<ul>
<li><a href="http://blog.csdn.net/horkychen/article/details/50959785" target="_blank" rel="external">iOS Safarié˜…è¯»æ¨¡å¼åˆ†æè¿‡ç¨‹</a> </li>
<li><a href="http://blog.csdn.net/horkychen/article/details/50959771" target="_blank" rel="external">iOS Safarié˜…è¯»æ¨¡å¼ç ”ç©¶</a></li>
</ul>
<blockquote>
<p>ä¸€å®šè¦å†™è¿™ç¯‡åšå®¢çš„åŸå› å°±æ˜¯ï¼Œæˆ‘èƒ½æŸ¥åˆ°ä¸æ­¤ç›¸å…³çš„ä¸­æ–‡åšå®¢æœ‰ä¸”ä»…æœ‰è¿™ä¸¤ç¯‡ï¼Œæˆ‘æ¥ä¸‹æ¥è®²çš„ä¼šæ›´é€šä¿—æ˜“æ‡‚ä¸€äº›ï¼Œæ¯•ç«Ÿæœ€åæ¨¡ä»¿ç³»ç»Ÿå®ç°å‡ºæ¥äº†ã€‚ä¸Šé¢ä¸¤ç¯‡çš„ä½œè€…æœ€åçš„ç»“è®ºå’Œä»£ç å¹¶ä¸èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯æä¾›çš„ä¿¡æ¯å’Œèµ„æºå¤šå¤šå°‘å°‘ç»™äº†æˆ‘å¾ˆå¤šå‚è€ƒã€‚</p>
<p>å…¶ä¸­ï¼Œç¬¬äºŒç¯‡ä¸­æåˆ°çš„ JavaScriptCoreï¼Œç”±äº WKWebView <a href="http://stackoverflow.com/questions/25792131/how-to-get-jscontext-from-wkwebview" target="_blank" rel="external">ä¸å†æ”¯æŒ</a>ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ° WebKit æ”¯æŒçš„å‘é€æ¶ˆæ¯çš„ä¼ é€’ä¿¡æ¯æ¨¡å¼ã€‚æ ¸å¿ƒè¦ç”¨åˆ°çš„ JavaScript æ–‡ä»¶åœ¨è¿™ä¸¤ç¯‡åšå®¢ä¸­ä¹Ÿæœ‰ç»™å‡ºã€‚</p>
</blockquote>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸¤ä¸ª WKWebView æ¥å®ç°æ•´ä¸ªæµç¨‹ï¼Œä¸€ä¸ªæ˜¯ä¸»è¦çš„æµè§ˆçª—å£ ( æš‚ä¸”å‘½åä¸º ) <strong>MainWebView</strong>ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ç”¨äºé˜…è¯»æ¨¡å¼é¡µé¢æ˜¾ç¤ºçš„ <strong>ReaderWebView</strong> ã€‚å‚ä¸æ•´ä¸ªé˜…è¯»æ¨¡å¼æ¸²æŸ“æµç¨‹çš„æ–‡ä»¶å¤§è‡´æœ‰è¿™äº›ï¼š</p>
<ul>
<li>index.html</li>
<li>safari-reader.js # è¿™ä¸ª js è´Ÿè´£çš„æ˜¯å†…å®¹çš„æ ¼å¼åŒ–å’Œæ¸²æŸ“ï¼ŒæŒ‚è½½åœ¨ <strong>ReaderWebView</strong> ä¸Š</li>
<li>safari-reader-check.js # è¿™ä¸ª js è´Ÿè´£çš„æ˜¯å†…å®¹çš„åˆ¤æ–­å’Œæå–ï¼ŒæŒ‚è½½åœ¨ <strong>MainWebView</strong>  ä¸Šï¼Œï¼ˆåœ¨æœ€æ–°çš„ Safari ä¸­æˆ‘ä¸€ç›´æ²¡æœ‰æˆªåˆ°è¿™ä¸ªè„šæœ¬ï¼Œä»æœ€åå®ç°çš„æ•ˆæœæ¥çœ‹ï¼Œè‹¹æœå¯èƒ½å°†è¿™éƒ¨åˆ†æ”¾è¿›åŸç”Ÿå®ç°äº†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±åªèƒ½ä½¿ç”¨è¿™ä¸ªæ¯”è¾ƒæ—©æœŸç‰ˆæœ¬çš„ js å®ç°çš„å†…å®¹åˆ¤æ–­ï¼Œä¼šå‡ºç°ä¸€äº›ç½‘é¡µæœ€æ–°ç‰ˆ Safari ä¼šå‡ºç°é˜…è¯»æ¨¡å¼çš„æŒ‰é’®è€Œä½ ä½¿ç”¨å®ƒå´åˆ¤æ–­æ— æ³•è¿›å…¥é˜…è¯»æ¨¡å¼ï¼‰</li>
<li>ReaderContext.h # è¿™å°±æ˜¯åŸç”Ÿå®ç°çš„ C++ ä»£ç å¤´æ–‡ä»¶ï¼Œåº”è¯¥æ˜¯ä½œä¸ºä¸Šé¢ä¸¤ä¸ª js ä¹‹é—´çš„åŸç”Ÿ Bridgeï¼Œç”¨æŒ‡é’ˆæ’å…¥çš„æ–¹æ³•ç”¨ C++ å‘ js ä¸­æ’å…¥å¯ä»¥ç›´æ¥è°ƒç”¨çš„åŸç”Ÿç±»å’Œæ–¹æ³•</li>
</ul>
<p>Safari çš„åŸºæœ¬æµç¨‹å°±æ˜¯ï¼Œå½“ <strong>MainWebView</strong> ä¸Šçš„ç½‘é¡µçš„ HTML åŠ è½½å®Œæˆåï¼Œæ‰§è¡Œ safari-reader-check (å½“ç„¶åæ¥å¯èƒ½æ‰§è¡ŒåŸç”Ÿä»£ç å»åˆ¤æ–­äº†ï¼Œæˆ–è€…ä½¿ç”¨äº†æ›´æ–°çš„ js æ–‡ä»¶) ä¸­çš„ FinderJS çš„å‡½æ•°æ¥åˆ¤æ–­å½“å‰ç½‘é¡µæ˜¯å¦å­˜åœ¨åˆé€‚çš„ Node æ¥ä½œä¸º Articleï¼Œåˆ¤æ–­çš„è§„åˆ™å¤§è‡´å°±æ˜¯æ ¹æ® H æ ‡ç­¾çš„ä¸ªæ•°ï¼Œæ–‡æœ¬çš„é•¿åº¦ä¹‹ç±»çš„å‚æ•°è®¡ç®—å‡ºæƒé‡ï¼Œæœ€åè·å¾—ä¸€ä¸ªæƒé‡æœ€é«˜çš„ Node ä½œä¸º Article å¯¹è±¡ã€‚å¦‚æœå­˜åœ¨è¿™ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šå‘ŠçŸ¥æµè§ˆå™¨æ˜¾ç¤ºé˜…è¯»æ¨¡å¼çš„æŒ‰é’®ï¼Œåä¹‹æµè§ˆå™¨åˆ™ä¸ä¼šæ˜¾ç¤ºè¿™ä¸ªæŒ‰é’®ã€‚</p>
<p>å½“ç”¨æˆ·ç‚¹å‡»äº†è¿™ä¸ªæŒ‰é’®ä¹‹åï¼ŒArticle å¯¹è±¡ä¼šè¢«æå–å‡ºæ¥ï¼Œé€šè¿‡ ReaderContext ä¼ é€’ç»™ safari-reader.js å¤„ç†ï¼Œç„¶å<strong>åŠ è½½åˆ° ReaderWebView é‡Œé¢</strong>ã€‚åœ¨ <strong>ReaderWebView</strong> ä¸­æ¸²æŸ“çš„ HTML æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ï¼Œé˜…è¯»æ¨¡å¼ä¸­ç”¨åˆ°çš„æ‰€æœ‰ CSS æ ·å¼éƒ½ä¼šåœ¨è¿™ä¸ª HTML é‡Œé¢é¢„å…ˆå®šä¹‰å¥½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Safari çš„æ§åˆ¶å°å–åˆ°è¿™ä¸ª HTML æ–‡ä»¶ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/10/13/57ff3ba696edb.png" alt=""></p>
<p>åœ¨ macOS çš„ Safari ä¸­å°±å¯ä»¥å–åˆ°ï¼ŒSafari ä¸­åœ¨ä»»æ„æœ‰é˜…è¯»æ¨¡å¼é€‰é¡¹çš„é¡µé¢ä¸‹ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œç„¶åè¿›å…¥é¡µé¢çš„æ£€æŸ¥æ¨¡å¼ï¼Œä½ ä¼šçœ‹åˆ° HTML ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/10/13/57ff3c766c7a9.png" alt=""></p>
<p>å½“ body åŠ è½½çš„æ—¶å€™ï¼Œå®ƒä¼šè°ƒç”¨ <code>ReaderJS.loaded()</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è´Ÿè´£å¤„ç† ReaderContext ä¼ é€’è¿‡æ¥çš„ Article å¯¹è±¡å¹¶å°†ç”Ÿæˆçš„ <code>&lt;div class=&quot;page&quot;&gt;</code> è¿™ä¸ªæ ‡ç­¾æ·»åŠ åˆ° id ä¸º article çš„æ ‡ç­¾ä¸‹é¢ã€‚ ç”¨åˆ°çš„ä¸¤ä¸ª js æ–‡ä»¶éƒ½æ˜¯åŒ¿åè„šæœ¬ï¼Œå…¶ä¸­ä¸»è¦çš„ safari_reader.js è„šæœ¬å¯ä»¥é€šè¿‡ç‚¹å‡»ç©ºç™½åŒºåŸŸæ·»åŠ æ–­ç‚¹æ¥æˆªè·çš„ï¼ˆå› ä¸ºä»–å®ç°äº†ä¸€ä¸ªç›‘å¬é¼ æ ‡ç‚¹å‡»çš„äº‹ä»¶ï¼‰ã€‚</p>
<h3 id="u6211_u7684_u5B9E_u73B0"><a href="#u6211_u7684_u5B9E_u73B0" class="headerlink" title="æˆ‘çš„å®ç°"></a>æˆ‘çš„å®ç°</h3><p>é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸¤ä¸ª webViewï¼Œå¹¶åœ¨ <strong>MainWebView</strong> ä¸ŠåŠ è½½åŸç½‘é¡µï¼Œè®°å¾—ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">_webView.navigationDelegate = self<span class="comment">;</span></span><br><span class="line">_readerWebView.navigationDelegate = self<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä¸¤ä¸ª <strong>MainWebView</strong> æŒ‚è½½ safari-reader-check.js çš„è„šæœ¬ï¼Œéœ€è¦ä¸º <strong>ReaderWebView</strong>  åŒæ—¶æŒ‚è½½ safari-reader-check.js å’Œ safari-reader.js è¿™ä¸¤ä¸ªè„šæœ¬ï¼Œåˆå§‹åŒ–çš„æ—¶å€™èµ‹ç»™ä¸¤ä¸ª webview çš„ <code>WKWebViewConfiguration</code> æŒ‰ç…§å¦‚ä¸‹æ¥å®šä¹‰ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="built_in">WKWebViewConfiguration</span> *)configuration &#123;</span><br><span class="line">    <span class="comment">// Load reader mode js script</span></span><br><span class="line">    <span class="built_in">NSBundle</span> *bundle = [<span class="built_in">NSBundle</span> bundleForClass:[<span class="keyword">self</span> <span class="keyword">class</span>]];</span><br><span class="line">    <span class="built_in">NSURL</span> *url = [bundle URLForResource:<span class="string">@"PFWebViewController"</span> withExtension:<span class="string">@"bundle"</span>];</span><br><span class="line">    <span class="built_in">NSBundle</span> *scriptBundle = [<span class="built_in">NSBundle</span> bundleWithURL:url];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *readerScriptFilePath = [scriptBundle pathForResource:<span class="string">@"safari-reader"</span> ofType:<span class="string">@"js"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *readerCheckScriptFilePath = [scriptBundle pathForResource:<span class="string">@"safari-reader-check"</span> ofType:<span class="string">@"js"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *indexPageFilePath = [scriptBundle pathForResource:<span class="string">@"index"</span> ofType:<span class="string">@"html"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Load HTML for reader mode</span></span><br><span class="line">    readerHTMLString = [[<span class="built_in">NSString</span> alloc] initWithContentsOfFile:indexPageFilePath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *script = [[<span class="built_in">NSString</span> alloc] initWithContentsOfFile:readerScriptFilePath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">WKUserScript</span> *userScript = [[<span class="built_in">WKUserScript</span> alloc] initWithSource:script injectionTime:<span class="built_in">WKUserScriptInjectionTimeAtDocumentEnd</span> forMainFrameOnly:<span class="literal">NO</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *check_script = [[<span class="built_in">NSString</span> alloc] initWithContentsOfFile:readerCheckScriptFilePath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">WKUserScript</span> *check_userScript = [[<span class="built_in">WKUserScript</span> alloc] initWithSource:check_script injectionTime:<span class="built_in">WKUserScriptInjectionTimeAtDocumentEnd</span> forMainFrameOnly:<span class="literal">NO</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">WKUserContentController</span> *userContentController = [[<span class="built_in">WKUserContentController</span> alloc] init];</span><br><span class="line">    [userContentController addUserScript:userScript];</span><br><span class="line">    [userContentController addUserScript:check_userScript];</span><br><span class="line">    [userContentController addScriptMessageHandler:<span class="keyword">self</span> name:<span class="string">@"JSController"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">WKWebViewConfiguration</span> *configuration = [[<span class="built_in">WKWebViewConfiguration</span> alloc] init];</span><br><span class="line">    configuration.userContentController = userContentController;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> configuration;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ <code>decidePolicyForNavigationResponse</code> è¿™ä¸ªå›è°ƒä¸­è¿›è¡Œé˜…è¯»æ¨¡å¼çš„åˆ¤æ–­ï¼Œè¿™ä¸ªå›è°ƒå‘ç”Ÿçš„æ—¶æœºæ˜¯åœ¨è·å¾— HTML å“åº”ä½†å°šæœªæ ¹æ® HTML å»åŠ è½½çš„æ—¶å€™ï¼Œæ‰€ä»¥æ˜¯åˆ¤æ–­é˜…è¯»æ¨¡å¼çš„æœ€ä½³æ—¶æœºï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationResponse:(<span class="built_in">WKNavigationResponse</span> *)navigationResponse decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationResponsePolicy</span>))decisionHandler &#123;</span><br><span class="line">    <span class="keyword">if</span> ([webView isEqual:<span class="keyword">self</span>.readerWebView]) &#123;</span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationResponsePolicyAllow</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Set reader mode button status when navigation finished</span></span><br><span class="line">    [_webView evaluateJavaScript:<span class="string">@"var ReaderArticleFinderJS = new ReaderArticleFinder(document);"</span> completionHandler:^(<span class="keyword">id</span> _Nullable object, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    [_webView evaluateJavaScript:<span class="string">@"ReaderArticleFinderJS.isReaderModeAvailable();"</span> completionHandler:^(<span class="keyword">id</span> _Nullable object, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([object integerValue] == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.toolbar.readerModeBtn.enabled = <span class="literal">YES</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.toolbar.readerModeBtn.enabled = <span class="literal">NO</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationResponsePolicyAllow</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://ooo.0o0.ooo/2016/10/21/5809b436031ce.jpeg" width="40%"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç‚¹å‡»é˜…è¯»æ¨¡å¼æŒ‰é’®çš„å“åº”äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ C++ æ­æ¡¥æ¢çš„æ–¹å¼ä¼ é€’å¯¹è±¡æŒ‡é’ˆï¼Œè€Œç›´æ¥ç”¨äº†ä¸€ç§æ›´ tricky çš„åŠæ³•ï¼Œå°†æå–å‡ºæ¥çš„ Article å¯¹è±¡ä»¥ä¸å¯è§çš„å½¢å¼æ·»åŠ åˆ°ç›®æ ‡çš„ <strong>ReaderWebView</strong> ä¸­ï¼Œç„¶åä¿®æ”¹è·å–åˆ°çš„ js æ–‡ä»¶ï¼Œè®© safari-reader.js åœ¨æ¸²æŸ“å®Œæ­£æ–‡å†…å®¹åå°†ä¸´æ—¶çš„è¿™ä¸ªä¸å¯è§çš„èŠ‚ç‚¹åˆ é™¤ã€‚</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line">[<span class="name">_webView</span> evaluateJavaScript:@<span class="string">"var ReaderArticleFinderJS = new ReaderArticleFinder(document);"</span> completionHandler:^(<span class="name">id</span> _Nullable object, NSError * _Nullable error) &#123;</span><br><span class="line">        &#125;]<span class="comment">;</span></span><br><span class="line">[<span class="name">_webView</span> evaluateJavaScript:@<span class="string">"var article = ReaderArticleFinderJS.findArticle();"</span> completionHandler:^(<span class="name">id</span> _Nullable object, NSError * _Nullable error) &#123;</span><br><span class="line">        &#125;]<span class="comment">;</span></span><br><span class="line">[<span class="name">_webView</span> evaluateJavaScript:@<span class="string">"article.element.outerHTML"</span> completionHandler:^(<span class="name">id</span> _Nullable object, NSError * _Nullable error) &#123;</span><br><span class="line">	if ([<span class="name">object</span> isKindOfClass:[<span class="name">NSString</span> class]] &amp;&amp; isReaderMode) &#123;</span><br><span class="line">		[<span class="name">_webView</span> evaluateJavaScript:@<span class="string">"ReaderArticleFinderJS.articleTitle()"</span> completionHandler:^(<span class="name">id</span> _Nullable object_in, NSError * _Nullable error) &#123;</span><br><span class="line">                    readerArticleTitle = object_in<span class="comment">;</span></span><br><span class="line">                    </span><br><span class="line">                    NSMutableString *mut_str = [<span class="name">readerHTMLString</span> mutableCopy]<span class="comment">;</span></span><br><span class="line">                    </span><br><span class="line">                    // Replace page title with article title</span><br><span class="line">                    [<span class="name">mut_str</span> replaceOccurrencesOfString:@<span class="string">"Reader"</span> withString:readerArticleTitle options:NSLiteralSearch range:NSMakeRange(<span class="name">0</span>, <span class="number">300</span>)]<span class="comment">;</span></span><br><span class="line">                    NSRange t = [<span class="name">mut_str</span> rangeOfString:@<span class="string">"&lt;div id=\"article\" role=\"article\"&gt;"</span>]<span class="comment">;</span></span><br><span class="line">                    NSInteger location = t.location + t.length<span class="comment">;</span></span><br><span class="line">                    </span><br><span class="line">                    NSString *t_object = [<span class="name">NSString</span> stringWithFormat:@<span class="string">"&lt;div style=\"position: absolute; top: -999em\"&gt;%@&lt;/div&gt;"</span>,object]<span class="comment">;</span></span><br><span class="line">                    [<span class="name">mut_str</span> insertString:t_object atIndex:location]<span class="comment">;</span></span><br><span class="line">                    </span><br><span class="line">                    [<span class="name">_readerWebView</span> loadHTMLString:mut_str baseURL:self.url]<span class="comment">;</span></span><br><span class="line">                    _readerWebView.alpha = <span class="number">0.0</span>f<span class="comment">;</span></span><br><span class="line">                &#125;]<span class="comment">;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]<span class="comment">;</span></span><br><span class="line">		[<span class="name">_webView</span> evaluateJavaScript:@<span class="string">"ReaderArticleFinderJS.prepareToTransitionToReader();"</span> completionHandler:^(<span class="name">id</span> _Nullable object, NSError * _Nullable error) &#123;</span><br><span class="line">     	&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œé‡‡ç”¨çš„ä½¿ div ä¸å¯è§çš„æ–¹å¼æ¯”è¾ƒç‰¹åˆ«ï¼Œå› ä¸º visibilty æˆ–è€… display æˆ–è€… height è¿™äº›å‚æ•°éƒ½ä¼šè¢« js æ’é™¤åœ¨è®¡ç®—çš„èŠ‚ç‚¹ä¹‹å¤–ï¼Œæ‰€ä»¥ç”¨ <strong>top: -999em</strong> çš„å†™æ³•ã€‚</p>
</blockquote>
<p><strong>ReaderWebView</strong> åœ¨ load ä¹‹åå°±ä¼šè°ƒç”¨æŒ‚è½½åœ¨ä¸Šé¢çš„ safari-reader.js ä¸­çš„ loaded æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">loaded: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!ReaderArticleFinderJS || <span class="keyword">this</span>._shouldSkipActivationWhenPageLoads())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.loadArticle(), ReaderAppearanceJS.initialize(), ReadingPositionStabilizerJS.initialize(), <span class="keyword">this</span>._shouldRestoreScrollPositionFromOriginalPageAtActivation) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (e &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">document</span>.body.scrollTop = e;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="built_in">document</span>.getElementById(<span class="string">"safari-reader-element-marker"</span>);</span><br><span class="line">            <span class="keyword">if</span> (t) &#123;</span><br><span class="line">                <span class="keyword">var</span> n = <span class="built_in">parseFloat</span>(t.style.top) / <span class="number">100</span>,</span><br><span class="line">                i = t.parentElement,</span><br><span class="line">                a = i.getBoundingClientRect();</span><br><span class="line">                <span class="built_in">document</span>.body.scrollTop = <span class="built_in">window</span>.scrollY + a.top + a.height * n, i.removeChild(t)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>._clickingOutsideOfPaperRectangleDismissesReader &amp;&amp; (<span class="built_in">document</span>.documentElement.addEventListener(<span class="string">"mousedown"</span>, monitorMouseDownForPotentialDeactivation), <span class="built_in">document</span>.documentElement.addEventListener(<span class="string">"click"</span>, deactivateIfEventIsOutsideOfPaperContainer));</span><br><span class="line">    <span class="keyword">var</span> o = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setUserVisibleWidth(<span class="keyword">this</span>.lastKnownUserVisibleWidth)</span><br><span class="line">    &#125;.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">"resize"</span>, o, !<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> article_node = <span class="built_in">document</span>.getElementById(<span class="string">"article"</span>);</span><br><span class="line">    article_node.firstChild.remove();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> message = &#123; <span class="string">'code'</span> : <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="built_in">window</span>.webkit.messageHandlers.JSController.postMessage(message);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>æœ€åå‡ è¡Œå…ˆæ˜¯ç§»é™¤äº† article è¿™ä¸ªèŠ‚ç‚¹ä¹‹ä¸‹çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ·»åŠ ä¸Šå»çš„ä¸å¯è§çš„ä¸´æ—¶èŠ‚ç‚¹ã€‚ç„¶åé€šè¿‡ <code>WKWebView</code> æ–°çš„ js äº¤äº’æ–¹å¼å‘é€æ¶ˆæ¯ï¼Œå‘åŸç”Ÿçš„ Controller å‘é€ä¸€ä¸ªåŠ è½½å®Œæˆçš„ä¿¡å·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸç”Ÿçš„ Controller é‡Œé¢è·å–è¿™ä¸ªä¿¡æ¯ï¼Œç„¶åéšå³å¼€å§‹é˜…è¯»æ¨¡å¼é¡µé¢åˆ‡æ¢çš„åŠ¨ç”»ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (<span class="selector-tag">void</span>)<span class="selector-tag">userContentController</span><span class="selector-pseudo">:(WKUserContentController</span> *)<span class="selector-tag">userContentController</span></span><br><span class="line">      <span class="selector-tag">didReceiveScriptMessage</span><span class="selector-pseudo">:(WKScriptMessage</span> *)<span class="selector-tag">message</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é™¤äº† loaded æ–¹æ³•ï¼Œsafari-reader.js è¿˜æœ‰è®¸å¤šä»£ç éœ€è¦ä¿®æ”¹ï¼Œæœ€ç»ˆå¯ç”¨çš„ç‰ˆæœ¬è¯·å‚è€ƒé¡¹ç›®ä»“åº“ä¸­çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<p><img src="https://ooo.0o0.ooo/2016/10/21/5809b43604002.jpeg" width="40%"></p>
<h3 id="u4E00_u4E2A_u591A_u4F59_u7684_u95EE_u9898_u8BB0_u5F55_-__u300C_u5728_u5FAE_u4FE1_u4E2D_u6253_u5F00_u300D_u6309_u94AE_u70B9_u51FB_u5931_u6548"><a href="#u4E00_u4E2A_u591A_u4F59_u7684_u95EE_u9898_u8BB0_u5F55_-__u300C_u5728_u5FAE_u4FE1_u4E2D_u6253_u5F00_u300D_u6309_u94AE_u70B9_u51FB_u5931_u6548" class="headerlink" title="ä¸€ä¸ªå¤šä½™çš„é—®é¢˜è®°å½• - ã€Œåœ¨å¾®ä¿¡ä¸­æ‰“å¼€ã€æŒ‰é’®ç‚¹å‡»å¤±æ•ˆ"></a>ä¸€ä¸ªå¤šä½™çš„é—®é¢˜è®°å½• - ã€Œåœ¨å¾®ä¿¡ä¸­æ‰“å¼€ã€æŒ‰é’®ç‚¹å‡»å¤±æ•ˆ</h3><p>åœ¨ <code>WKWebView</code> ä¸­ï¼Œæ¯”å¦‚å¾®ä¿¡ç½‘é¡µæœ‰ä¸€ä¸ª ã€Œåœ¨å¾®ä¿¡ä¸­æ‰“å¼€ã€çš„æŒ‰é’®ä¼šå¤±æ•ˆã€‚è¿™æ˜¯å› ä¸ºå¾®ä¿¡ç½‘é¡µçš„ HTML å†™æ³•æ˜¯ç›´æ¥åœ¨ a æ ‡ç­¾çš„ href é‡Œé¢å†™ä¸Šäº† <code>weixin://</code> è¿™æ ·å¼€å¤´çš„é“¾æ¥ï¼Œå¯¹äº <code>WKWebView</code> æ¥è¯´ä¼šä½œä¸ºä¸€ä¸ªæ™®é€šçš„ URL æ‰“å¼€ï¼Œä»è€Œæ— å“åº”ï¼Œä¸ä¼šæœ‰å¼¹æ¡†ã€‚</p>
<p><strong>è§£å†³åŠæ³•</strong>å°±æ˜¯æ‹¦æˆªé Http:// å’Œ Https:// å¼€å¤´çš„è¯·æ±‚ï¼Œè½¬æˆåº”ç”¨å†…è·³è½¬ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationAction:(<span class="built_in">WKNavigationAction</span> *)navigationAction decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationActionPolicy</span>))decisionHandler &#123;</span><br><span class="line">    <span class="keyword">if</span> (![navigationAction.request.URL.absoluteString containsString:<span class="string">@"http://"</span>] &amp;&amp; ![navigationAction.request.URL.absoluteString containsString:<span class="string">@"https://"</span>]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">UIApplication</span> *application = [<span class="built_in">UIApplication</span> sharedApplication];</span><br><span class="line"><span class="meta">#if __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= 100000</span></span><br><span class="line">        <span class="keyword">if</span> ([application respondsToSelector:<span class="keyword">@selector</span>(openURL:options:completionHandler:)]) 		&#123;</span><br><span class="line">            [application openURL:navigationAction.request.URL options:@&#123;&#125; completionHandler:<span class="literal">nil</span>];</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            [application openURL:navigationAction.request.URL];</span><br><span class="line">         &#125;</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">        [application openURL:navigationAction.request.URL];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationActionPolicyCancel</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PS"><a href="#PS" class="headerlink" title="PS."></a>PS.</h3><p>æœ€åè¯´ä¸€å¥ï¼Œå½“ç„¶ï¼Œæ¯•ç«Ÿè¿™æ ·æŠ“å–è‹¹æœçš„è„šæœ¬æ¥åšå’Œç³»ç»Ÿä¸€æ ·çš„æ•ˆæœæ˜¯å¾ˆ tricky çš„åŠæ³•ï¼Œä½†æ˜¯ï¼š</p>
<ul>
<li><p>å®¡æ ¸æ˜¯èƒ½è¿‡çš„ï¼Œä½†æ˜¯ä¸ä¿è¯èƒ½ä¸èƒ½ä¸€å®šè¿‡</p>
</li>
<li><p>æœ‰ä¸€äº›ç½‘é¡µå¯èƒ½æœ€æ–°çš„ Safari æ”¯æŒé˜…è¯»æ¨¡å¼ï¼Œç„¶è€Œé€šè¿‡ä¸Šè¿°å®ç°çš„æµè§ˆå™¨å´æ²¡æ³•æ”¯æŒ</p>
</li>
<li>å¦‚æœé‡åˆ°äº† 2 çš„é—®é¢˜ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨è‹¹æœå®˜æ–¹å°è£…çš„æ›´å¥½çš„ SafariWebViewControllerï¼Œç»å¯¹åŸç”Ÿçš„æ•ˆæœï¼Œå½“ç„¶å°±æ˜¯è‡ªå®šä¹‰ç¨‹åº¦æ›´ä½äº†</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œé˜…è¯»æ¨¡å¼é€šå¸¸æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæœ‰äººè¯´è¿™æ˜¯è¯»å°è¯´ç¥å™¨ï¼Œæœ‰äº›äººåˆ™è®¤ä¸ºé˜…è¯»æ¨¡å¼å¯ä»¥æ”¹å–„æ–°é—»ç½‘ç«™çš„é˜…è¯»ä½“éªŒï¼Œè€Œæœ‰äº›å¹¿å‘Šå•†åˆ™å¯¹æ­¤æŠ—è®®ï¼Œè®¤ä¸ºé˜…è¯»æ¨¡å¼æŸå®³äº†å¹¿å‘Šä¸»åˆ©ç›Šã€‚å½“ç„¶ï¼Œ]]>
    </summary>
    
      <category term="Safari é˜…è¯»æ¨¡å¼" scheme="http://sergiochan.github.io/tags/Safari-%E9%98%85%E8%AF%BB%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="WKWebView" scheme="http://sergiochan.github.io/tags/WKWebView/"/>
    
      <category term="WebKit" scheme="http://sergiochan.github.io/tags/WebKit/"/>
    
      <category term="iOSèœé¸Ÿå¿ƒå¾—" scheme="http://sergiochan.github.io/categories/iOS%E8%8F%9C%E9%B8%9F%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[2016-09-05 åŸºç£å±±ä¼¯çˆµ]]></title>
    <link href="http://sergiochan.github.io/2016/09/05/2016-09-05-%E5%9F%BA%E7%9D%A3%E5%B1%B1%E4%BC%AF%E7%88%B5/"/>
    <id>http://sergiochan.github.io/2016/09/05/2016-09-05-åŸºç£å±±ä¼¯çˆµ/</id>
    <published>2016-09-05T07:11:17.000Z</published>
    <updated>2016-09-05T07:13:19.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©å»æ½˜å®¶å›­çš„æ—§ä¹¦å¸‚åœºæ·˜äº†ä¸€åœˆï¼Œå¸¦å›äº†ä¸€æœ¬è€æ—§çš„ã€ŠåŸºç£å±±ä¼¯çˆµã€‹ã€‚æ›¾ç»åœ¨æˆ‘é«˜ä¸‰é‚£æ®µæ—¶å…‰é‡Œæˆä¸ºæˆ‘æœ€çˆ±çš„ä½³ä½œä¹‹ä¸€ã€‚</p>
<blockquote>
<p>â€œè¦å¼€å‘æ·±è—åœ¨äººç±»æ™ºæ…§é‡Œçš„ç¥ç§˜å®è—ï¼Œå°±éœ€è¦é­é‡ä¸å¹¸ï¼›è¦æƒ³å¼•çˆ†ç‚¸è¯ï¼Œå°±éœ€è¦å‹åŠ›ã€‚â€   â€” ã€ŠåŸºç£å±±ä¼¯çˆµã€‹</p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©å»æ½˜å®¶å›­çš„æ—§ä¹¦å¸‚åœºæ·˜äº†ä¸€åœˆï¼Œå¸¦å›äº†ä¸€æœ¬è€æ—§çš„ã€ŠåŸºç£å±±ä¼¯çˆµã€‹ã€‚æ›¾ç»åœ¨æˆ‘é«˜ä¸‰é‚£æ®µæ—¶å…‰é‡Œæˆä¸ºæˆ‘æœ€çˆ±çš„ä½³ä½œä¹‹ä¸€ã€‚</p>
<blockquote>
<p>â€œè¦å¼€å‘æ·±è—åœ¨äººç±»æ™ºæ…§é‡Œ]]>
    </summary>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/tags/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[iOS Airplay ä¸­çš„ Airtunes Server æœåŠ¡åè®®å’Œæœºåˆ¶è¯¦è§£ä»¥åŠ Android Demo çš„å®ç°]]></title>
    <link href="http://sergiochan.github.io/2016/08/29/iOS-Airplay-%E4%B8%AD%E7%9A%84-Airtunes-Server-%E6%9C%8D%E5%8A%A1%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%E4%BB%A5%E5%8F%8A-Android-Demo-%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <id>http://sergiochan.github.io/2016/08/29/iOS-Airplay-ä¸­çš„-Airtunes-Server-æœåŠ¡åè®®å’Œæœºåˆ¶è¯¦è§£ä»¥åŠ-Android-Demo-çš„å®ç°/</id>
    <published>2016-08-29T02:03:22.000Z</published>
    <updated>2016-08-30T07:02:11.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨ Android è®¾å¤‡ä¸Šæ­å»ºä¸€ä¸ª Airplay Server å…¶å®æ˜¯ä¸€ä»¶å¾ˆæµ©å¤§çš„å·¥ç¨‹ï¼Œå› ä¸ºè¿™éœ€è¦é€†å‘è‹¹æœçš„ Airplay åè®®æµç¨‹å•Šæ ¼å¼å•Šä»€ä¹ˆçš„ï¼Œä¸‡å¹¸è¿™ä»¶äº‹æƒ…å·²ç»ç”±è®¸è®¸å¤šå¤šå›½å¤–çš„å¤§ç¥ä»¬å¸®æˆ‘ä»¬åšå¥½äº†ï¼Œå› æ­¤æˆ‘ä»¬åªè¦åŸºäºä»–ä»¬é€†å‘å‡ºæ¥çš„ Airplay åè®®æ¥æ­å»ºä¸€ä¸ªæœåŠ¡å°±å¯ä»¥äº†ã€‚è¯è™½å¦‚æ­¤ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­çš„å·¥ä½œé‡å’Œéœ€è¦æŒæ¡çš„çŸ¥è¯†ç‚¹è¿˜æ˜¯éå¸¸éå¸¸å¤šçš„ã€‚</p>
<p>åœ¨å±€åŸŸç½‘ä¸­å®ç°æµåª’ä½“ä¼ è¾“çš„ä¸»æµåè®®æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯è‹¹æœå°é—­çš„ Airplay åè®®ï¼Œä¸€ç§æ˜¯ DLNA ã€‚</p>
<blockquote>
<p><strong>D</strong>IGITAL <strong>L</strong>IVING <strong>N</strong>ETWORK <strong>A</strong>LLIANCE æ•°å­—ç”Ÿæ´»ç½‘ç»œè”ç›Ÿï¼Œæ˜¯ç´¢å°¼ã€è‹±ç‰¹å°”ã€å¾®è½¯ç­‰å‘èµ·çš„ä¸€å¥— PCã€ç§»åŠ¨è®¾å¤‡ã€æ¶ˆè´¹ç”µå™¨ä¹‹é—´äº’è”äº’é€šçš„åè®®ã€‚å®ƒä»¬çš„å®—æ—¨æ˜¯â€œéšæ—¶éšåœ°äº«å—éŸ³ä¹ã€ç…§ç‰‡å’Œè§†é¢‘â€ã€‚æ®è¯´è‹¹æœå½“æ—¶ä¹Ÿæ˜¯ DLNA è”ç›Ÿçš„æˆå‘˜ï¼Œè€Œåæ¥é€€å‡ºäº†å¹¶è‡ªç«‹é—¨æˆ·ã€‚</p>
</blockquote>
<p>å¯¹äº iOS ç³»ç»Ÿæ¥è¯´ï¼Œå¯¹ç”¨æˆ·æœ€å‹å¥½ä¸”ä½“éªŒæœ€å¥½çš„æ–¹å¼è‡ªç„¶è¿˜æ˜¯é€šè¿‡ Airplay åè®®äº†ï¼ˆå…¶å®æˆ‘æ˜¯ä¸å¤ªå–œæ¬¢åœ¨æ¯ä¸ªå•ç‹¬çš„è§†é¢‘æˆ–è€…éŸ³ä¹æ’­æ”¾å™¨é‡Œé¢å»æ‰¾åˆ° DLNA æˆ–è€… Airplay çš„æŒ‰é’®ç„¶ååˆ‡æ¢æ¨¡å¼ï¼Œç³»ç»Ÿçº§çš„æœåŠ¡ä½“éªŒè¿˜æ˜¯æ›´å¥½ä¸€äº›ï¼Œå› æ­¤æˆ‘æ›´å€¾å‘ä½¿ç”¨ Airplayï¼‰ã€‚å› æ­¤åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä½ éœ€è¦è®©ä½ çš„<strong>å®‰å“ç¡¬ä»¶</strong>æˆ–è€…<strong>è®¾å¤‡</strong>æ”¯æŒ Airplay æœåŠ¡ï¼Œæœ¬æ–‡å°±æ˜¯é€šè¿‡ä¸€æ­¥æ­¥è§£é‡Šå’Œåˆ†æè¿™ä¸ªåŸºäº DroidPlay æ”¹å‡ºçš„ç¨³å®šå¯ç”¨çš„ Airtunes æœåŠ¡ï¼Œç»™å¤§å®¶å±•ç¤ºä¸€ä¸ªæ¯”è¾ƒæ¸…æ™°çš„ Airplay ä¸­çš„ Airtunes çš„æœºåˆ¶å’ŒæœåŠ¡æµç¨‹ã€‚</p>
<blockquote>
<p>ä»£ç åœ¨ GitHub ä¸Šå¼€æ”¾ç»™å¤§å®¶å­¦ä¹ å’Œæ”¹åŠ¨ã€‚åœ°å€åœ¨<a href="https://github.com/SergioChan/Android-Airplay-Server" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<h2 id="u9996_u5148_uFF0C_u5982_u4F55_u8BA9_iOS__u8BBE_u5907_u53D1_u73B0_u4F60"><a href="#u9996_u5148_uFF0C_u5982_u4F55_u8BA9_iOS__u8BBE_u5907_u53D1_u73B0_u4F60" class="headerlink" title="é¦–å…ˆï¼Œå¦‚ä½•è®© iOS è®¾å¤‡å‘ç°ä½ "></a>é¦–å…ˆï¼Œå¦‚ä½•è®© iOS è®¾å¤‡å‘ç°ä½ </h2><p>è¿™æ˜¯ä¸‡äº‹å¼€å¤´çš„ç¬¬ä¸€æ­¥ï¼šä½ éœ€è¦è®©è‡ªå·±çš„å®‰å“è®¾å¤‡å‡ºç°åœ¨ iOS è®¾å¤‡ Airplay çš„è®¾å¤‡åˆ—è¡¨ä¸­ã€‚ç”±äº Airplay æ˜¯åŸºäºå±€åŸŸç½‘çš„ï¼Œè‹¹æœè®¾å¤‡ä¼šåœ¨å½“å‰å±€åŸŸç½‘é‡Œæœå¯»æ”¯æŒ Airplay æœåŠ¡çš„è®¾å¤‡ï¼Œå› æ­¤åœ¨è¿™é‡Œä½ å°±éœ€è¦é€šè¿‡ mDNS æœåŠ¡å‘å±€åŸŸç½‘å‘é€ä¸€ä¸ªç»„æ’­æ¥è®© iOS è®¾å¤‡èƒ½å¤Ÿåœ¨å†…ç½‘ä¸­å‘ç°ä½ ã€‚åœ¨ Android ä¸Šä½ å¯ä»¥ä½¿ç”¨ <strong>jmDNS</strong> åº“æ¥å®ç°è¿™ä¸ªåŠŸèƒ½:</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">final <span class="keyword">JmDNS </span><span class="keyword">jmDNS </span>= <span class="keyword">JmDNS.create(addr, </span>hostName + <span class="string">"-jmdns"</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">jmDNSInstances.add(jmDNS);</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line">/* Publish RAOP service */</span><br><span class="line">final ServiceInfo airTunesServiceInfo = ServiceInfo.create(</span><br><span class="line">AIR_TUNES_SERVICE_TYPE,</span><br><span class="line">hardwareAddressString + <span class="string">"@"</span> + hostName,</span><br><span class="line">getRtspPort(),</span><br><span class="line"><span class="number">0</span> <span class="comment">/* weight */</span>, <span class="number">0</span> <span class="comment">/* priority */</span>,</span><br><span class="line">AIRTUNES_SERVICE_PROPERTIES</span><br><span class="line">)<span class="comment">;</span></span><br><span class="line"><span class="keyword">jmDNS.registerService(airTunesServiceInfo);</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ³¨å†Œçš„æœåŠ¡ç±»å‹å’Œå‚æ•°éƒ½æ˜¯å›ºå®šçš„ï¼ŒæœåŠ¡ç±»å‹ä¸º <code>_raop._tcp.local.</code>ï¼Œå‚æ•°åˆ—è¡¨å¦‚ä¸‹:</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="string">"txtvers"</span>, <span class="string">"1"</span>,</span><br><span class="line"><span class="string">"tp"</span>, <span class="string">"UDP"</span>,</span><br><span class="line"><span class="string">"ch"</span>, <span class="string">"2"</span>,</span><br><span class="line"><span class="string">"ss"</span>, <span class="string">"16"</span>,</span><br><span class="line"><span class="string">"sr"</span>, <span class="string">"44100"</span>,</span><br><span class="line"><span class="string">"pw"</span>, <span class="string">"false"</span>,</span><br><span class="line"><span class="string">"sm"</span>, <span class="string">"false"</span>,</span><br><span class="line"><span class="string">"sv"</span>, <span class="string">"false"</span>,</span><br><span class="line"><span class="string">"ek"</span>, <span class="string">"1"</span>,</span><br><span class="line"><span class="string">"et"</span>, <span class="string">"0,1"</span>,</span><br><span class="line"><span class="string">"cn"</span>, <span class="string">"0,1"</span>,</span><br><span class="line"><span class="string">"vn"</span>, <span class="string">"3"</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ³¨å†Œä¸Šè¿™ä¸ª mDNS æœåŠ¡ï¼Œç°åœ¨ä½ åº”è¯¥å¯ä»¥åœ¨ä½ çš„ iOS è®¾å¤‡ä¸Šçš„ Airplay åˆ—è¡¨é‡Œçœ‹åˆ°ä¸€ä¸ªåå­—ä¸ºä½ è®¾ç½®çš„ <code>hostName</code> çš„è®¾å¤‡äº†ã€‚å½“ç„¶ï¼Œç°åœ¨ç‚¹å‡»è¿æ¥åº”è¯¥æ˜¯æ²¡æœ‰ä»»ä½•ååº”çš„ï¼Œå› ä¸ºæ¥ä¸‹æ¥éœ€è¦è¿›è¡Œå¥½å‡ æ¬¡çš„  RTSP è¯·æ±‚æ¥è¿›è¡Œæ ¡éªŒå’Œè¿æ¥ï¼Œæˆ‘ä»¬è¦åšçš„ä¹Ÿä¸»è¦å°±æ˜¯æ¥ä¸‹æ¥è¿™å‡ ä¸ªæ­¥éª¤äº†ã€‚</p>
<blockquote>
<p><strong>Airplay è¿æ¥ä¸€å¼€å§‹çš„å»¶è¿Ÿè²Œä¼¼æ˜¯æ²¡æœ‰åŠæ³•è§£å†³çš„</strong>ã€‚å‚è€ƒè¿™ç¯‡<a href="http://stackoverflow.com/questions/9997882/detecting-the-airplay-latency" target="_blank" rel="external">SOå›ç­”</a>ï¼Œé‡Œé¢æ˜ç¡®æŒ‡å‡ºï¼ŒAirplay è¿æ¥çš„å»¶è¿Ÿæ¥æºäºå‘é€æ–¹éœ€è¦å¤šæ¬¡ RTSP è¯·æ±‚æ¡æ‰‹ï¼Œå¤§æ¦‚åœ¨<strong>ä¸¤ç§’å·¦å³</strong>ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ åœ¨å®¢æˆ·ç«¯å±‚é¢å»åšè‡ªå·±çš„ä¼ è¾“åè®®å½“ç„¶æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ä½ å¹¶ä¸èƒ½æŒ‰ç…§ Airplay çš„åŒ…æ ¼å¼æ¥å®ç°ç³»ç»Ÿçº§çš„ Airplay åˆ°å…¶ä»–ä¸è®ºæ˜¯åŸç”Ÿçš„ iOS è®¾å¤‡è¿˜æ˜¯æ”¯æŒäº† Airplay çš„ Android è®¾å¤‡ä¸Šå»ï¼Œè¿™ä¼šè¢«è‹¹æœ Rejectã€‚æ‰€ä»¥å¦‚æœåœ¨ä¹‹åçš„å¼€å‘ä¸­æœ€åé‡åˆ°äº†ä¸€ç‚¹å‡ ç§’çš„å»¶è¿Ÿæ²¡æ³•è§£å†³çš„æ—¶å€™ï¼Œè®°ä½ä¸è¦é’»è¿›å‘é‡Œäº†ã€‚å®é™…æµ‹è¯•ä¸­å»¶è¿Ÿå¤§æ¦‚åœ¨ 1.6 ç§’å·¦å³ã€‚</p>
</blockquote>
<h2 id="u5F00_u542F_u4F60_u7684_u670D_u52A1_u7AEF"><a href="#u5F00_u542F_u4F60_u7684_u670D_u52A1_u7AEF" class="headerlink" title="å¼€å¯ä½ çš„æœåŠ¡ç«¯"></a>å¼€å¯ä½ çš„æœåŠ¡ç«¯</h2><p>å‘ŠçŸ¥äº† iOS è®¾å¤‡ä½ çš„ç«¯å£ä¿¡æ¯ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åœ¨æŒ‡å®šçš„ç«¯å£å¼€å¯ä½ çš„æœåŠ¡ç«¯ç­‰å€™ iOS è®¾å¤‡ä¼ æ¥çš„åŒ…äº†ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Netty åº“çš„ bootstrap æ¥æ­å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œå…³äº Netty ä½ å¯ä»¥åœ¨ç™¾åº¦å’Œè°·æ­Œä¸Šæ‰¾åˆ°æ›´å¤šä»‹ç»ã€‚æ€»ä¹‹å®ƒçš„æœºåˆ¶æ˜¯æ¯ä¸€ä¸ªæ–°çš„ TCP è¿æ¥éƒ½ä¼šå»ºç«‹ä¸€ä¸ªå­çš„ channel ç„¶åæ¯ä¸€ä¸ª channel çš„å¤„ç†éƒ½æ˜¯ä¸€ä¸ª pipeline çš„å¤„ç†æ¨¡å¼ï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™æ¶ˆæ¯ä¼šåœ¨ pipeline ä¸­æµåŠ¨ï¼Œç›´åˆ°ä¸å†å¾€ä¸‹æµåŠ¨ï¼Œå‘é€æ¶ˆæ¯åä¹‹äº¦ç„¶ã€‚</p>
<p>è‹¹æœçš„ Airplay åè®®ä¸»è¦æ˜¯é€šè¿‡ RTSP åè®®çš„ Header ä¸­çš„å‡ ä¸ªå‚æ•°æ¥è¿›è¡Œèº«ä»½çš„éªŒè¯å’ŒåŒ…çš„æ ¡éªŒï¼Œæ‰€ä»¥ä¸ºäº†æ»¡è¶³è‹¹æœè‡ªå·±éœ€è¦çš„æ ¡éªŒè§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ pipeline ä¸­åŠ ä¸Šè¿™å‡ ä¸ªå¤„ç†æ ¡éªŒçš„ Handlerï¼š</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">pipeline.addLast(<span class="string">"challengeResponse"</span>, <span class="keyword">new</span> <span class="type">RaopRtspChallengeResponseHandler</span>(NetworkUtils.getInstance().getHardwareAddress()));</span><br><span class="line">pipeline.addLast(<span class="string">"header"</span>, <span class="keyword">new</span> <span class="type">RaopRtspHeaderHandler</span>());</span><br><span class="line">pipeline.addLast(<span class="string">"options"</span>, <span class="keyword">new</span> <span class="type">RaopRtspOptionsHandler</span>());</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>ç”± iOS è®¾å¤‡å‘ Android è®¾å¤‡å‘é€çš„ Request çš„ Header ä¸­ ï¼ˆæ³¨æ„è¿™é‡Œä½ çš„ Android æ˜¯ä½œä¸ºæœåŠ¡ç«¯çš„ï¼‰åŒ…å«ä¸€ä¸ªå«åš <code>Apple-Challenge</code> çš„å­—æ®µï¼Œå®ƒçš„å€¼éœ€è¦ç»è¿‡ Base64 è§£å¯†ä¹‹åè·å¾—ä¸€ä¸ªå‡­è¯ï¼Œè¿™ä¸ªå‡­è¯æ˜¯è¦åœ¨æ¯ä¸€æ¬¡çš„ Response ä¸­ä½¿ç”¨åˆ°çš„ã€‚</li>
<li>ç”± Android è®¾å¤‡å‘ iOS è®¾å¤‡å‘é€çš„ Response çš„ Header ä¸­éœ€è¦åŒ…å«ä¸€ä¸ªå«åš <code>Apple-Response</code> çš„å­—æ®µï¼Œå®ƒçš„å€¼éœ€è¦ç»è¿‡ä¸€å±‚ RSA åŠ å¯†å’Œä¸€å±‚ Base64 åŠ å¯†ï¼ŒåŸå§‹æ•°æ®åˆ™æ˜¯ 16 ä½ <code>Apple-Challenge</code> è§£å¯†åçš„å‡­è¯ + 16ä½ InetAddress.getAddress() è·å–åˆ°çš„ byte æ•°ç»„ + 6 ä½ ç¡¬ä»¶åœ°å€ã€‚åˆ†åˆ«æ˜¯ä» Request ä¸­ï¼Œ<code>InetAddress.getAddress()</code> å’Œä¸‹é¢è¿™æ®µä»£ç ä¸­çš„ <code>NetworkInterface</code> æ¥è·å¾—ç¡¬ä»¶åœ°å€ã€‚å¸¦æœ‰ <code>Apple-Challenge</code> Header çš„åŒ…åªä¼šåœ¨ RTSP è¿æ¥å»ºç«‹çš„æ—¶å€™å‘é€ä¸€æ¬¡ï¼Œå› æ­¤ç¨å¾®åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦éœ€è¦è¿”å› <code>Apple-Response</code> çš„ Header å°±å¯ä»¥äº†ã€‚å¦å¤–ï¼Œåœ¨è¿™é‡Œçš„ RSA åŠ å¯†ä¸­ç”¨åˆ°çš„ç§˜é’¥æ˜¯ä¸€ä¸ªç§é’¥ï¼Œä¹Ÿå°±æ˜¯åŒæ–¹æå‰çº¦å®šå¥½çš„ä¸€ä¸ªä¸²ï¼Œè¿™ä¸ªä¸²ä¼šä¸å®šæœŸçš„æ›´æ–°ï¼Œç ´è§£çš„äº‹æƒ…åº”è¯¥åªæœ‰å°‘æ•°å¤§ç¥æ‰åšçš„äº†å§â€¦â€¦å¯¹äºæˆ‘ä»¬ä¸»è¦è¿˜æ˜¯ä»å›½å¤–çš„ä¸€äº›åšå®¢å’Œç½‘ç«™ä¸Šç»å¸¸å»å…³æ³¨æ˜¯å¦æœ‰ç§é’¥æ›´æ–°æ¯”è¾ƒé è°±ã€‚è¿™ä¸ªç§é’¥åœ¨æ‰€æœ‰çš„ RSA è§£å¯†æ“ä½œä¸­éƒ½è¦ç”¨åˆ°ã€‚</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">final</span> NetworkInterface iface: Collections.list(NetworkInterface.getNetworkInterfaces())) &#123;</span><br><span class="line"><span class="keyword">if</span> (iface.isLoopback())&#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (iface.isPointToPoint())&#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">final</span> byte[] ifaceMacAddress = iface.getHardwareAddress();</span><br><span class="line"><span class="keyword">if</span> ((ifaceMacAddress != <span class="literal">null</span>) &amp;&amp; (ifaceMacAddress.length == <span class="number">6</span>) &amp;&amp; !isBlockedHardwareAddress(ifaceMacAddress)) &#123;</span><br><span class="line"><span class="keyword">return</span> Arrays.copyOfRange(ifaceMacAddress, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (<span class="keyword">final</span> Throwable e) &#123;</span><br><span class="line"><span class="comment">/* Ignore */</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äº RTSP Header çš„å¤„ç†ï¼Œæ¯ä¸ª RTSP åŒ…éƒ½ä¼šå¸¦æœ‰ <code>CSeq</code> çš„å¤´ï¼Œè¿™ä¸ªå¤´éœ€è¦åœ¨ Response å’Œ Request ä¸­ä¿æŒä¸€è‡´ã€‚å®ƒæŒ‡å®šäº† RTSP è¯·æ±‚å›åº”å¯¹çš„åºåˆ—å·ï¼Œåœ¨æ¯ä¸ªè¯·æ±‚æˆ–å›åº”ä¸­éƒ½å¿…é¡»åŒ…æ‹¬è¿™ä¸ªå¤´å­—æ®µã€‚å¯¹æ¯ä¸ªåŒ…å«ä¸€ä¸ªç»™å®šåºåˆ—å·çš„è¯·æ±‚æ¶ˆæ¯ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åŒåºåˆ—å·çš„å›åº”æ¶ˆæ¯ã€‚</li>
<li>æ¯ä¸ª RTSP Header è¿˜è¦å¸¦ä¸Šä¸€ä¸ªå€¼ä¸º <code>connected; type=analog</code> çš„å¤´ <code>Audio-Jack-Status</code>ã€‚</li>
<li>ä½ è¿˜è¦å“åº” RTSP çš„ OPTION è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚æ˜¯ç”±å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·ï¼Œè¦æ±‚æœåŠ¡ç«¯å‘ŠçŸ¥æ”¯æŒçš„æ‰€æœ‰è¯·æ±‚ç±»å‹ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬éœ€è¦å°†æ‰€æœ‰çš„ RTSP è¯·æ±‚æ–¹æ³•å¸¦åœ¨ Response ä¸­è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
</ul>
<h2 id="u63A5_u6536_u5E76_u5904_u7406_u4F60_u7684_u6570_u636E_u6D41"><a href="#u63A5_u6536_u5E76_u5904_u7406_u4F60_u7684_u6570_u636E_u6D41" class="headerlink" title="æ¥æ”¶å¹¶å¤„ç†ä½ çš„æ•°æ®æµ"></a>æ¥æ”¶å¹¶å¤„ç†ä½ çš„æ•°æ®æµ</h2><p>å½“è¯·æ±‚ç»è¿‡äº†ä¸Šé¢å‡ å±‚ Handler è¿˜åœ¨å¾€ä¸‹ä¼ é€’çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®åŒ…åº”è¯¥å°±åˆ°äº† RTSP çš„æ­£å¸¸å¤„ç†æµç¨‹ä¸­äº†ã€‚è€Œè¿™äº›æ‰€æœ‰çš„å…³äº RTSP çš„å¤„ç†éƒ½æ˜¯åœ¨ <code>AudioHandler</code> ä¸­æ¥å®Œæˆçš„ã€‚æˆ‘ä»¬ä¼šæ”¶åˆ°ä¸‹é¢è¿™å‡ ç§è¯·æ±‚</p>
<ul>
<li>ANNOUNCE åˆå§‹åŒ–æ­¥éª¤ï¼Œä¼ è¾“åª’ä½“ä¿¡æ¯ï¼Œç¼–ç å’ŒåŠ å¯†ç§˜é’¥</li>
<li>SETUP è¿æ¥æ­¥éª¤</li>
<li>RECORD ä¸éœ€è¦åšä»€ä¹ˆï¼Œåœ¨è¿™é‡Œæ‰€æœ‰çš„å·¥ä½œéƒ½åœ¨å‰ä¸¤æ­¥é‡Œé¢å®Œæˆäº†</li>
<li>FLUSH å½“å®¢æˆ·ç«¯ç»ˆæ­¢äº† Airtunes ä¼ è¾“çš„æ—¶å€™å‘é€ï¼Œç”¨æ¥æ¸…ç©ºæ•°æ®é˜Ÿåˆ—</li>
<li>TEARDOWN ç›´æ¥å…³é—­è¿æ¥</li>
</ul>
<h3 id="ANNOUNCE"><a href="#ANNOUNCE" class="headerlink" title="ANNOUNCE"></a>ANNOUNCE</h3><p>ANNOUNCE ä¸­ä¸»è¦æ˜¯å¸¦æ¥äº†ä¸€äº› RTP æ•°æ®çš„å‚æ•°ï¼ŒAndroid å¯ä»¥æ ¹æ®è¿™äº›å‚æ•°æ¥åˆå§‹åŒ–ç›¸åº”çš„ <strong>RTP å¤„ç†é˜Ÿåˆ—</strong>ï¼Œ<strong>ALAC Decoder</strong> å’Œ <strong>AES è§£å¯†å¤„ç†å™¨</strong>ï¼ˆæ³¨æ„æ‰€æœ‰ä¹‹åçš„ RTP åŒ…éƒ½æ˜¯ AES åŠ å¯†è¿‡çš„ï¼Œéœ€è¦ç”¨è¿™é‡Œåˆå§‹åŒ–çš„è§£å¯†å¤„ç†å™¨è§£ä¸€éï¼Œä½†æ˜¯ RTSP åŒ…ä¸æ˜¯ ï¼‰ã€‚ANNOUNCE åœ¨ä¼ è¾“çš„æ—¶å€™éµå¾ª <strong>SDP æè¿°æ ¼å¼</strong>æ¥ä¼ è¾“åª’ä½“ä¿¡æ¯ï¼š</p>
<blockquote>
<p><strong>å…³äº SDP</strong></p>
<p>SDP æ˜¯ä¸€ç§ä¼šè¯æè¿°æ ¼å¼ï¼Œå®ƒä¸å±äºä¼ è¾“åè®®ã€‚</p>
<p>SDPåè®®æ˜¯åŸºäºæ–‡æœ¬çš„åè®®ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åè®®çš„å¯æ‰©å±•æ€§æ¯”è¾ƒå¼ºã€‚SDP ä¸æ”¯æŒä¼šè¯å†…å®¹æˆ–åª’ä½“ç¼–ç çš„åå•†ï¼Œæ‰€ä»¥åœ¨æµåª’ä½“ä¸­åªç”¨æ¥æè¿°åª’ä½“ä¿¡æ¯ã€‚</p>
<p>SDPæè¿°ç”±è®¸å¤šæ–‡æœ¬è¡Œç»„æˆï¼Œæ–‡æœ¬è¡Œçš„æ ¼å¼ä¸º:</p>
<p><strong>ç±»å‹ = å€¼</strong></p>
<p>å…¶ä¸­ï¼Œç±»å‹æ˜¯ä¸€ä¸ªå­—æ¯ï¼Œå€¼æ˜¯ç»“æ„åŒ–çš„æ–‡æœ¬ä¸²ï¼Œå…¶æ ¼å¼ä¾ç±»å‹è€Œå®šã€‚</p>
<p><strong>sdpçš„æ ¼å¼:</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> v=&lt;version&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> o=&lt;username&gt; &lt;session id&gt; &lt;version&gt; &lt;network <span class="built_in">type</span>&gt; &lt;address <span class="built_in">type</span>&gt; &lt;address&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> s=&lt;session name&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> i=&lt;session description&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> u=&lt;URI&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> e=&lt;email address&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> p=&lt;phone number&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> c=&lt;network <span class="built_in">type</span>&gt; &lt;address <span class="built_in">type</span>&gt; &lt;connection address&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> b=&lt;modifier&gt;:&lt;bandwidth-value&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> t=&lt;start time&gt; &lt;stop time&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> r=&lt;repeat interval&gt; &lt;active duration&gt; &lt;list of offsets from start-time&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> z=&lt;adjustment time&gt; &lt;offset&gt; &lt;adjustment time&gt; &lt;offset&gt; ....</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> k=&lt;method&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> k=&lt;method&gt;:&lt;encryption key&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> a=&lt;attribute&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> a=&lt;attribute&gt;:&lt;value&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> m=&lt;media&gt; &lt;port&gt; &lt;transport&gt; &lt;fmt list&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> v = (åè®®ç‰ˆæœ¬)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> o = (æ‰€æœ‰è€…/åˆ›å»ºè€…å’Œä¼šè¯æ ‡è¯†ç¬¦)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> s = (ä¼šè¯åç§°)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> i = * (ä¼šè¯ä¿¡æ¯)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> u = * (URI æè¿°)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> e = * (Email åœ°å€)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> p = * (ç”µè¯å·ç )</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> c = * (è¿æ¥ä¿¡æ¯)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> b = * (å¸¦å®½ä¿¡æ¯)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> z = * (æ—¶é—´åŒºåŸŸè°ƒæ•´)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> k = * (åŠ å¯†å¯†é’¥)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> a = * (0 ä¸ªæˆ–å¤šä¸ªä¼šè¯å±æ€§è¡Œ)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> æ—¶é—´æè¿°: </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> t = (ä¼šè¯æ´»åŠ¨æ—¶é—´)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> r = * (0æˆ–å¤šæ¬¡é‡å¤æ¬¡æ•°)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> åª’ä½“æè¿°: </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> m = (åª’ä½“åç§°å’Œä¼ è¾“åœ°å€)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> i = * (åª’ä½“æ ‡é¢˜)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> c = * (è¿æ¥ä¿¡æ¯ â€” å¦‚æœåŒ…å«åœ¨ä¼šè¯å±‚åˆ™è¯¥å­—æ®µå¯é€‰)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> b = * (å¸¦å®½ä¿¡æ¯)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> k = * (åŠ å¯†å¯†é’¥)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> a = * (0 ä¸ªæˆ–å¤šä¸ªåª’ä½“å±æ€§è¡Œ)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>Airplay æœåŠ¡æ‰€å®šä¹‰çš„ ANNOUNCE åŒ…çš„ SDP æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">* Sample sdp content:</span><br><span class="line">* </span><br><span class="line">v=0</span><br><span class="line">o=iTunes 3413821438 0 IN IP4 fe80::217:f2ff:fe0f:e0f6</span><br><span class="line">s=iTunes</span><br><span class="line">c=IN IP4 fe80::5a55:caff:fe1a:e187</span><br><span class="line">t=0 0</span><br><span class="line">m=audio 0 RTP/AVP 96</span><br><span class="line">a=rtpmap:96 AppleLossless</span><br><span class="line">a=fmtp:96 352 0 16 40 10 14 2 255 0 0 44100</span><br><span class="line">a=fpaeskey:RlBMWQECAQAAAAA8AAAAAPFOnNe+zWb5/n4L5KZkE2AAAAAQlDx69reTdwHF9LaNmhiRURTAbcL4brYAceAkZ49YirXm62N4</span><br><span class="line">a=aesiv:5b+YZi9Ikb845BmNhaVo+Q</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®æ ·ä¾‹æ ¼å¼æˆ‘ä»¬å¯ä»¥è§£æå‡º AES è§£å¯†çš„<strong>ç§˜é’¥</strong>å’Œ<strong>åˆå§‹åŒ–çŸ©é˜µIV</strong>ä»¥åŠæµçš„æ•°æ®æ ¼å¼ï¼Œä»è€Œåˆå§‹åŒ– <strong>ALAC Decoder</strong>ã€‚å…¶ä¸­ï¼Œå‚æ•° m çš„æœ€åä¸€ä¸ªå€¼å’Œ rtpmap çš„ç¬¬ä¸€ä¸ªå€¼éœ€è¦ä¿æŒä¸€è‡´ï¼Œrtpmap çš„ç¬¬ä¸€ä¸ªå€¼å’Œ fmtp çš„ç¬¬ä¸€ä¸ªå€¼éœ€è¦ä¿æŒä¸€è‡´ï¼Œä»–ä»¬éƒ½æ˜¯ <strong>payload type</strong> çš„å€¼ï¼Œå› æ­¤åœ¨è§£æå®ŒåŒ…çš„æ•°æ®ä¹‹åè¦è¿›è¡Œæ ¡éªŒã€‚fmtp ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹åçš„æ‰€æœ‰å‚æ•°è¡¨ç¤ºçš„éƒ½æ˜¯åª’ä½“æ ¼å¼çš„æŒ‡å®šå‚æ•°ã€‚æˆ‘ä»¬ç”¨è¿™äº›å‚æ•°æ¥åˆå§‹åŒ– ALAC Decoderã€‚<em>å…³äº SDP çš„è¯¦ç»†å‚æ•°æè¿°ä½ å¯ä»¥åœ¨è°·æ­Œä¸Šæ‰¾åˆ°æ›´å¤š</em>ã€‚</p>
<blockquote>
<p>a=fmtp:<format> <format specific="" parameters=""><br>â€‹       This attribute allows parameters that are specific to a particular format to be conveyed in a way that SDP doesnâ€™t have to understand them.  The format must be one of the formats specified for the media.  Format-specific parameters may be any set of parameters required to be conveyed by SDP and given unchanged to the media tool that will use this format.</format></format></p>
<p>â€‹       It is a media attribute, and is not dependent on charset.</p>
</blockquote>
<p>æ¥ä¸‹æ¥æ˜¯ AES è§£å¯†çš„ç§˜é’¥å’Œåˆå§‹åŒ–çŸ©é˜µ IVï¼š</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">"rsaaeskey"</span>.<span class="keyword">equals</span>(key)) &#123;</span><br><span class="line"><span class="comment">/* Sets the AES key required to decrypt the audio data. The key is</span></span><br><span class="line"><span class="comment">* encrypted wih the AirTunes private key</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">byte</span>[] aesKeyRaw;</span><br><span class="line"></span><br><span class="line">rsaPkCS1OaepCipher.init(Cipher.DECRYPT_MODE, AirTunesCryptography.PrivateKey);</span><br><span class="line">aesKeyRaw = rsaPkCS1OaepCipher.doFinal(Base64.decodeUnpadded(<span class="keyword">value</span>));</span><br><span class="line"></span><br><span class="line">aesKey = <span class="keyword">new</span> SecretKeySpec(aesKeyRaw, <span class="string">"AES"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"aesiv"</span>.<span class="keyword">equals</span>(key)) &#123;</span><br><span class="line"><span class="comment">/* Sets the AES initialization vector */</span></span><br><span class="line">aesIv = <span class="keyword">new</span> IvParameterSpec(Base64.decodeUnpadded(<span class="keyword">value</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯ç”¨ Base64 åŠ å¯†è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆ Base64 è§£å¯†å¾—åˆ°åŸå§‹æ•°æ®ï¼Œç„¶å <strong>AES Key</strong> éœ€è¦å†é€šè¿‡ Airtunes çš„ç§˜é’¥æ¥ RSA è§£å¯†ï¼Œæœ€åå¾—åˆ° AES è§£å¯†éœ€è¦çš„ Keyã€‚</p>
<h3 id="SETUP"><a href="#SETUP" class="headerlink" title="SETUP"></a>SETUP</h3><p>åœ¨ ANNOUNCE ä¸­æˆ‘ä»¬ä¸»è¦æ˜¯å¾—åˆ°äº†æ•°æ®æ ¼å¼ï¼Œæ•°æ®è§£å¯†çš„æ–¹æ³•å‚æ•°è¿™äº›åŸºæœ¬ä¿¡æ¯ï¼Œé‚£ä¹ˆ SETUP çš„æ—¶å€™å®¢æˆ·ç«¯å°±æ˜¯åœ¨å’Œæˆ‘ä»¬äº¤æ¢ä¸€äº›è¿æ¥ä¿¡æ¯ï¼šä¸»è¦ä¹Ÿå°±æ˜¯ä¸‰ä¸ª port çš„ä¿¡æ¯ï¼Œå¯¹åº”ä¸‰ä¸ª channelï¼Œåˆ†åˆ«æ˜¯ <strong>control port -&gt; control channel</strong>ï¼Œ<strong>timing port -&gt; timing channel</strong> å’Œ <strong>server port -&gt; audio channel</strong>ï¼Œè¿™æ˜¯ä¸‰ä¸ª <strong>UDP è¿æ¥</strong>çš„ç«¯å£ã€‚è¿™ä¹Ÿæ˜¯æ•´ä¸ª Airtunes æœåŠ¡ç»“æ„ä¸­æœ€é‡è¦çš„éƒ¨åˆ†äº†ï¼š</p>
<ul>
<li><strong>control port</strong> æ˜¯ç”¨æ¥å‘é€ resendTransmitRequest çš„ channelï¼Œä¹Ÿå°±æ˜¯å½“ Android è¿™è¾¹å‘ç°æˆ‘æ”¶åˆ°çš„éŸ³ä¹æµæ•°æ®åŒ…ä¸­æœ‰ä¸¢å¤±å¸§çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ control port å‘é€ resendTransmit çš„ request ç»™ iOS è®¾å¤‡ï¼Œè®¾å¤‡æ”¶åˆ°åä¼šå°†å¸§åœ¨ response ä¸­è¡¥å‘å›æ¥</li>
<li><strong>timing port</strong> ç”¨æ¥ä¼ è¾“ Airplay çš„æ—¶é—´åŒæ­¥åŒ…ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘ iOS è®¾å¤‡è¯·æ±‚å½“å‰çš„æ—¶é—´æˆ³æ¥æ ¡å‡†æµçš„æ—¶é—´æˆ³</li>
<li><strong>server port</strong> åˆ™æ˜¯ç”¨æ¥ä¼ è¾“æœ€ä¸»è¦çš„éŸ³ä¹æµæ•°æ®åŒ…</li>
</ul>
<blockquote>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬å°† control å’Œ timing çš„åŒ…ç»Ÿä¸€ reroute åˆ° audio çš„ channel ä¸Šæ¥å¤„ç†ã€‚æ¥æ”¶åˆ°çš„ UpStream å°†åŒ…ä» control å’Œ timing é›†ä¸­åˆ° audio æ¥å¤„ç†ï¼Œè€Œå‘é€å‡ºå»çš„ DownStream åˆ™æ˜¯å°†æŒ‡å®šç±»å‹çš„åŒ…ä» audio åˆ†å‘åˆ° control å’Œ timing å»å‘é€å’Œæ¥æ”¶ responseã€‚ä¸‹é¢ä¼šè¯¦ç»†å±•å¼€ã€‚</p>
</blockquote>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Split Transport header into individual options and prepare response options list */</span></span><br><span class="line"><span class="keyword">final</span> Deque&lt;<span class="keyword">String</span>&gt; requestOptions = <span class="keyword">new</span> java.util.LinkedList&lt;<span class="keyword">String</span>&gt;(Arrays.asList(req.getHeader(HEADER_TRANSPORT).<span class="built_in">split</span>(<span class="string">";"</span>)));</span><br><span class="line"><span class="keyword">final</span> List&lt;<span class="keyword">String</span>&gt; responseOptions = <span class="keyword">new</span> java.util.LinkedList&lt;<span class="keyword">String</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Transport header. Protocol must be RTP/AVP/UDP */</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">String</span> requestProtocol = requestOptions.removeFirst();</span><br><span class="line"><span class="keyword">if</span> ( ! <span class="string">"RTP/AVP/UDP"</span>.equals(requestProtocol))&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ProtocolException(<span class="string">"Transport protocol must be RTP/AVP/UDP, but was "</span> + requestProtocol);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">responseOptions.<span class="built_in">add</span>(requestProtocol);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>HEADER ä¸­ key ä¸º <strong>Transport</strong> çš„å­—æ®µå€¼å¿…é¡»ä¸º <code>RTP/AVP/UDP</code> ã€‚</p>
</blockquote>
<p>é¦–å…ˆå¯¹ SETUP çš„å‚æ•°åˆ—è¡¨è¿›è¡Œè§£æï¼Œè§£å‡ºæ¥çš„ <code>requestOptions</code> ä»ç„¶æ˜¯ç”¨æ­£åˆ™åŒ¹é…çš„å½¢å¼è·å–åˆ° key - value å¯¹ï¼š</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Parse incoming transport options and build response options */</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">final</span> <span class="keyword">String</span> requestOption: requestOptions) &#123;</span><br><span class="line"><span class="comment">/* Split option into key and value */</span></span><br><span class="line"><span class="keyword">final</span> Matcher transportOption = PATTERN_TRANSPORT_OPTION.matcher(requestOption);</span><br><span class="line"><span class="keyword">if</span> ( ! transportOption.matches() )&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ProtocolException(<span class="string">"Cannot parse Transport option "</span> + requestOption);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">String</span> <span class="built_in">key</span> = transportOption.group(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">final</span> <span class="keyword">String</span> value = transportOption.group(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­æˆ‘ä»¬åªè¦å¯¹æŒ‡å®šå‡ ä¸ª key è¿›è¡Œ response å°±å¯ä»¥äº†ï¼Œå…¶ä¸­ï¼Œé™¤äº† <code>interleaved</code> å’Œ <code>mode</code> è¿”å›çš„å‚æ•°æ˜¯å›ºå®šçš„ä¹‹å¤–ï¼Œ<code>control_port</code> å’Œ <code>timing_port</code> åœ¨ request ä¸­æ‰€å¯¹åº”çš„ value æ˜¯å®¢æˆ·ç«¯çš„ç«¯å£ï¼Œè€Œ response ä¸­éœ€è¦å¸¦ä¸ŠæœåŠ¡ç«¯çš„ç«¯å£ã€‚åŒæ—¶ï¼Œè¿™ä¸¤ä¸ª UDP è¿æ¥ç”±æœåŠ¡ç«¯å‘èµ·å»è¿æ¥å®¢æˆ·ç«¯å¯¹åº”çš„ç«¯å£ã€‚æœ€åå†å‘ŠçŸ¥å®¢æˆ·ç«¯ <code>server_port</code> çš„ç«¯å£ã€‚</p>
<p><strong>interleaved</strong> æŒ‡çš„æ˜¯ç”±äºè¿™æ¡ TCP è¿æ¥ RTP å’Œ RTCP éƒ½è¦ä½¿ç”¨ï¼Œå› æ­¤ä¸¤ä¸ªè¿æ¥çš„æ•°æ®åŒ…ä¼šäº¤å‰ä¼ è¾“åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸Šï¼Œæ¯ä¸ªåŒ…éƒ½ä¼šå†åŠ ä¸€å±‚æ ‡è¯†ï¼Œè€Œæ ‡è¯† Channel çš„å€¼å°±ç”±è¿™é‡Œçš„ interleaved åé¢çš„å€¼ 0-1 æ¥å†³å®šï¼Œè¡¨ç¤ºæœ‰ 0 å’Œ 1 ä¸¤ç§äº¤å‰æ··ç”¨çš„ Channel ç±»å‹ã€‚</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Probably means that two channels are interleaved in the stream. Included in the response options */</span></span><br><span class="line"><span class="keyword">if</span> ( ! <span class="string">"0-1"</span>.<span class="keyword">equals</span>(<span class="keyword">value</span>))&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ProtocolException(<span class="string">"Unsupported Transport option, interleaved must be 0-1 but was "</span> + <span class="keyword">value</span>);</span><br><span class="line">&#125;</span><br><span class="line">responseOptions.<span class="keyword">add</span>(<span class="string">"interleaved=0-1"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>mode</strong> åˆ™æ˜¯æ ¡éªŒå®¢æˆ·ç«¯è¦æ±‚æˆ‘ä»¬åšçš„äº‹æƒ…ï¼Œè¿™æ˜¯ RTSP åè®®ä¸­è§„å®šçš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ Airplay ä¸­ï¼ŒServer æ°¸è¿œæ‰¿æ‹…çš„æ˜¯æ¥æ”¶æ•°æ®çš„å·¥ä½œï¼Œå› æ­¤ mode çš„å€¼ä¹Ÿåº”å½“ä¿æŒä¸º <strong>record</strong> ã€‚</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Means the we're supposed to receive audio data, not send it. Included in the response options */</span></span><br><span class="line"><span class="keyword">if</span> ( ! <span class="string">"record"</span>.<span class="keyword">equals</span>(<span class="keyword">value</span>))&#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> ProtocolException(<span class="string">"Unsupported Transport option, mode must be record but was "</span> + <span class="keyword">value</span>);</span><br><span class="line">&#125;</span><br><span class="line">responseOptions.<span class="keyword">add</span>(<span class="string">"mode=record"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>control_port</strong> æ˜¯ control channel å¯¹åº”çš„å®¢æˆ·ç«¯çš„ç«¯å£å·ï¼Œè€Œæˆ‘ä»¬è¿”å›çš„ response ä¸­éœ€è¦æ”¹æˆæœåŠ¡ç«¯çš„ç«¯å£å·ã€‚å¯ä»¥éšä¾¿åˆ†é…ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç«¯å£å·å°±è¡Œã€‚</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Port number of the client's control socket. Response includes port number of *our* control port */</span></span><br><span class="line">final int clientControlPort = Integer.valueOf(value)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">controlChannel = createRtpChannel(</span><br><span class="line"><span class="keyword">substitutePort((InetSocketAddress)ctx.getChannel().getLocalAddress(), </span><span class="number">53670</span>),</span><br><span class="line"><span class="keyword">substitutePort((InetSocketAddress)ctx.getChannel().getRemoteAddress(), </span>clientControlPort),</span><br><span class="line">RaopRtpChannelType.Control</span><br><span class="line">)<span class="comment">;</span></span><br><span class="line">responseOptions.<span class="keyword">add("control_port=" </span>+ ((InetSocketAddress)controlChannel.getLocalAddress()).getPort())<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>timing_port</strong> åˆ™æ˜¯ timing channel å¯¹åº”çš„å®¢æˆ·ç«¯çš„ç«¯å£å·ã€‚</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Port number of the client's timing socket. Response includes port number of *our* timing port */</span></span><br><span class="line">final int clientTimingPort = Integer.valueOf(value)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">timingChannel = createRtpChannel(</span><br><span class="line"><span class="keyword">substitutePort((InetSocketAddress)ctx.getChannel().getLocalAddress(), </span><span class="number">53669</span>),</span><br><span class="line"><span class="keyword">substitutePort((InetSocketAddress)ctx.getChannel().getRemoteAddress(), </span>clientTimingPort),</span><br><span class="line">RaopRtpChannelType.Timing</span><br><span class="line">)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">responseOptions.<span class="keyword">add("timing_port=" </span>+ ((InetSocketAddress)timingChannel.getLocalAddress()).getPort())<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>server_port</strong> è¿™ä¸ª key å¹¶ä¸åœ¨ SETUP çš„å‚æ•°åˆ—è¡¨ä¸­ï¼Œä½†æ˜¯ä½ éœ€è¦åœ¨ response ä¸­å¸¦ä¸Šï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯ä½ åœ¨å“ªä¸ªç«¯å£æ‰“å¼€äº†ä½ çš„ audio æ•°æ®æ¥æ”¶ã€‚å› æ­¤å®ƒä¸éœ€è¦ä¸»åŠ¨å»è¿æ¥å®¢æˆ·ç«¯çš„ç«¯å£ã€‚</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Create audio socket and include it's port in our response */</span></span><br><span class="line">audioChannel = createRtpChannel(</span><br><span class="line"><span class="keyword">substitutePort((InetSocketAddress)ctx.getChannel().getLocalAddress(), </span><span class="number">53671</span>),</span><br><span class="line">null,</span><br><span class="line">RaopRtpChannelType.Audio</span><br><span class="line">)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">responseOptions.<span class="keyword">add("server_port=" </span>+ ((InetSocketAddress)audioChannel.getLocalAddress()).getPort())<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­çš„ <code>createRtpChannel</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿä¸ºæ¯ä¸€ä¸ªç«¯å£æ–°å»ºä¸€ä¸ª bootstrap å®ä¾‹ï¼Œæ·»åŠ  pipeline Handlerï¼Œç„¶åå°† timing å’Œ control ä¸¤ä¸ª port è¿æ¥åˆ° SETUP åŒ…å¸¦æ¥çš„ iOS å®¢æˆ·ç«¯ç«¯å£ä¸Šå»ã€‚è¿æ¥æˆåŠŸå SETUP ä¹Ÿå°±å¤„ç†å®Œæ¯•äº†ã€‚</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Set pipeline factory for the RTP channel */</span></span><br><span class="line"><span class="keyword">bootstrap.setPipelineFactory(new </span>ChannelPipelineFactory() &#123;</span><br><span class="line">@Override</span><br><span class="line">public ChannelPipeline getPipeline() throws Exception &#123;</span><br><span class="line">final ChannelPipeline pipeline = Channels.pipeline()<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">final AirPlayServer airPlayServer = AirPlayServer.getIstance()<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">pipeline.<span class="keyword">addLast("executionHandler", </span>airPlayServer.getChannelExecutionHandler())<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("exceptionLogger", </span>exceptionLoggingHandler)<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("decoder", </span>decodeHandler)<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("encoder", </span>encodeHandler)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* We pretend that all communication takes place on the audio channel,</span></span><br><span class="line"><span class="comment">* and simply re-route packets from and to the control and timing channels</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">if ( ! channelType.equals(RaopRtpChannelType.Audio)) &#123;</span><br><span class="line">pipeline.<span class="keyword">addLast("inputToAudioRouter", </span>inputToAudioRouterDownstreamHandler)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Must come *after* the router, otherwise incoming packets are logged twice */</span></span><br><span class="line">pipeline.<span class="keyword">addLast("packetLogger", </span>packetLoggingHandler)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line"><span class="comment">/* Must come *before* the router, otherwise outgoing packets are logged twice */</span></span><br><span class="line">pipeline.<span class="keyword">addLast("packetLogger", </span>packetLoggingHandler)<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("audioToOutputRouter", </span>audioToOutputRouterUpstreamHandler)<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("timing", </span>timingHandler)<span class="comment">;</span></span><br><span class="line">pipeline.<span class="keyword">addLast("resendRequester", </span>resendRequestHandler)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">if (decryptionHandler != null)&#123;</span><br><span class="line">pipeline.<span class="keyword">addLast("decrypt", </span>decryptionHandler)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (audioDecodeHandler != null)&#123;</span><br><span class="line">pipeline.<span class="keyword">addLast("audioDecode", </span>audioDecodeHandler)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pipeline.<span class="keyword">addLast("enqueue", </span>audioEnqueueHandler)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return pipeline<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ pipeline æ¨¡å‹å¦‚å›¾ï¼Œä¹Ÿæ˜¯ä¸‰ä¸ª channel å¤„ç†æµç¨‹çš„ç»“æ„å›¾ï¼Œæ¥ä¸‹æ¥çš„å°èŠ‚ä¼šå±•å¼€è¯´æ˜ï¼š</p>
<p><img src="https://ooo.0o0.ooo/2016/08/28/57c300b59b89e.png" alt=""></p>
<h2 id="Audio_Pipeline__u548C__u4E09_u4E2A_Channel__u4E4B_u95F4_u7684_u5173_u7CFB"><a href="#Audio_Pipeline__u548C__u4E09_u4E2A_Channel__u4E4B_u95F4_u7684_u5173_u7CFB" class="headerlink" title="Audio Pipeline å’Œ ä¸‰ä¸ª Channel ä¹‹é—´çš„å…³ç³»"></a>Audio Pipeline å’Œ ä¸‰ä¸ª Channel ä¹‹é—´çš„å…³ç³»</h2><p>SETUP ç»“æŸä¹‹åå°±ä¼šå¼€å§‹æ”¶åˆ° Audio çš„æ•°æ®åŒ…äº†ã€‚é‚£ä¹ˆæ­£å¼çš„å¤„ç†å°±è¦å¼€å§‹äº†ã€‚</p>
<p>æ ¹æ®ä¸Šé¢è¿™å¼ æˆ‘æ€»ç»“å‡ºæ¥çš„æµç¨‹å›¾ï¼ŒAirplay Service å¯ä»¥æ ¹æ® bootstrap çš„ pipeline çš„ç‰¹æ€§å¯ä»¥åˆ†ä¸º <code>Up Stream</code> å’Œ <code>Down Stream</code>ï¼Œä¸€ä¸ªæ˜¯ä»å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯ä¼ é€’çš„æ¶ˆæ¯ï¼Œä¸€ä¸ªæ˜¯ä»æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯ä¼ é€’çš„æ¶ˆæ¯ã€‚</p>
<h5 id="Up_Stream"><a href="#Up_Stream" class="headerlink" title="Up Stream"></a>Up Stream</h5><p>é¦–å…ˆä¸è®ºæ˜¯ Up è¿˜æ˜¯ Down Streamï¼Œéƒ½è¦å…ˆç»è¿‡ä¸€ä¸ª Executor Handlerï¼Œè¿™ä¸ª Handler ä¸­åŒ…æ‹¬äº†ä¸€ä¸ªçº¿ç¨‹æ±  Executorï¼Œå½“æ”¶åˆ°æ–°çš„ UpStream çš„æ•°æ®åŒ…çš„æ—¶å€™ï¼Œéƒ½ä¼šäº¤ç»™è¿™ä¸ªçº¿ç¨‹æ± æ¥åˆ†é…çº¿ç¨‹å¤„ç†ï¼Œåœ¨è¿™é‡Œå£°æ˜çš„çº¿ç¨‹æ± æ˜¯ä¸€ä¸ª <code>OrderedMemoryAwareThreadPoolExecutor</code>ã€‚è‡³äºä¸ºä»€ä¹ˆåœ¨ Netty çš„ pipeline å¤„ç†ä¸­è¦ç”¨åˆ°çº¿ç¨‹æ± æ¥åˆ†é…ä»»åŠ¡ï¼Œå¯ä»¥å‚è€ƒ<a href="http://www.techv5.com/topic/85/" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ã€‚ç®€è¦åœ°è¯´å°±æ˜¯ç”±äº Handler å¤„ç†çš„å·¥ä½œé‡å¾ˆå¤§ï¼Œä¸ºäº†ä¸å µå¡çº¿ç¨‹ï¼ŒNetty ä¼šå¼€å¥½å‡ ä¸ªçº¿ç¨‹æ¥å¤„ç†ï¼Œå¹¶ä¸” <code>OrderedMemoryAwareThreadPoolExecutor</code> èƒ½å¤Ÿä¿è¯å¤„ç†çš„äº‹ä»¶æµçš„é¡ºåºï¼Œæ‰€ä»¥è¿™é‡Œè¦åŠ è¿™ä¸€å±‚ã€‚</p>
<p>æ•°æ®è¿›å…¥ pipeline ä¹‹åï¼Œå…ˆæ˜¯æŒ‰ç…§ RTP Packet çš„æ ¼å¼è¿›è¡Œ decodeã€‚åœ¨ Airplay åè®®ä¸­ï¼Œæ€»å…±æœ‰å¦‚ä¸‹å‡ ç§ Packet Typeï¼š</p>
<ul>
<li>TimingRequest</li>
<li>TimingResponse</li>
<li>Sync</li>
<li>RetransmitRequest</li>
<li>AudioRetransmit</li>
<li>AudioTransmit</li>
</ul>
<p>å…¶ä¸­ <code>TimingRequest</code>ï¼Œ<code>TimingResponse</code> å’Œ <code>Sync</code> ä¸‰ç§åŒ…ç±»å‹éƒ½æ˜¯å±äº timing channelçš„ï¼Œ<code>RetransmitRequest</code> æ˜¯ç”± control channel å‘èµ·çš„å¯¹ä¸¢å¤±åŒ…é‡ä¼ çš„è¯·æ±‚ï¼Œè€Œ <code>AudioRetransmit</code> å’Œ <code>AudioTransmit</code> éƒ½æ˜¯ç”± audio channel å¤„ç†çš„åŒ…å«äº†éŸ³ä¹æ•°æ®çš„åŒ…ã€‚</p>
<p>æ¶ˆæ¯ç»§ç»­å¾€ä¸‹ä¼ é€’ï¼Œè¿‡äº† Logger ä¹‹åå°±åˆ°äº† routerã€‚router ç»´æŠ¤äº† audio channel å’Œå¦å¤–ä¸¤ä¸ª channel ä¹‹é—´çš„å…³ç³»ï¼šrouter å°†å¦å¤–ä¸¤ä¸ª channel åº”è¯¥å¤„ç†çš„åŒ…å‘é€ç»™å¯¹åº”çš„ Handler å»å¤„ç†ã€‚</p>
<p>timing channel ä¸ä»…å¤„ç† Sync æ•°æ®åŒ…ï¼ŒåŒæ—¶åœ¨ channel å¯åŠ¨çš„æ—¶å€™ä¹Ÿä¼šå¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ï¼Œæ¯ä¸‰ç§’é’Ÿæ‰§è¡Œä¸€æ¬¡ timing requestï¼Œæ¥ç¡®è®¤æœ¬åœ°æ—¶é’Ÿå’Œå®¢æˆ·ç«¯æ—¶é’Ÿçš„åŒæ­¥ã€‚è€Œ control channel åšçš„äº‹æƒ…åˆ™æ˜¯åœ¨<strong>æ¯æ”¶åˆ°ä¸€ä¸ª</strong>æ–°çš„ audio æ•°æ®åŒ…çš„æ—¶å€™éƒ½ä¼š<strong>ç¡®è®¤ä¸€æ¬¡æ•°æ®åŒ…çš„ sequence number æ˜¯å¦å’Œå½“å‰çš„æ˜¯è¿ç»­çš„</strong>ï¼Œå¦‚æœä¸æ˜¯è¿ç»­çš„ï¼Œåˆ™å°†ä¸­é—´ç¼ºå¤±çš„ number æ ‡è®°ä¸º missing çš„æ•°æ®åŒ…ï¼Œå¹¶ä¸”å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª resend çš„è¯·æ±‚ã€‚å½“å®¢æˆ·ç«¯å‘æ¥äº† <code>AudioRetransmit</code> ç±»å‹çš„æ•°æ®åŒ…åï¼Œå®ƒçš„å†…å®¹å…¶å®ä¹Ÿæ˜¯ç”± audio channel æ¥æ”¶çš„ï¼Œcontrol channcel åªæ˜¯è´Ÿè´£å°†åˆšæ‰æ ‡è®°ä¸º missing çš„ sequence number æ¸…é™¤æ‰ã€‚</p>
<p>è¿™ä¸¤ä¸ª channel åœ¨å‘é€ request çš„æ—¶å€™ï¼Œä¹Ÿä¼šå‘å›åˆ° audio channel çš„ Handler ä¸Šæ¥ï¼Œé€šè¿‡ audio channel è¿™è¾¹çš„ encode ä¹‹åå†å‘é€å‡ºå»ã€‚</p>
<p>è€ŒéŸ³ä¹æ•°æ®åŒ…ï¼Œåˆ™éœ€è¦ç»è¿‡ AES è§£å¯†ï¼Œè¿™ä¸ªè§£å¯†å™¨æˆ‘ä»¬å·²ç»åœ¨ ANNOUNCE çš„æ—¶å€™åˆå§‹åŒ–å¥½äº†ï¼Œå†ç»è¿‡ ALACDecoderï¼Œä¹Ÿæ˜¯åœ¨ ANNOUNCE çš„æ—¶å€™æ ¹æ®è·å¾—çš„åª’ä½“ä¿¡æ¯åˆå§‹åŒ–çš„éŸ³é¢‘è§£ç å™¨ï¼Œæœ€ååœ¨ EnqueueHandler ä¸­å†³å®šæ˜¯å¦è¿›å…¥éŸ³é¢‘è¾“å‡ºé˜Ÿåˆ—ã€‚</p>
<h5 id="Down_Stream"><a href="#Down_Stream" class="headerlink" title="Down Stream"></a>Down Stream</h5><p>å¾€å®¢æˆ·ç«¯å‘é€çš„ä¿¡æ¯ä¸»è¦å°±æ˜¯ timine å’Œ control ä¸¤ä¸ª channel å‘èµ·çš„ä¸€äº›è¯·æ±‚äº†ï¼Œaudio channel æ²¡æœ‰å‚ä¸ down stream çš„ä¼ é€’ã€‚</p>
<h2 id="EnqueueHandler__u97F3_u4E50_u6570_u636E_u961F_u5217_Handler"><a href="#EnqueueHandler__u97F3_u4E50_u6570_u636E_u961F_u5217_Handler" class="headerlink" title="EnqueueHandler éŸ³ä¹æ•°æ®é˜Ÿåˆ— Handler"></a>EnqueueHandler éŸ³ä¹æ•°æ®é˜Ÿåˆ— Handler</h2><p>å½“ä¸€ä¸ªæ•°æ®åŒ…ç»è¿‡å±‚å±‚è§£å¯†å’Œè§£æè¿›å…¥é˜Ÿåˆ— Handler ä¹‹åï¼Œè¿˜è¦è¿›è¡Œä¸€å¤§å †çš„æ—¶é—´æˆ³åˆæ³•æ€§æ ¡éªŒã€‚<strong>æ¯ä¸€ä¸ªæ•°æ®åŒ…éƒ½åŒ…å«äº†å¾ˆå¤šå¸§ï¼Œæ¯ä¸€ä¸ªå¸§éƒ½åŒ…å«äº†ä¸€ä¸ªå¸§åºå·ï¼Œè€Œæ¯ä¸€ä¸ªåŒ…ä¹Ÿéƒ½æœ‰ä¸€ä¸ªå¼€å§‹çš„å¸§åºå·ã€‚</strong>è¿™é‡Œæ¶‰åŠåˆ°å¥½å‡ ä¸ªåœ°æ–¹çš„æ—¶é—´å’Œä¸æ—¶é—´ç›¸å¯¹åº”çš„å¸§åºåˆ—ï¼š</p>
<ul>
<li>Android ä¸Š  Audio Track å½“å‰çš„ time</li>
<li>æœåŠ¡ç«¯é˜Ÿåˆ—ä¸­å½“å‰çš„ frame time</li>
<li>audio channel ä¸­å®¢æˆ·ç«¯ä¼ æ¥çš„æ•°æ®åŒ…ä¸­çš„ frame time</li>
<li>timing channel ä¸­å®¢æˆ·ç«¯ä¼ æ¥çš„ Sync å’Œ timing response åŒ…ä¸­çš„ frame time</li>
</ul>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å…è®¸ä¸€å®šèŒƒå›´çš„å»¶è¿Ÿï¼Œå› ä¸ºæ•°æ®çš„ä¼ è¾“ï¼Œæœ€å¼€å§‹çš„æ¡æ‰‹åŒ…æ‹¬ iOS ç«¯ Airplay çš„æœºåˆ¶éƒ½å¯èƒ½å¯¼è‡´ä¸€å®šçš„å»¶è¿Ÿï¼Œå› æ­¤ <strong>timing channel æœ€é‡è¦çš„ä½œç”¨ä¹‹ä¸€å°±æ˜¯ç»´æŠ¤å’Œå½“å‰ä¸»é˜Ÿåˆ—æœ€æ–° frame timeçš„ offset</strong>ã€‚åœ¨æ¯ä¸€ä¸ª timing response çš„åŒ…ä¸­ï¼Œæˆ‘å¯ä»¥çŸ¥é“å½“å‰å®¢æˆ·ç«¯çš„å¸§åºå·å’ŒæœåŠ¡ç«¯å·²ç»æ’­æ”¾åˆ°çš„å¸§åºå·çš„ offsetï¼Œåœ¨æ¯è§£æä¸€ä¸ªæ•°æ®åŒ…çš„æ—¶å€™ï¼Œéƒ½è¦ä½¿ç”¨å½“å‰çš„ offset æ¥å°†å®¢æˆ·ç«¯çš„å¸§åºå·è½¬æ¢æˆæœåŠ¡ç«¯çš„å¸§åºå·ã€‚æ¯ä¸ªåŒ…æ‰€å¸¦çš„ frame time éƒ½å¯èƒ½æœ‰ä¸‹é¢ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><strong>å¤ªè¿Ÿäº†</strong></li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/08/29/57c42046195f6.png" alt=""></p>
<p>å¤ªè¿Ÿäº†çš„æƒ…å†µå¦‚å›¾æ‰€ç¤ºï¼ŒLine Time è¿™æ¡è½´å°±æ˜¯ Audio Track ï¼Œ<strong>Now Time</strong> æŒ‡çš„æ˜¯å½“å‰éŸ³ä¹æ•°æ®å·²ç»æ’­æ”¾åˆ°ä»€ä¹ˆæ—¶é—´äº†ï¼Œè¿™æ—¶å€™æœåŠ¡ç«¯æ¥æ”¶åˆ°çš„ä¸€ä¸ª Packetï¼Œåœ¨åŒ…ä¸­çš„å¼€å§‹å¸§åºåˆ—ä¸º frame timeï¼Œå°†è¿™ä¸ªå¸§åºåˆ—è½¬æ¢ä¸ºæœ¬åœ° Audio Track å¯¹åº”çš„ Line Timeï¼ŒåŠ ä¸Šæ•´ä¸ª Packet åŒ…å«çš„å¸§æ•°ï¼Œè¿™ä¸ªå€¼ä¸ Now Time çš„å·®è·<strong>è½¬åŒ–æˆæ—¶é—´</strong>å°±æ˜¯å®ƒçš„ Delayï¼Œå½“è¿™ä¸ª delay å¤§äºä¸€ä¸ªåŒ…é•¿åº¦çš„æ—¶å€™ï¼Œç”±äºå®ƒå·²ç»æ˜¯æ’­æ”¾è¿‡çš„æ—¶é—´çº¿äº†ï¼Œå› æ­¤å½“ä¸€ä¸ªåŒ…è¿Ÿåˆ°äº†ä¸€ä¸ªåŒ…çš„é•¿åº¦ä»¥ä¸Šï¼Œå®ƒå°±ä¸å†è¢«éœ€è¦äº†ï¼Œè¿™æ—¶å€™è¿™ä¸ªåŒ…ä¹Ÿå°±ä¸ä¼šè¢«åŠ è¿› queue äº†ã€‚</p>
<ul>
<li><strong>å¤ªæ—©</strong></li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/08/29/57c42030293f6.png" alt=""></p>
<p>å¤ªæ—©çš„æƒ…å†µå¦‚å›¾æ‰€ç¤ºã€‚æœ‰åˆ«äºè¿Ÿåˆ°çš„åŒ…ï¼Œæå‰æ¥çš„åŒ…å…¶å®æ˜¯ä»¶å¥½äº‹ï¼Œä½†æ˜¯æå‰æ¥çš„å¤ªæ—©çš„åŒ…ä¹Ÿä¸ä¸€å®šæ˜¯ä»¶å¥½äº‹ï¼Œå®ƒå¾ˆå¯èƒ½è¦ä¹ˆæ˜¯ä¸ªé”™è¯¯çš„åŒ…ï¼Œè¦ä¹ˆæ˜¯ä¸ªä¼ è¾“é”™è¯¯çš„åŒ…ã€‚å› æ­¤å¯¹äºæå‰åˆ°æ¥çš„åŒ…ä¸€èˆ¬éƒ½æœ‰ä¸€ä¸ªæ—¶é—´é•¿åº¦çš„é˜ˆå€¼ï¼Œæå‰äº†å¤§äºå¤šå°‘ç§’åˆ°æ¥çš„åŒ…æ‰ä¼šè¢«è®¤å®šæ˜¯ too early ç„¶åè¢«ä¸¢æ‰ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­è¿™ä¸ªé˜ˆå€¼ä¸º 10 ç§’ã€‚</p>
<ul>
<li><strong>æ­£æ­£å¥½ï¼Œè¿˜è¡Œ</strong></li>
</ul>
<p><img src="https://ooo.0o0.ooo/2016/08/29/57c42013d2672.png" alt=""></p>
<p>æ­£æ­£å¥½çš„æƒ…å†µå¦‚å›¾æ‰€ç¤ºã€‚å½“ä¸€ä¸ªæ•°æ®åŒ…ä¸Šè¿°ä¸¤ç§æƒ…å†µéƒ½ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œé‚£å°±è¯´æ˜è¿™ä¸ªåŒ…çš„æ—¶é—´æˆ³å’Œå¸§åºåˆ—æ˜¯æˆ‘ä»¬å¯ä»¥æ¥å—çš„ï¼Œäºæ˜¯æˆ‘ä»¬å°†è¿™ä¸ªåŒ…åŠ è¿›æœ€åçš„éŸ³é¢‘å¤„ç†é˜Ÿåˆ—ã€‚</p>
<p>è¿›å…¥äº†é˜Ÿåˆ—ä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦å°†æ•°æ®ä»è¿™ä¸ªé˜Ÿåˆ—ä¸­æŒ‰é¡ºåºå†™åˆ° Audio Track ä¸Šå»ã€‚é¦–å…ˆç¡®ä¿ Audio Track çš„æ¨¡å¼ä¸º <strong>MODE_STREAM</strong> ï¼Œç„¶åæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºå¤„ç†é˜Ÿåˆ—ã€‚å…¶å®åœ¨è¿™é‡Œçš„å¤„ç†ä¸­å¯¹äºæ¯ä¸€ä¸ªåŒ…çš„å¼€å§‹å¸§çš„åºåˆ—å·åˆåšäº†ä¸€æ¬¡æ ¡éªŒï¼Œç±»ä¼¼ä¸Šé¢å¯¹äº Delay çš„åšæ³•ï¼Œåœ¨è¿™é‡Œåˆä¼šä»é˜Ÿåˆ—ä¸­å†æ¬¡ç­›é€‰æ‰ä¸€äº›æ— ç”¨å¸§ã€‚æ¥ä¸‹å»åœ¨å°†å¸§æœ€åæ·»åŠ åˆ° Audio Track ä¸Šå»çš„æ—¶å€™ï¼Œç”±äºæˆ‘ä»¬æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­çš„åŒ…åªæ˜¯ä¸Šé¢çš„<strong>æ­£æ­£å¥½ï¼Œè¿˜è¡Œ</strong>çš„æƒ…å†µï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°ä¸‹ä¸€ä¸ªåŒ…çš„å¼€å§‹å’Œå½“å‰ Audio Track çš„ Line Time æ— æ³•å®Œå…¨å»åˆçš„æƒ…å†µå‡ºç°ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦åœ¨ç¼ºå°‘å¸§çš„åœ°æ–¹è¡¥ä¸Šç©ºå¸§ï¼Œåœ¨å¤šä½™å¸§çš„åœ°æ–¹ç­‰å¾…ä¸€ä¼šç›´åˆ°å¸§çš„åºå·å®Œå…¨å¯¹ä¸Šï¼Œç„¶åå†å°†å¸§å†™å…¥ Audio Trackï¼Œè¿™æ ·èƒ½å¤Ÿä¿è¯æœ€ç»ˆæ’­æ”¾çš„å¸§ä¸€å®šæ˜¯åºåˆ—æ­£ç¡®çš„ã€‚</p>
<h2 id="u66F4_u591A"><a href="#u66F4_u591A" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p>å…¶å®è¿™ç¯‡åšå®¢æ²¡æœ‰æ¶‰åŠå¤ªå¤šå®‰å“ç›¸å…³çš„ä¸œè¥¿ï¼Œè¯´ç™½äº†ä¹Ÿåªæ˜¯ Airplay Server çš„ä¸€ç§ Java å®ç°ã€‚åœ¨å®ç°çš„åŸºç¡€ä¸Šï¼ŒæŒæ¡äº† Airplay å®ç°çš„åŸç†çš„è¯ï¼Œåœ¨ä¸è®ºæ˜¯ä»€ä¹ˆå¹³å°ä¸Šéƒ½å¯ä»¥æŒ‰ç…§ç›¸åº”çš„åŸç†æ¥å®ç°ä¸€ä¸ª Airplay Serverã€‚ç”¨è¿™ä¸ªå°†ä½ é—²ç½®åºŸå¼ƒçš„å®‰å“æ‰‹æœºå˜æˆä½ çš„æ— çº¿éŸ³ç®±å§ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨ Android è®¾å¤‡ä¸Šæ­å»ºä¸€ä¸ª Airplay Server å…¶å®æ˜¯ä¸€ä»¶å¾ˆæµ©å¤§çš„å·¥ç¨‹ï¼Œå› ä¸ºè¿™éœ€è¦é€†å‘è‹¹æœçš„ Airplay åè®®æµç¨‹å•Šæ ¼å¼å•Šä»€ä¹ˆçš„ï¼Œä¸‡å¹¸è¿™ä»¶äº‹æƒ…å·²ç»ç”±è®¸è®¸]]>
    </summary>
    
      <category term="Airplay" scheme="http://sergiochan.github.io/tags/Airplay/"/>
    
      <category term="Android" scheme="http://sergiochan.github.io/tags/Android/"/>
    
      <category term="iOS" scheme="http://sergiochan.github.io/tags/iOS/"/>
    
      <category term="ç»†å¿ƒå†™çš„æŠ€æœ¯åšå®¢" scheme="http://sergiochan.github.io/categories/%E7%BB%86%E5%BF%83%E5%86%99%E7%9A%84%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Leetcode - Database åˆ·é¢˜è®°å½•]]></title>
    <link href="http://sergiochan.github.io/2016/08/26/Leetcode-Database-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://sergiochan.github.io/2016/08/26/Leetcode-Database-åˆ·é¢˜è®°å½•/</id>
    <published>2016-08-26T07:50:59.000Z</published>
    <updated>2016-08-26T09:16:34.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å¶ç„¶è¢« Cee é…±å¸å¼•æ‰“å¼€äº† Leetcodeï¼Œè¿™ä¸ªå¤§ä¸€çš„æ—¶å€™è§‰å¾—è‡ªå·±ä¸€è¾ˆå­éƒ½ä¸ä¼šå»åšçš„äº‹æƒ…â€¦â€¦å±…ç„¶ã€‚å‘ç° OJ ç«Ÿç„¶æœ‰ Database æ¨¡å—äº†ï¼Œæƒ³å½“å¹´å¤§å­¦å­¦æ•°æ®åº“çš„æ—¶å€™æœ€æƒ³æœ‰çš„å°±æ˜¯ä¸€ä¸ªå’Œ OJ ä¸€æ ·çš„ SQL åœ¨çº¿è¿è¡Œå¹³å°ï¼Œä¸ç„¶æ•°æ®åº“ä¸Šæœºåªä¼šæ•™ä½ å®‰è£… SQL Server = = æƒ³æƒ³éƒ½æƒ³å“­ï¼Œæ—¶é—´éƒ½æµªè´¹åœ¨é‚£äº†ã€‚è€Œä¸”åšäº†ä¹‹åå‘ç°å¥½å¤šè‡ªå·±åœ¨ç”Ÿäº§ç¯å¢ƒéƒ½ä¸ä¼šé‡åˆ°çš„ç¥å¥‡çš„å‘â€¦â€¦å› æ­¤æŠ½ç€ç©ºé—²åšäº†å¤§éƒ¨åˆ†ï¼Œç•™ä¸‹æ­¤ç¯‡ç¬”è®°ã€‚</p>
<p>æµ®ç”Ÿè‹¥æ¢¦ã€‚</p>
<h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><ul>
<li><a href="#175_-_Combine_Two_Tables">175 . Combine Two Tables</a></li>
<li><a href="#177_-_Nth_Highest_Salary">177 . Nth Highest Salary</a></li>
<li><a href="#181_-_Employees_Earning_More_Than_Their_Managers">181 . Employees Earning More Than Their Managers</a></li>
<li><a href="#182_-_Duplicate_Emails">182 . Duplicate Emails</a></li>
<li><a href="#183_-_Customers_Who_Never_Order">183 . Customers Who Never Order</a></li>
<li><a href="#185_-_Department_Top_Three_Salaries">185 . Department Top Three Salaries</a></li>
<li><a href="#196_-_Delete_Duplicate_Emails">196 . Delete Duplicate Emails</a></li>
<li><a href="#197_-_Rising_Temperature">197 . Rising Temperature</a></li>
</ul>
<h3 id="175_-_Combine_Two_Tables"><a href="#175_-_Combine_Two_Tables" class="headerlink" title="175 . Combine Two Tables"></a>175 . Combine Two Tables</h3><p>Table: <code>Person</code></p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| FirstName   | varchar |</span><br><span class="line">| LastName    | varchar |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">PersonId is the primary key column for this table.</span><br></pre></td></tr></table></figure>
<p>Table: <code>Address</code></p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| AddressId   | int     |</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| City        | varchar |</span><br><span class="line">| State       | varchar |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">AddressId is the primary key column for this table.</span><br></pre></td></tr></table></figure>
<p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">FirstName,</span> LastName, City, State</span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A"><a href="#SQL__3A" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">SELECT Person.FirstName AS FirstName ,Person.LastName AS LastName ,Address.City AS City,Address.State AS State</span><br><span class="line"><span class="keyword">FROM</span> Person</span><br><span class="line">LEFT JOIN<span class="built_in"> Address </span>ON (Person.PersonId = Address.PersonId)</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A"><a href="#Comment__3A" class="headerlink" title="Comment :"></a>Comment :</h4><p>å…¶å®è¿™é¢˜çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸€ä¸ªæ˜¯ç”¨ <strong>LEFT JOIN</strong>ï¼Œè¿™æ ·å³ä½¿æ²¡æœ‰åœ°å€çš„ Person ä¹Ÿä¼šè¢«é€‰å‡ºæ¥ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨ Select çš„æ—¶å€™è¦æŒ‰ç…§å®ƒçš„è¦æ±‚å‘½åé€‰å‡ºæ¥çš„åˆ—ï¼ˆç”±äºè¿™é¢˜è€æ˜¯é‡åˆ° Internal Errorï¼Œç›¸åŒçš„è¯­å¥è¿è¡Œä¸‰éé€šè¿‡ä¸€éæœ‰ä¸¤ééƒ½æ˜¯ Internal Errorï¼Œå› æ­¤å¹¶ä¸æ˜¯ç‰¹åˆ«æ˜ç™½è¿™ä¸ªæ˜¯ä¸æ˜¯å¿…é¡»çš„ï¼‰ä½†æ˜¯ <strong>LEFT JOIN</strong> æ˜¯ä¸€å®šè¦æœ‰çš„ï¼Œç”¨ where è¿æ¥ä¸¤ä¸ªè¡¨çš„è¯ä¹Ÿè¦ç‰¹åˆ«æ³¨æ„åˆ°ä¸å­˜åœ¨çš„æƒ…å†µï¼Œå› æ­¤æœ¬é¢˜è¿˜æ˜¯ç”¨ JOIN åšè¿æ¥å¥½è¿‡ç”¨ where åšå¤šè¡¨è¿æ¥</p>
<h3 id="177_-_Nth_Highest_Salary"><a href="#177_-_Nth_Highest_Salary" class="headerlink" title="177 . Nth Highest Salary"></a>177 . Nth Highest Salary</h3><p>Write a SQL query to get the <em>n</em>th highest salary from the <code>Employee</code> table.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br></pre></td></tr></table></figure>
<p>For example, given the above Employee table, the <em>n</em>th highest salary where <em>n</em> = 2 is <code>200</code>. If there is no <em>n</em>th highest salary, then the query should return <code>null</code>.</p>
<h4 id="SQL__3A-1"><a href="#SQL__3A-1" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">CREATE <span class="keyword">FUNCTION</span> getNthHighestSalary(N INT) RETURNS INT</span><br><span class="line">BEGIN</span><br><span class="line">  <span class="keyword">DECLARE</span> l INT;</span><br><span class="line">  <span class="keyword">DECLARE</span> r INT;</span><br><span class="line">  <span class="keyword">DECLARE</span> c INT;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SET</span> l = N<span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">SELECT</span> COUNT(<span class="keyword">DISTINCT</span>(Salary)) <span class="keyword">INTO</span> c <span class="keyword">FROM</span> Employee;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">IF</span> N &gt; c <span class="keyword">THEN</span> </span><br><span class="line">    <span class="keyword">RETURN</span> (null);</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">SELECT</span> Salary <span class="keyword">INTO</span> r <span class="keyword">FROM</span> Employee <span class="keyword">GROUP</span> <span class="keyword">BY</span> Salary <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary DESC LIMIT l, <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">RETURN</span> (r);</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-1"><a href="#Comment__3A-1" class="headerlink" title="Comment :"></a>Comment :</h4><p>è¿™é¢˜ç®€ç›´å˜æ€ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2016/08/26/57bfebf246fe0.png" alt=""></p>
<p>æœ‰è¿™æ—¶é—´ä¸å¦‚ç”¨ Python ä»€ä¹ˆçš„å–å‡ºæƒ³è¦çš„æ•°æ®åœ¨å†…å­˜é‡Œæ’ä¸ªåºå°±å®Œäº‹äº†ï¼Œéå¾—æ•´ä¸ª SQL Functionï¼Œç®€ç›´ä¸çŸ¥é“è¯´ä»€ä¹ˆå¥½ã€‚ä¹‹å‰ä¹Ÿå†™è¿‡ Functionï¼Œä½†æ˜¯ä¸»è¦æ˜¯åœ¨ SQL çš„ Procedure ç¼–ç¨‹é‡Œé¢ä¼šç”¨åˆ°ï¼Œè€Œä¸”åŸºæœ¬ä¸ä¼šå†™åˆ°å¤æ‚çš„é€»è¾‘ = = å¤æ‚é€»è¾‘å†™ä¸ªè„šæœ¬ä»€ä¹ˆçš„ä¸å¥½ä¹ˆâ€¦â€¦è¨€å½’æ­£ä¼ ï¼Œè¿™é¢˜è€ƒå¯Ÿäº† Function ä¸­çš„å¤šä¸ªåŸºæœ¬è¯­æ³•ï¼ŒåŒ…æ‹¬ <strong>DECLARE</strong>, <strong>SET</strong>, <strong>SELECT çš„ç»“æœèµ‹å€¼</strong>ï¼Œ<strong>IFâ€¦THENâ€¦ELSEâ€¦END IF é€»è¾‘</strong>ã€‚ï¼ˆè¿™é‡Œå…¶å®é¢˜ç›®æ²¡äº¤ä»£æ¸…æ¥šï¼Œæ‡’å¾—åæ§½äº†ï¼‰å¦‚æœé‡åˆ°ç›¸åŒ Salary çš„æ•°æ®æ€ä¹ˆåŠï¼Œå…¶å®é¢˜ç›®çš„æ„æ€æ˜¯å¦‚æœä¸¤ä¸ªäººçš„ Salary éƒ½ä¸º 200ï¼Œä¸€ä¸ªäºº Salary ä¸º 300ï¼Œé‚£å°±åªæœ‰ç¬¬ä¸€ 300 ç¬¬äºŒ 200 è€Œæ²¡æœ‰ç¬¬ä¸‰ï¼Œä»–æœ€åéœ€è¦ä½ è¿”å›çš„ä¹Ÿåªæ˜¯ Salary çš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆå»é‡ä¸€éå¾—åˆ° DISTINCT çš„ Salary å€¼çš„æ•°é‡ï¼Œå¦‚æœè¦è·å–çš„ç¬¬ N ä½å¹¶ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› nullï¼Œå¦‚æœå­˜åœ¨åˆ™ç”¨ <strong>GROUP BY å¥— ORDER BY å¥— LIMIT</strong> æ¥è·å–åˆ†ç»„æ’åºåçš„ç¬¬ N - 1 ä½ï¼Œè®°ä½è¦è·å–çš„ç¬¬ N ä½çš„ index æ˜¯ N - 1ï¼Œæ‰€ä»¥è¿™å„¿æ‰è¦é‡æ–° DECLARE ä¸€ä¸ª l ã€‚</p>
<h3 id="181_-_Employees_Earning_More_Than_Their_Managers"><a href="#181_-_Employees_Earning_More_Than_Their_Managers" class="headerlink" title="181 . Employees Earning More Than Their Managers"></a>181 . Employees Earning More Than Their Managers</h3><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> ManagerId </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 3         </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 4         </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></table></figure>
<p>Given the <code>Employee</code> table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Employee |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Joe      |</span><br><span class="line"><span class="code">+----------+</span></span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-2"><a href="#SQL__3A-2" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.Name <span class="keyword">as</span> Employee </span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">as</span> a </span><br><span class="line"><span class="keyword">WHERE</span> a.ManagerId <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">NULL</span> <span class="keyword">AND</span> a.Salary &gt; </span><br><span class="line">(<span class="keyword">SELECT</span> b.Salary </span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">as</span> b </span><br><span class="line"><span class="keyword">WHERE</span> b.Id = a.ManagerId);</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-2"><a href="#Comment__3A-2" class="headerlink" title="Comment :"></a>Comment :</h4><p>è¿™é¢˜ç®€å•ï¼Œä¸å¤šè§£é‡Šã€‚æœ‰ JOIN çš„è§£æ³•åº”è¯¥ä¹Ÿè¡Œã€‚</p>
<h3 id="182_-_Duplicate_Emails"><a href="#182_-_Duplicate_Emails" class="headerlink" title="182 . Duplicate Emails"></a>182 . Duplicate Emails</h3><p>Write a SQL query to find all duplicate emails in a table named <code>Person</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| Id | Email   |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| 1  | a@b.com |</span><br><span class="line">| 2  | c@d.com |</span><br><span class="line">| 3  | a@b.com |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br></pre></td></tr></table></figure>
<p>For example, your query should return the following for the above table:</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+---------+</span></span><br><span class="line">| Email   |</span><br><span class="line"><span class="code">+---------+</span></span><br><span class="line">| a@b.com |</span><br><span class="line"><span class="code">+---------+</span></span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-3"><a href="#SQL__3A-3" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">SELECT Person.Email </span><br><span class="line"><span class="keyword">FROM</span> Person </span><br><span class="line">GROUP BY Person.Email </span><br><span class="line">HAVING COUNT(Person.Id) &gt; 1;</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-3"><a href="#Comment__3A-3" class="headerlink" title="Comment :"></a>Comment :</h4><p>è¿™é¢˜ç®€å•çš„ä¸èƒ½å†ç®€å•äº†ï¼Œç„¶è€Œè¿˜æ˜¯æœ‰ä¸€ä¸ªè›‹ç–¼çš„å‘ï¼š<strong>COUNT çš„ç”¨æ³•</strong>ã€‚è¿™é¢˜å¦‚æœä½ åœ¨ <strong>having COUNT()</strong> æ‹¬å·ä¸­å†™ * å·ï¼Œæ˜¯ä¸èƒ½é€šè¿‡çš„ï¼ŒåŸå› å°±åœ¨äº <strong>COUNT(*)</strong> ç»Ÿè®¡çš„æ˜¯è¡¨ä¸­æ•°æ®çš„æ€»æ¡æ•°ï¼Œè€Œ <strong>COUNT(Person.Id)</strong> ç»Ÿè®¡çš„åˆ™æ˜¯é™¤å»è¡¨ä¸­ Id ä¸ç­‰äº NULL çš„è®°å½•çš„æ€»æ¡æ•°ã€‚å› æ­¤å¾ˆå¯èƒ½å®ƒæœ‰æŸä¸ª testcase ä¸­æœ‰ NULL çš„æ•°æ®æ¥è€ƒå¯Ÿå¯¹äº COUNT çš„ç†è§£å§ã€‚</p>
<h3 id="183_-_Customers_Who_Never_Order"><a href="#183_-_Customers_Who_Never_Order" class="headerlink" title="183 . Customers Who Never Order"></a>183 . Customers Who Never Order</h3><p>Suppose that a website contains two tables, the <code>Customers</code> table and the <code>Orders</code> table. Write a SQL query to find all customers who never order anything.</p>
<p>Table: <code>Customers</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| Id | Name  |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| 1  | Joe   |</span><br><span class="line">| 2  | Henry |</span><br><span class="line">| 3  | Sam   |</span><br><span class="line">| 4  | Max   |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br></pre></td></tr></table></figure>
<p>Table: <code>Orders</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| Id | CustomerId |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| 1  | 3          |</span><br><span class="line">| 2  | 1          |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br></pre></td></tr></table></figure>
<p>Using the above tables as example, return the following:</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Customers |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Henry     |</span><br><span class="line">| Max       |</span><br><span class="line"><span class="code">+-----------+</span></span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-4"><a href="#SQL__3A-4" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.Name <span class="keyword">AS</span> Customers </span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">AS</span> a </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Orders <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">ON</span> (a.Id = b.CustomerId) </span><br><span class="line"><span class="keyword">WHERE</span> a.Id <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> b.CustomerId <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-4"><a href="#Comment__3A-4" class="headerlink" title="Comment :"></a>Comment :</h4><p>è¿™é¢˜å¦‚æœä¸ç”¨ Left Join è€Œç”¨ Not in çš„è¯ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯æ•ˆç‡æ–¹é¢ Not in çš„è¯è¿è¡Œæ—¶é—´æ˜¯æ’åœ¨ç™¾åˆ†ä¹‹å…«åå¤šï¼Œå¦‚æœç”¨äº†ä¸Šé¢çš„ Left Join åˆ™ä¼šå¥½ä¸€äº› ï¼ˆ runtime æ¯æ¬¡è¿è¡Œä¼šæœ‰å¾®å¦™çš„å·®è·ï¼Œå¯èƒ½å‡ åæ¯«ç§’å°±æ˜¯ç™¾åˆ†ä¹‹å‡ åçš„å·®è·ï¼‰ã€‚</p>
<p><img src="https://ooo.0o0.ooo/2016/08/26/57bfeb47b9186.png" alt=""></p>
<h3 id="185_-_Department_Top_Three_Salaries"><a href="#185_-_Department_Top_Three_Salaries" class="headerlink" title="185 . Department Top Three Salaries"></a>185 . Department Top Three Salaries</h3><p>The <code>Employee</code> table holds all employees. Every employee has an Id, and there is also a column for the department Id.</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> DepartmentId </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> Janet </span>|<span class="string"> 69000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string"> Randy </span>|<span class="string"> 85000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></table></figure>
<p>The <code>Department</code> table holds all departments of the company.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br></pre></td></tr></table></figure>
<p>Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows.</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> Department </span>|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Max      </span>|<span class="string"> 90000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Randy    </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Joe      </span>|<span class="string"> 70000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Henry    </span>|<span class="string"> 80000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Sam      </span>|<span class="string"> 60000  </span>|</span><br><span class="line">+------------+----------+--------+</span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-5"><a href="#SQL__3A-5" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> d.Name <span class="keyword">as</span> Department, a.Name <span class="keyword">as</span> Employee, a.Salary <span class="keyword">as</span> Salary </span><br><span class="line"><span class="keyword">from</span> Employee <span class="keyword">as</span> a,Department <span class="keyword">as</span> d </span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="built_in">count</span>(b.Salary) </span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">e</span>.Salary <span class="keyword">as</span> Salary,<span class="built_in">e</span>.DepartmentId <span class="keyword">as</span> DepartmentId </span><br><span class="line"><span class="keyword">from</span> Employee <span class="keyword">as</span> <span class="built_in">e</span> </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="built_in">e</span>.Salary,<span class="built_in">e</span>.DepartmentId) <span class="keyword">as</span> b </span><br><span class="line"><span class="keyword">where</span> b.Salary &gt; a.Salary <span class="keyword">and</span> b.DepartmentId = a.DepartmentId) &lt;= <span class="number">2</span> <span class="keyword">and</span> d.Id = a.DepartmentId </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a.DepartmentId,a.Salary <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-5"><a href="#Comment__3A-5" class="headerlink" title="Comment :"></a>Comment :</h4><p>å˜æ€ã€‚è¿™é“é¢˜æ— æ„§æ˜¯ Hardã€‚ä¸Šé¢è¿™ä¸ªè§£æ³•è™½ç„¶å¥—äº†ä¸‰å±‚ Select ï¼Œä½†æ˜¯å®ƒçš„è¿è¡Œæ—¶é—´éƒ½èƒ½æ’åœ¨å‰ 15%</p>
<p><img src="https://ooo.0o0.ooo/2016/08/26/57bfea0296548.jpeg" alt=""></p>
<p>å¯è§è¿™é¢˜æœ¬æ¥å°±æ˜¯è®¡ç®—é‡å¾ˆå¤§çš„ä¸€æ¬¡æŸ¥è¯¢ã€‚ä¸»è¦è€ƒå¯Ÿäº† <strong>group by  çš„ç”¨æ³•</strong>ï¼Œgroup by çš„ç”¨æ³•å…¶å®æ¯”è¾ƒç‰¹æ®Šï¼Œæ¯”å¦‚ Salary ç›¸åŒä½†å…¶ä»–åˆ—ä¸åŒçš„æƒ…å†µä¸‹ï¼Œå¦‚æœ group by Salaryï¼Œé‚£å°±åªèƒ½ select salaryï¼Œå¦åˆ™ salary ç›¸åŒçš„é¡¹ç›®ä¼šæ— æ³•åˆå¹¶ã€‚ï¼ˆå½“ç„¶åœ¨ä½ è‡ªå·±çš„ MySQL ç¯å¢ƒä¸‹ä½ å¯ä»¥é…ä¸€ä¸ª full group mode å‚æ•°æ¥å¼ºåˆ¶å…è®¸ MySQL èƒ½å¤Ÿæ‰§è¡Œè¿™æ ·çš„è¯­å¥ï¼‰å› æ­¤åœ¨æœ€ä¸­é—´æˆ‘ä»¬å…ˆæ˜¯å°†ç”¨æˆ·åˆ†ç»„æ’åºè¿‡åçš„æ•°æ®åˆ†è¿›ä¸€ä¸ªå•ç‹¬çš„è¡¨ b ï¼Œè¿™é‡Œçš„æ•°æ®ç”±äº group by Salary å’Œ DepartmentIdï¼Œå› æ­¤åŒéƒ¨é—¨ç›¸åŒ Salary çš„æ•°æ®å·²ç»è¢«åˆå¹¶åˆ°ä¸€é¡¹å»äº†ï¼Œé‚£ä¹ˆæ¥ç€å°±ç¡®è®¤å½“å‰åŒéƒ¨é—¨çš„å·¥èµ„æ¯”è‡ªå·±é«˜çš„ç­‰çº§æ˜¯å¦å°äº 3 ä¸ªï¼Œå¦‚æœæ˜¯çš„è¯å°±å–å‡ºæ¥ã€‚</p>
<p><em>PS . è¿™å¥ SQL ä¸»è¦å°±æ˜¯é•¿é•¿é•¿ï¼Œå…¶å®ä¹Ÿæ²¡ä»€ä¹ˆ = =</em></p>
<h3 id="196_-_Delete_Duplicate_Emails"><a href="#196_-_Delete_Duplicate_Emails" class="headerlink" title="196 . Delete Duplicate Emails"></a>196 . Delete Duplicate Emails</h3><p>Write a SQL query to delete all duplicate email entries in a table named <code>Person</code>, keeping only unique emails based on its <em>smallest</em> <strong>Id</strong>.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line">| 3  | john@example.com |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">Id is the primary key column for this table.</span><br></pre></td></tr></table></figure>
<p>For example, after running your query, the above <code>Person</code> table should have the following rows:</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-6"><a href="#SQL__3A-6" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> Person <span class="keyword">where</span> <span class="keyword">Id</span> <span class="keyword">in</span> (</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> ( </span><br><span class="line"><span class="keyword">select</span> b.Id</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> Person) <span class="keyword">as</span> b </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span> (</span><br><span class="line"><span class="keyword">select</span> d.* </span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> Person) <span class="keyword">as</span> d </span><br><span class="line"><span class="keyword">where</span> d.Id &lt; b.Id <span class="keyword">and</span> b.Email = d.Email)) <span class="keyword">as</span> <span class="keyword">test</span>);</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-6"><a href="#Comment__3A-6" class="headerlink" title="Comment :"></a>Comment :</h4><p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ <strong>delete + where + in</strong> çš„å¥—è·¯ã€‚delete where in åé¢è·Ÿç€çš„ select é‡Œé¢çš„è¡¨ä¸èƒ½æ˜¯ delete çš„ targetï¼Œè¿™ä¸ªè§„åˆ™ delete å’Œ update åŒç†ï¼Œè¦åœ¨ delete where in åé¢åŠ ä¸Š target è¡¨çš„æŸ¥è¯¢ï¼Œä½ å°±éœ€è¦å¥—ä¸€å±‚ select * â€¦ as â€¦ å°±å¯ä»¥äº†ã€‚æ•ˆç‡ç•¥ä½ï¼Œä½†æ˜¯å®ç”¨ã€‚</p>
<h3 id="197_-_Rising_Temperature"><a href="#197_-_Rising_Temperature" class="headerlink" title="197 . Rising Temperature"></a>197 . Rising Temperature</h3><p>Given a <code>Weather</code> table, write a SQL query to find all datesâ€™ Ids with higher temperature compared to its previous (yesterdayâ€™s) dates.</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+---------+</span>------------<span class="code">+------------------+</span></span><br><span class="line">| Id(INT) | Date(DATE) | Temperature(INT) |</span><br><span class="line"><span class="code">+---------+</span>------------<span class="code">+------------------+</span></span><br><span class="line">|       1 | 2015-01-01 |               10 |</span><br><span class="line">|       2 | 2015-01-02 |               25 |</span><br><span class="line">|       3 | 2015-01-03 |               20 |</span><br><span class="line">|       4 | 2015-01-04 |               30 |</span><br><span class="line"><span class="code">+---------+</span>------------<span class="code">+------------------+</span></span><br></pre></td></tr></table></figure>
<p>For example, return the following Ids for the above Weather table:</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----+</span></span><br><span class="line">| Id |</span><br><span class="line"><span class="code">+----+</span></span><br><span class="line">|  2 |</span><br><span class="line">|  4 |</span><br><span class="line"><span class="code">+----+</span></span><br></pre></td></tr></table></figure>
<h4 id="SQL__3A-7"><a href="#SQL__3A-7" class="headerlink" title="SQL :"></a>SQL :</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.Id </span><br><span class="line"><span class="keyword">FROM</span> Weather <span class="keyword">AS</span> a </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (</span><br><span class="line"><span class="keyword">SELECT</span> b.Temperature </span><br><span class="line"><span class="keyword">FROM</span> Weather <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">WHERE</span> b.Date = <span class="keyword">SUBDATE</span>(a.Date,<span class="number">1</span>) <span class="keyword">and</span> b.Temperature &lt; a.Temperature);</span><br></pre></td></tr></table></figure>
<h4 id="Comment__3A-7"><a href="#Comment__3A-7" class="headerlink" title="Comment :"></a>Comment :</h4><p>æ­¤é¢˜åˆæ˜¯çœ‹èµ·æ¥ç®€å•çš„ä¸èƒ½å†ç®€å•äº†ã€‚ç„¶è€Œå‘å°±åœ¨ Date ç±»å‹çš„æ•°æ®æ“ä½œä¸Šï¼Œç¬¬ä¸€ï¼Œå‡ ä¹å°‘æœ‰äººåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ç”¨ Date è¿™ç§ä¸é è°±çš„æ•°æ®æ ¼å¼ï¼Œæˆ‘è¿˜æ²¡è§è¿‡è°ç”Ÿäº§ç¯å¢ƒä¸ç”¨æ—¶é—´æˆ³çš„ = =ï¼Œç¬¬äºŒï¼Œè¿™ä¸ªå‘è°çŸ¥é“å•Šâ€¦â€¦ Date æä¾›äº†åŠ å‡çš„æ“ä½œï¼Œçœ‹èµ·æ¥ä½ å¥½åƒå¯ä»¥ç›´æ¥ update ä¸€ä¸ª date + 1 ç­‰äºç¬¬äºŒå¤©çš„æ—¥æœŸï¼Œç„¶è€Œç¢°åˆ°æœˆä»½çš„è¾¹ç•Œè¿™ä¸ªåŠ å‡å°±æŒ‚äº†å•Šï¼ˆé»‘äººé—®å·.jpgï¼‰ ç¢°åˆ° 01-01ï¼Œå‡ 1 ä¹‹åç­‰äº 01-00ï¼Œå› æ­¤å…¶å® SQL æ˜¯æœ‰æ—¥æœŸæ“ä½œ<strong>å‡½æ•°</strong>çš„ï¼Œ SUBDATE(DATE, INTERVAL) å°±å¯ä»¥å®ç°ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å¶ç„¶è¢« Cee é…±å¸å¼•æ‰“å¼€äº† Leetcodeï¼Œè¿™ä¸ªå¤§ä¸€çš„æ—¶å€™è§‰å¾—è‡ªå·±ä¸€è¾ˆå­éƒ½ä¸ä¼šå»åšçš„äº‹æƒ…â€¦â€¦å±…ç„¶ã€‚å‘ç° OJ ç«Ÿç„¶æœ‰ Database æ¨¡å—äº†ï¼Œæƒ³å½“å¹´å¤§å­¦å­¦æ•°æ®åº“çš„æ—¶å€™æœ€]]>
    </summary>
    
      <category term="Leetcode" scheme="http://sergiochan.github.io/tags/Leetcode/"/>
    
      <category term="MySQL" scheme="http://sergiochan.github.io/tags/MySQL/"/>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä½¿ç”¨ Photon åœ¨ Unity é‡Œå¿«é€Ÿæ­å»ºä¸€ä¸ªå¤šäººè”æœºæ¸¸æˆ]]></title>
    <link href="http://sergiochan.github.io/2016/08/18/%E4%BD%BF%E7%94%A8-Photon-%E5%9C%A8-Unity-%E9%87%8C%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A4%9A%E4%BA%BA%E8%81%94%E6%9C%BA%E6%B8%B8%E6%88%8F/"/>
    <id>http://sergiochan.github.io/2016/08/18/ä½¿ç”¨-Photon-åœ¨-Unity-é‡Œå¿«é€Ÿæ­å»ºä¸€ä¸ªå¤šäººè”æœºæ¸¸æˆ/</id>
    <published>2016-08-18T08:17:02.000Z</published>
    <updated>2016-08-24T15:39:42.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å¦‚ä½•æœ€å¿«çš„æ­å»ºä¸€ä¸ª Unity ä¸Šçš„å¤šäººæ¸¸æˆï¼Ÿç­”æ¡ˆä¹Ÿè®¸æ˜¯è‡ªå·±æ­å»ºä¸€ä¸ªæ¸¸æˆæœåŠ¡å™¨ï¼Œä¹Ÿè®¸æ˜¯ LAN è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æœ€å¿«çš„è§£å†³æ–¹æ¡ˆè¿˜æ˜¯ä½¿ç”¨æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åç«¯æœåŠ¡ï¼Œæˆ‘æ‰¾åˆ°äº† <a href="https://www.photonengine.com/en-US/Photon" target="_blank" rel="external">Photon</a>ï¼Œä¸€ä¸ªçœ‹èµ·æ¥ä¸é”™æœ€åè¯å®ä¹ŸæŒºé è°±çš„æ¸¸æˆåç«¯è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä¸€ä¸ªæ¸¸æˆæœåŠ¡å™¨ï¼Œæœ€ä¸»è¦çš„å°±æ˜¯å¯¹ä¸åŒå‚ä¸è€…çš„äº‹ä»¶åŒæ­¥å’Œä¸–ç•ŒçŠ¶æ€çš„åŒæ­¥ï¼Œæ‰€ä»¥æ ¹æœ¬è¿˜æ˜¯åœ¨äºå’ŒæœåŠ¡å™¨çš„é•¿è¿æ¥ä¸Šï¼Œè‡³äºæ¸¸æˆä¸­çš„ç”¨æˆ·ä½“ç³»ï¼Œç§¯åˆ†ä½“ç³»ï¼Œè´§å¸ä½“ç³»è¿™äº›ï¼Œå°±æ˜¯å±äºå¤§åç«¯çš„èŒƒç•´äº†ï¼Œä¹Ÿæ˜¯å¯ä»¥ç‹¬ç«‹äºæ¸¸æˆåŒæ­¥æœåŠ¡å™¨å­˜åœ¨çš„ç³»ç»Ÿã€‚</p>
<h3 id="u5B89_u88C5"><a href="#u5B89_u88C5" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>é¦–å…ˆä½ éœ€è¦é›†æˆ <strong>Photon SDK For Unity</strong>ï¼Œä¸‹è½½åœ°å€åœ¨<a href="https://www.photonengine.com/en-US/Realtime/Download" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<p><img src="/image/photon_1.png" alt="å›¾1"> </p>
<p>ä½ éœ€è¦å°†ä¸‹è½½ä¸‹æ¥çš„ <code>PhotoAssets</code> ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½æ‹–åˆ°ä½ çš„é¡¹ç›®çš„ <code>Assets</code> æ–‡ä»¶å¤¹é‡Œé¢ï¼Œæ³¨æ„åœ¨ <code>Plugins</code> é‡Œé¢æœ‰ä¸¤ä¸ª <code>Photon3Unity3D.dll</code>ï¼Œéœ€è¦å°† <code>Metro</code> æ–‡ä»¶å¤¹åˆ æ‰ï¼Œä¿ç•™ä¸€ä¸ªï¼Œå¦åˆ™åœ¨ Unity ç¼–è¯‘çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚</p>
<p>æ‹–è¿›å»ä¹‹ååªè¦ Unity ä¸­ Compile æ²¡æœ‰é—®é¢˜é‚£ç¬¬ä¸€æ­¥å°±å¤§åŠŸå‘Šæˆäº†ã€‚</p>
<h3 id="u811A_u672C_u521B_u5EFA"><a href="#u811A_u672C_u521B_u5EFA" class="headerlink" title="è„šæœ¬åˆ›å»º"></a>è„šæœ¬åˆ›å»º</h3><p>åˆ›å»ºä¸€ä¸ªä½ ç”¨æ¥ç»´æŠ¤æ¸¸æˆç½‘ç»œé€»è¾‘çš„è„šæœ¬ï¼Œä¾‹å¦‚å‘½åä¸º <code>GameNetworkClient.cs</code>ï¼Œç„¶åä½ éœ€è¦åœ¨å¤´éƒ¨åŠ ä¸Šè¿™å‡ ä¸ªå¼•ç”¨ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span>Â System.Collections;</span><br><span class="line"><span class="keyword">using</span>Â ExitGames.<span class="built_in">Client</span>.Photon;</span><br><span class="line"><span class="keyword">using</span>Â ExitGames.<span class="built_in">Client</span>.Photon.LoadBalancing;</span><br><span class="line"><span class="keyword">using</span>Â System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span>Â UnityEngine;</span><br><span class="line"><span class="keyword">using</span>Â HashtableÂ =Â ExitGames.<span class="built_in">Client</span>.Photon.Hashtable;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€å£°æ˜ä¸€ä¸ªç§æœ‰çš„ <code>LoadBalancingClient</code>å¯¹è±¡ï¼Œä½ çš„è„šæœ¬ä¸­çš„æ‰€æœ‰ç½‘ç»œé€»è¾‘éƒ½ä¼šé€šè¿‡è¿™ä¸ª <code>client</code> å¯¹è±¡æ¥å‘èµ·å’Œå›è°ƒã€‚æˆ‘ä»¬è¿™æ ·åœ¨ Start ä¸­åˆå§‹åŒ– <code>client</code> å¯¹è±¡ï¼š</p>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line"><span class="keyword">client</span> = <span class="keyword">new</span> LoadBalancingClient();</span><br><span class="line"><span class="keyword">client</span>.AppId = <span class="string">"&#123;ä½ çš„ App_id&#125;"</span>;  </span><br><span class="line"><span class="keyword">client</span>.OnStateChangeAction += <span class="keyword">this</span>.OnStateChanged;</span><br><span class="line"><span class="keyword">client</span>.OnOpResponseAction += <span class="keyword">this</span>.OnRespAction;</span><br><span class="line"><span class="keyword">client</span>.OnEventAction += <span class="keyword">this</span>.OnEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">client</span>.ConnectToRegionMaster(<span class="string">"asia"</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä½ çš„ App_id å¯ä»¥åœ¨ Photon å®˜ç½‘æ³¨å†Œå®Œå…è´¹è´¦æˆ·ååœ¨è´¦æˆ·è¯¦æƒ…é¡µè·å–ï¼Œå…è´¹çš„è´¦æˆ·æ‹¥æœ‰ <strong>20</strong> ä¸ªåŒæ—¶åœ¨çº¿äººæ•°çš„é™é¢ï¼Œå¯¹äºå°èŒƒå›´å¥½å‹é—´çš„æ¸¸æˆå’Œæµ‹è¯•è¶³å¤Ÿäº†ã€‚</p>
</blockquote>
<p>å…¶ä¸­ï¼Œæœ€åä¸€è¡Œä»£ç å°±æ˜¯ <code>client</code> å»è¿æ¥ MasterServer çš„æ–¹æ³•ï¼Œè¿™é‡Œé¢ä¼ å…¥çš„å‚æ•°è¦æ ¹æ®ä½ çš„æ¸¸æˆæ‰€åœ¨åœ°åŒºæ¥ç¡®å®šï¼Œ Photon åœ¨å…¨çƒæœ‰å¾ˆå¤šåˆ†æ•£çš„æ•°æ®ä¸­å¿ƒï¼Œå› æ­¤æ”¯æŒå¾ˆå¤šåŒºåŸŸçš„è¿æ¥ï¼Œå…·ä½“æ”¯æŒçš„åœ°åŒºå’Œä»£ç å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Hosted in</th>
<th>Token</th>
</tr>
</thead>
<tbody>
<tr>
<td>Asia</td>
<td>Singapore</td>
<td>asia</td>
</tr>
<tr>
<td>Australia</td>
<td>Melbourne</td>
<td>au</td>
</tr>
<tr>
<td>Canada, East</td>
<td>Montreal</td>
<td>cae</td>
</tr>
<tr>
<td>Europe</td>
<td>Amsterdam</td>
<td>eu</td>
</tr>
<tr>
<td>Japan</td>
<td>Tokyo</td>
<td>jp</td>
</tr>
<tr>
<td>South America</td>
<td>Sao Paulo</td>
<td>sa</td>
</tr>
<tr>
<td>USA, East</td>
<td>Washington</td>
<td>us</td>
</tr>
<tr>
<td>USA, West</td>
<td>San JosÃ©</td>
<td>usw</td>
</tr>
</tbody>
</table>
<p>æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘æ”¹æˆäº† <code>asia</code>ï¼Œäº‹å®è¯æ˜æ–°åŠ å¡çš„æœåŠ¡å™¨æ˜¯æ¯”è¾ƒç¨³å®šçš„ã€‚</p>
<h3 id="u72B6_u6001_u7EF4_u62A4"><a href="#u72B6_u6001_u7EF4_u62A4" class="headerlink" title="çŠ¶æ€ç»´æŠ¤"></a>çŠ¶æ€ç»´æŠ¤</h3><p><code>client</code> çš„çŠ¶æ€ä¸»è¦å°±æ˜¯æ ¹æ®ä¸Šé¢åˆå§‹åŒ–çš„æ—¶å€™ç»™çš„ä¸‰ä¸ª Action æ¥ç»´æŠ¤çš„ï¼Œä½ éœ€è¦åœ¨ä½ çš„è„šæœ¬é‡Œä¸ºè¿™ä¸‰ä¸ª Action éƒ½åŠ ä¸Šä½ è‡ªå·±çš„ Handlerã€‚å½“ç„¶ï¼Œå¦‚æœä½ æƒ³æŒ‰ç…§ä»–çš„ demo é‡Œç¤ºèŒƒçš„é‚£æ ·å»ç»§æ‰¿ <code>client</code> å¹¶ä¸” override è¿™ä¸‰ä¸ª Action çš„å›è°ƒéƒ½æ˜¯å¯ä»¥çš„ã€‚</p>
<h4 id="OnStateChanged"><a href="#OnStateChanged" class="headerlink" title="OnStateChanged"></a>OnStateChanged</h4><p>è¿”å›çš„æ˜¯ä¸€ä¸ª <code>ClientState</code> æšä¸¾å€¼ï¼Œä¸»è¦å°±æ˜¯ä¸€äº› client çŠ¶æ€çš„å€¼ï¼Œä¾‹å¦‚</p>
<p> <code>connecting</code>ï¼Œ<code>connected</code>ï¼Œ<code>joining</code>ä¹‹ç±»çš„ã€‚</p>
<h4 id="OnRespAction"><a href="#OnRespAction" class="headerlink" title="OnRespAction"></a>OnRespAction</h4><p>è¿”å›çš„æ˜¯ä¸€ä¸ª <code>OperationResponse</code> å¯¹è±¡ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡ä½ ç”¨ <code>client</code> å¯¹è±¡è°ƒç”¨ä¸€äº›æ–¹æ³•å¹¶ä¸”è·å¾— response ä¹‹åè°ƒç”¨ï¼Œåˆ†åˆ«æœ‰ä¸‹é¢è¿™äº›ç±»å‹çš„ Operation:</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationCode</span> &#123;</span><br><span class="line">        [<span class="meta">Obsolete(<span class="meta-string">"Exchanging encrpytion keys is done internally in the lib now. Don't expect this operation-result."</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> ExchangeKeysForEncryption = <span class="number">250</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(255) Code for OpJoin, to get into a room.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Join = <span class="number">255</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(230) Authenticates this peer and connects to a virtual application<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Authenticate = <span class="number">230</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(229) Joins lobby (on master)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> JoinLobby = <span class="number">229</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(228) Leaves lobby (on master)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> LeaveLobby = <span class="number">228</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(227) Creates a game (or fails if name exists)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> CreateGame = <span class="number">227</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(226) Join game (by name)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> JoinGame = <span class="number">226</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(225) Joins random game (on master)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> JoinRandomGame = <span class="number">225</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// public const byte CancelJoinRandom = 224; // obsolete, cause JoinRandom no longer is a "process". now provides result immediately</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(254) Code for OpLeave, to get out of a room.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Leave = (<span class="keyword">byte</span>)<span class="number">254</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(253) Raise event (in a room, for other actors/players)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> RaiseEvent = (<span class="keyword">byte</span>)<span class="number">253</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(252) Set Properties (of room or actor/player)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> SetProperties = (<span class="keyword">byte</span>)<span class="number">252</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(251) Get Properties<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> GetProperties = (<span class="keyword">byte</span>)<span class="number">251</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(248) Operation code to change interest groups in Rooms (Lite application and extending ones).<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> ChangeGroups = (<span class="keyword">byte</span>)<span class="number">248</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(222) Request the rooms and online status for a list of friends (by name, which should be unique).<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> FindFriends = <span class="number">222</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(221) Request statistics about a specific list of lobbies (their user and game count).<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> GetLobbyStats = <span class="number">221</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(220) Get list of regional servers from a NameServer.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> GetRegions = <span class="number">220</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(219) WebRpc Operation.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> WebRpc = <span class="number">219</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¾‹å¦‚ <code>rasieEvent</code>ï¼Œ<code>setProperties</code> æˆ–è€…åŠ å…¥ç¦»å¼€æ¸¸æˆè¿™äº›è¯·æ±‚éƒ½æ˜¯ä¼šæœ‰æœåŠ¡å™¨çš„ response çš„ï¼Œä½ å¯ä»¥æ ¹æ®è¿”å›å¯¹è±¡çš„ <code>ReturnCode</code> æ¥åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸå¹¶ä¸”æ˜¯å¦æ‰§è¡Œä¸€äº›é”™è¯¯åçš„å¤„ç†ï¼Œ<code>ReturnCode</code> ä¸º 0 æˆåŠŸï¼Œä¸ä¸º 0 åˆ™å¤±è´¥ï¼Œå¦‚æœéœ€è¦ä¹Ÿå¯ä»¥ä» <code>DebugMessage</code> ä¸­è·å–é”™è¯¯æç¤ºä¿¡æ¯ã€‚</p>
<h4 id="OnEventAction"><a href="#OnEventAction" class="headerlink" title="OnEventAction"></a><strong>OnEventAction</strong></h4><p>è¿”å›çš„æ˜¯ä¸€ä¸ª <code>EventData</code> å¯¹è±¡ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡ <code>client</code> æ¥æ”¶åˆ°æ–°çš„ Event çš„æ—¶å€™è°ƒç”¨ï¼Œå…·ä½“çš„ Event ç±»å‹æ ¹æ®<code>EventData</code> çš„ <code>EventCode</code> æ¥ç¡®å®šï¼Œåˆ†åˆ«æœ‰ä¸‹é¢è¿™äº›ç±»å‹çš„ <code>EventCode</code>:</p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventCode</span> &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(230) Initial list of RoomInfos (in lobby on Master)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> GameList = <span class="number">230</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(229) Update of RoomInfos to be merged into "initial" list (in lobby on Master)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> GameListUpdate = <span class="number">229</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(228) Currently not used. State of queueing in case of server-full<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> QueueState = <span class="number">228</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(227) Currently not used. Event for matchmaking<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Match = <span class="number">227</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(226) Event with stats about this application (players, rooms, etc)<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> AppStats = <span class="number">226</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(224) This event provides a list of lobbies with their player and game counts.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> LobbyStats = <span class="number">224</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(210) Internally used in case of hosting by Azure<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">Obsolete(<span class="meta-string">"TCP routing was removed after becoming obsolete."</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> AzureNodeInfo = <span class="number">210</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(255) Event Join: someone joined the game. The new actorNumber is provided as well as the properties of that actor (if set in OpJoin).<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Join = (<span class="keyword">byte</span>)<span class="number">255</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(254) Event Leave: The player who left the game can be identified by the actorNumber.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> Leave = (<span class="keyword">byte</span>)<span class="number">254</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(253) When you call OpSetProperties with the broadcast option "on", this event is fired. It contains the properties being set.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> PropertiesChanged = (<span class="keyword">byte</span>)<span class="number">253</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(253) When you call OpSetProperties with the broadcast option "on", this event is fired. It contains the properties being set.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">Obsolete(<span class="meta-string">"Use PropertiesChanged now."</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> SetProperties = (<span class="keyword">byte</span>)<span class="number">253</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(252) When player left game unexpected and the room has a playerTtl &gt; 0, this event is fired to let everyone know about the timeout.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Obsolete. Replaced by Leave. public const byte Disconnect = LiteEventCode.Disconnect;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(251) Sent by Photon Cloud when a plugin-call or webhook-call failed. Usually, the execution on the server continues, despite the issue. Contains: ParameterCode.Info.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;seealso cref="https://doc.photonengine.com/en/realtime/current/reference/webhooks"/&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> ErrorInfo = <span class="number">251</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>(250) Sent by Photon whent he event cache slice was changed. Done by OpRaiseEvent.<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keyword">byte</span> CacheSliceChanged = <span class="number">250</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>EventCode</code> ä½ æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰çš„ï¼Œè¿™ä¸ª code æ˜¯ä¸ª <strong>byte ç±»å‹çš„æ•´æ•°</strong>ï¼Œå› æ­¤ä¸èƒ½å¤§äº255ï¼ŒPhoton å°†ä» 0 å¼€å§‹çš„ä¸€å¤§æ®µå€¼åŸŸéƒ½ç•™ç»™å¼€å‘è€…ç”¨æ¥è‡ªå®šä¹‰äº‹ä»¶äº†ã€‚Photon é»˜è®¤æä¾›äº† <code>GameList</code>ï¼Œæˆ–è€…è¯´ RoomList çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥åˆ›å»º <code>Room</code> å¹¶ä¸”åŠ å…¥ï¼Œ<code>Room</code> ä¹Ÿæœ‰ä»–è‡ªå·±çš„ Optionï¼Œå¯ä»¥ä½œä¸º Lobbyï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰äººé»˜è®¤è¿›å…¥çš„ <code>Room</code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®å„ç§æ¡ä»¶æ¥æŸ¥æ‰¾ <code>Room</code>ã€‚</p>
<p>è¿™é‡Œçš„ <strong>253 PropertiesChanged</strong> æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ Eventï¼Œåœ¨ä¸Šé¢æˆ‘æåˆ°è¿‡ï¼Œè”æœºæ¸¸æˆçš„åç«¯æœ€é‡è¦çš„éƒ¨åˆ†ä¹‹ä¸€å°±æ˜¯ä¸–ç•ŒçŠ¶æ€çš„åŒæ­¥ï¼Œåœ¨è¿™é‡Œä¹Ÿå°±æ˜¯<strong>æˆ¿é—´çš„çŠ¶æ€ Room Properties</strong>ï¼Œå› æ­¤åœ¨ Photon SDK ä¸­ï¼Œå½“ä½ è°ƒç”¨ <code>client</code> å¯¹å½“å‰åŠ å…¥çš„ <code>Room</code> çš„æŸä¸ªå±æ€§åšå‡ºäº†æ”¹å˜ï¼Œè¿™å°±ä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶é€šçŸ¥åˆ°æ•´ä¸ª <code>Room</code> é‡Œçš„æ‰€æœ‰ç©å®¶ï¼Œè¿™é€šå¸¸ç”¨æ¥åŒæ­¥ä¸€äº›å…¨å±€çš„å±æ€§ï¼Œä¾‹å¦‚å…‰çº¿ï¼Œåœ°å½¢ï¼Œæ€ªç‰©çš„è¡€é‡ä¹‹ç±»çš„ã€‚</p>
<p>å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥è‡ªå®šä¹‰ Eventï¼Œåœ¨æˆ‘å®ç°çš„ demo ä¸­æˆ‘å°±æ˜¯ç”¨åˆ°äº†è‡ªå®šä¹‰ Event æ¥å‘ŠçŸ¥å…¶ä»–ç©å®¶æˆ‘çš„çŠ¶æ€ã€‚æ¯”å¦‚ï¼Œæ•´ä¸ªåœ°å›¾ ï¼ˆå¯ä»¥çœ‹åšå°±æ˜¯ä¸€ä¸ª <code>Room</code>ï¼‰ä¸­çš„ç©å®¶åˆ—è¡¨å’Œä½ç½®æ˜¯å¯ä»¥ç”¨å…¨å±€çŠ¶æ€æ¥åŒæ­¥çš„ï¼Œä½†æ˜¯ä¾‹å¦‚å•ä¸ªç©å®¶çš„ä¸€äº›äº‹ä»¶ï¼ˆä½¿ç”¨ç‰©å“ï¼Œä½¿ç”¨æŠ€èƒ½ä¹‹ç±»çš„ï¼‰å¯èƒ½å°±éœ€è¦ç”±å‘èµ·çš„ç”¨æˆ·å‘å…¨ <code>Room</code> çš„å…¶ä»–ç©å®¶å‘é€ä¸€ä¸ªåŒæ­¥äº‹ä»¶ã€‚</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">byte </span>eventCode = <span class="number">1</span><span class="comment">; </span></span><br><span class="line">Hashtable evData = new Hashtable ()<span class="comment">; </span></span><br><span class="line">evData.<span class="keyword">Add </span>(<span class="string">"player_id"</span>, random_playerid)<span class="comment">;</span></span><br><span class="line">evData.<span class="keyword">Add </span>(<span class="string">"pos_x"</span>, position.x)<span class="comment">;</span></span><br><span class="line">evData.<span class="keyword">Add </span>(<span class="string">"pos_y"</span>, position.y)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">bool </span>sendReliable = true<span class="comment">; </span></span><br><span class="line">if (isConnected) &#123;</span><br><span class="line">	client.OpRaiseEvent (eventCode, evData, sendReliable, RaiseEventOptions.Default)<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç„¶åè¿™ä¸ªäº‹ä»¶å°±ä¼šåœ¨é™¤äº†å‘é€è€…è‡ªå·±çš„å…¶ä»–ç©å®¶çš„å®¢æˆ·ç«¯è¢«å›è°ƒã€‚</p>
</blockquote>
<p><strong>è¿™ä¸ªæ—¶å€™æ”¶åˆ°çš„æ•°æ®åŒ…æ€ä¹ˆè§£å‡ºæ¥å‘¢ï¼Ÿ</strong></p>
<p>æœ€åå†è¯´è¯´å‘äº†æˆ‘åŠå¤©çš„ <code>EventData</code> ä¸­çš„æ•°æ®æŠ½å–ï¼Œåœ¨ <code>EventData</code> ä¸­çš„æ•°æ®æ ¼å¼ååˆ†è›‹ç–¼ï¼Œä¾‹å¦‚ä¸Šé¢è¿™æ®µä»£ç é‡Œå‘é€çš„æ•°æ®ï¼Œå½“ä½ åœ¨å…¶ä»–å®¢æˆ·ç«¯æ”¶åˆ°çš„æ—¶å€™ï¼Œå®ƒçš„æ•°æ®å…¶å®æ˜¯å­˜åœ¨ <code>EventData</code> çš„ <code>Parameters</code> è¿™ä¸ªå±æ€§å˜é‡é‡Œé¢ï¼Œè¿™æ˜¯ä¸€ä¸ª <code>Dictionary&lt;byte,object&gt;</code> ç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡ <code>ParameterCode.Data</code> è¿™ä¸ª key å°† data å–å‡ºæ¥ä¹‹åï¼Œé‡Œé¢æ‰æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ Hashtable ï¼Œç„¶è€Œç°åœ¨å·²ç»å˜æˆäº†ä¸€ä¸ª <code>Dictionary&lt;object,object&gt;</code> å¯¹è±¡äº†ã€‚åœ¨æ²¡æœ‰ä»”ç»†æŸ¥çœ‹æºç çš„æƒ…å†µä¸‹ï¼Œå®ƒçš„å®˜æ–¹ demo å’Œæ–‡æ¡£å¹¶æ²¡æœ‰æåŠå¦‚ä½•è§£åŒ… <code>EventData</code> ,å› æ­¤æˆ‘æ˜¯é€šè¿‡ Debug çš„æ–¹å¼æ‰æœ€ç»ˆæ‘¸æ¸…äº†é‡Œé¢çš„æ•°æ®æ ¼å¼ã€‚å½“ç„¶åæ¥åˆçœ‹äº†ä¸‹å®ƒçš„å¤´æ–‡ä»¶ï¼Œæ‰çœ‹åˆ° <code>ParameterCode.Data</code> ğŸ˜‚ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å¦‚ä½•æœ€å¿«çš„æ­å»ºä¸€ä¸ª Unity ä¸Šçš„å¤šäººæ¸¸æˆï¼Ÿç­”æ¡ˆä¹Ÿè®¸æ˜¯è‡ªå·±æ­å»ºä¸€ä¸ªæ¸¸æˆæœåŠ¡å™¨ï¼Œä¹Ÿè®¸æ˜¯ LAN è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æœ€å¿«çš„è§£å†³æ–¹æ¡ˆè¿˜æ˜¯ä½¿ç”¨æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åç«¯æœåŠ¡ï¼Œæˆ‘æ‰¾åˆ°äº† <a hr]]>
    </summary>
    
      <category term="Photon" scheme="http://sergiochan.github.io/tags/Photon/"/>
    
      <category term="Unity" scheme="http://sergiochan.github.io/tags/Unity/"/>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[AVAudioPlayerçš„å‡ ä¸ªç»†èŠ‚]]></title>
    <link href="http://sergiochan.github.io/2016/08/13/AVAudioPlayer%E7%9A%84%E5%87%A0%E4%B8%AA%E7%BB%86%E8%8A%82/"/>
    <id>http://sergiochan.github.io/2016/08/13/AVAudioPlayerçš„å‡ ä¸ªç»†èŠ‚/</id>
    <published>2016-08-13T01:24:52.000Z</published>
    <updated>2016-08-13T01:25:39.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©åœ¨åš iOS ä¸Šçš„å£°æ³¢ä¼ è¾“çš„æ—¶å€™ï¼Œå€’æ˜¯é‡åˆ°äº†å‡ ä¸ªå’Œ  AVAudioPlayer æœ‰å…³çš„æœ‰è¶£é—®é¢˜ï¼Œè¿™ç§é—®é¢˜ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ³¨æ„ä¸åˆ°ï¼Œåªè¦è¸©è¿‡äº†æ‰çŸ¥é“ã€‚</p>
<h3 id="u5173_u4E8E_PCM_Data"><a href="#u5173_u4E8E_PCM_Data" class="headerlink" title="å…³äº PCM Data"></a>å…³äº PCM Data</h3><p><code>AVAudioPlayer</code> æœ‰ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³• <code>initWithData:error:</code>ï¼Œè¿™ä¸ªæ–¹æ³•çš„ API è¯´æ˜æ˜¯</p>
<blockquote>
<p>/<em> all data must be in the form of an audio file understood by CoreAudio </em>/</p>
</blockquote>
<p>åœ¨è‹¹æœçš„æ–‡æ¡£é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ° AVAudioPlayerå¹¶ä¸èƒ½æ”¯æŒ Stream æ’­æ”¾ï¼Œå®ƒæ”¯æŒçš„æ–‡ä»¶æ ¼å¼æœ‰ä¸‹é¢è¿™äº›ï¼š</p>
<table>
<thead>
<tr>
<th>Format name</th>
<th>Format filename extensions</th>
</tr>
</thead>
<tbody>
<tr>
<td>AIFF</td>
<td><code>.aif</code>, <code>.aiff</code></td>
</tr>
<tr>
<td>CAF</td>
<td><code>.caf</code></td>
</tr>
<tr>
<td>MPEG-1, layer 3</td>
<td><code>.mp3</code></td>
</tr>
<tr>
<td>MPEG-2 or MPEG-4 ADTS</td>
<td><code>.aac</code></td>
</tr>
<tr>
<td>MPEG-4</td>
<td><code>.m4a</code>, <code>.mp4</code></td>
</tr>
<tr>
<td>WAV</td>
<td><code>.wav</code></td>
</tr>
</tbody>
</table>
<p>Stream ç±»å‹çš„éŸ³ä¹æµåªèƒ½è¢« AudioQueue æˆ–è€… AudioUnit æ”¯æŒã€‚å› æ­¤è¦ç”¨ <code>AVAudioPlayer</code> æ¥æ’­æ”¾ PCM æ•°æ®çš„è¯ï¼Œæ³¨æ„è¦ä¸ºè¿™ä¸ª PCM åŒ…åŠ ä¸Š WAV çš„ HEADERï¼Œç„¶åå°†å®Œæ•´çš„ NSData ä¼ ç»™å®ƒã€‚</p>
<h3 id="u5173_u4E8E_Play"><a href="#u5173_u4E8E_Play" class="headerlink" title="å…³äº Play"></a>å…³äº Play</h3><p><code>AVAudioPlayer</code> è¿˜æœ‰ä¸ªæœ‰è¶£çš„ç°è±¡ï¼Œæˆ‘æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°å®˜æ–¹æ–‡æ¡£çš„è¯æ®ï¼Œé‚£å°±æ˜¯å®ƒçš„ <code>play</code> ä¸ä¼šå¯¹è‡ªèº«æœ‰ä¸€ä¸ªå¼•ç”¨æ¥ä¿æŒè‡ªå·±æ˜¯æ´»ç€çš„ã€‚<strong>åªè¦å®ƒçš„çˆ¶ç±»ä¹‹ä¸Šæœ‰ä¸€ä¸ªå¯¹è±¡è¢«é‡Šæ”¾äº†ï¼Œé‚£å®ƒä¹Ÿå°±è¢«ä¸€èµ·é‡Šæ”¾æ‰äº†</strong>ã€‚å› æ­¤æ— è®ºä½ æ˜¯åœ¨ç¬¬ä¸€å±‚ç›´æ¥å£°æ˜ self.audioPlayer play è¿˜æ˜¯ self.A.audioPlayer.play ï¼Œå®ƒçš„æœ€ä¸Šå±‚çˆ¶ç±»å¿…é¡»æœ‰ä¸€ä¸ªå’Œ VC ç›¸å…³æˆ–è€…å…¨å±€ç›¸å…³çš„å¼ºå¼•ç”¨ï¼Œå¦åˆ™å°±ä¼šåœ¨ play çš„æ—¶å€™å°±å·²ç»è¢«é‡Šæ”¾æ‰äº†ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©åœ¨åš iOS ä¸Šçš„å£°æ³¢ä¼ è¾“çš„æ—¶å€™ï¼Œå€’æ˜¯é‡åˆ°äº†å‡ ä¸ªå’Œ  AVAudioPlayer æœ‰å…³çš„æœ‰è¶£é—®é¢˜ï¼Œè¿™ç§é—®é¢˜ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ³¨æ„ä¸åˆ°ï¼Œåªè¦è¸©è¿‡äº†æ‰çŸ¥é“ã€‚</p>
<h3 i]]>
    </summary>
    
      <category term="AVAudioPlayer" scheme="http://sergiochan.github.io/tags/AVAudioPlayer/"/>
    
      <category term="AVFoundation" scheme="http://sergiochan.github.io/tags/AVFoundation/"/>
    
      <category term="iOSèœé¸Ÿå¿ƒå¾—" scheme="http://sergiochan.github.io/categories/iOS%E8%8F%9C%E9%B8%9F%E5%BF%83%E5%BE%97/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æˆ‘çš„ GayHub - 2016]]></title>
    <link href="http://sergiochan.github.io/2016/07/14/%E6%88%91%E7%9A%84-GayHub-2016/"/>
    <id>http://sergiochan.github.io/2016/07/14/æˆ‘çš„-GayHub-2016/</id>
    <published>2016-07-14T11:05:27.000Z</published>
    <updated>2016-07-14T11:08:08.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>As the number of my repos keeps increasing, I have to create this new repo in order to create some kinds of <strong>index</strong> for all the repos that I have written.</p>
</blockquote>
<p><img src="/image/2016-gayhub.png" alt=""></p>
<h1 id="Get_to_know_me"><a href="#Get_to_know_me" class="headerlink" title="Get to know me"></a>Get to know me</h1><p>Sergio Chan, Born Hacker, Currently works at <em>RavenTech. Inc</em> as a Researcher and Hacker</p>
<p><a href="http://sergiochan.xyz" target="_blank" rel="external">My blog</a>  |  <a href="https://cn.linkedin.com/pub/sergio-chan/42/14b/a6" target="_blank" rel="external">Linkedin</a> | <a href="http://weibo.com/3089081773/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">Weibo</a> </p>
<h1 id="Below__08is_the_list_of_most_of_my_repos"><a href="#Below__08is_the_list_of_most_of_my_repos" class="headerlink" title="Below is the list of most of my repos"></a>Below is the list of most of my repos</h1><blockquote>
<p>ä¸‹é¢æ˜¯æˆ‘å¤§éƒ¨åˆ†çš„ä¸ªäººä»“åº“çš„åˆ†ç±»åˆ—è¡¨</p>
</blockquote>
<h3 id="Algorithm_Test__u7B97_u6CD5_u6D4B_u8BD5_u5B9E_u73B0_u7C7B"><a href="#Algorithm_Test__u7B97_u6CD5_u6D4B_u8BD5_u5B9E_u73B0_u7C7B" class="headerlink" title="Algorithm Test ç®—æ³•æµ‹è¯•å®ç°ç±»"></a>Algorithm Test ç®—æ³•æµ‹è¯•å®ç°ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/Monty-Hall-Problem-Swift" target="_blank" rel="external">Monty-Hall-Problem</a> ä¸‰é—¨é—®é¢˜çš„SwiftéªŒè¯æ¼”ç¤ºPlayground</li>
<li><a href="https://github.com/SergioChan/LinkedListSwift" target="_blank" rel="external">LinkedListSwift</a> Swiftå†™çš„é“¾è¡¨å®ç°å’Œå„ç§åŸºæœ¬æ“ä½œ</li>
<li><a href="https://github.com/SergioChan/SCPythonSudoku" target="_blank" rel="external">SCPythonSudoku</a> A Python Sudoku solved program. Pythonå†™çš„æ·±åº¦ä¼˜å…ˆæœç´¢è§£æ•°ç‹¬ç¨‹åº</li>
</ul>
<h3 id="Kit_or_Framework_for_iOS__u5B9E_u7528_u63A7_u4EF6_u7C7B"><a href="#Kit_or_Framework_for_iOS__u5B9E_u7528_u63A7_u4EF6_u7C7B" class="headerlink" title="Kit or Framework for iOS å®ç”¨æ§ä»¶ç±»"></a>Kit or Framework for iOS å®ç”¨æ§ä»¶ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/SCBlueToothKit" target="_blank" rel="external">SCBlueToothKit</a> Blue Tooth Kit based on Core BlueTooth brings you to fly dealing with Blue Tooth development</li>
<li><a href="https://github.com/SergioChan/SCAwesomeNetworking" target="_blank" rel="external">SCAwesomeNetworking</a> An optimized networking framework based on AFNetworking and ProtoBuffer</li>
<li><a href="https://github.com/SergioChan/ImagePicker" target="_blank" rel="external">SCImagePicker</a> A highly encapsulated and fully functional open-source image picker written in Objc based on Photokit. Including album list, asset list, selection preview, camera and short video taking</li>
<li><a href="https://github.com/SergioChan/SCTableViewCell" target="_blank" rel="external">SCTableViewCell</a> Swipe-to-Delete Effects like iOS Native Mail Appã€‚ä¸€ä¸ªæ¨¡ä»¿iOS8ä¸­çš„é‚®ç®±é‡Œé¢çš„cellåˆ é™¤åŠ¨æ•ˆä»¥åŠæ»‘åŠ¨å³ä¾§èœå•æŒ‰é’®æ•ˆæœçš„å¼€æºåº“</li>
<li><a href="https://github.com/SergioChan/SCNavigationControlCenter" target="_blank" rel="external">SCNavigationControlCenter</a> This is an advanced navigation control center on iOS that can allow you to navigate to whichever view controller you want. iOSä¸Šçš„æ”¹è¿›çš„å¯¼èˆªæ æ§åˆ¶ä¸­å¿ƒã€‚</li>
<li><a href="https://github.com/SergioChan/SCActivityIndicatorView" target="_blank" rel="external">SCActivityIndicatorView</a> An indicator view providing you more freedom to control and customize it.ä¸€ä¸ªé­”æ€§çš„èŠèŠ±æ§ä»¶ï¼ŒåŠ©ä½ æ‘†è„±ç³»ç»ŸèŠèŠ±çš„å„ç§çƒ¦æ¼</li>
<li><a href="https://github.com/SergioChan/SCRealm2SQLORM" target="_blank" rel="external">SCRealm2SQLORM</a> A realm ORM kit transferring realm usage to traditional SQLite usage. Just for learning and practicing.è¿™æ˜¯ä¸€ä¸ªç®€å•çš„realmçš„ç±»ä¼¼sqliteçš„æ•°æ®åº“æ¥å£åº“ã€‚å¯ä»¥ç»™ç†Ÿæ‚‰sqlè¯­æ³•ï¼Œæ–°å…¥é—¨realmçš„æ–°æ‰‹å‚è€ƒ</li>
<li><a href="https://github.com/SergioChan/SCTagWriteView" target="_blank" rel="external">SCTagWriteView</a> An input custom view providing you ability to add and remove tags</li>
<li><a href="https://github.com/SergioChan/TUCalender" target="_blank" rel="external">TUCalender</a> æ ¹æ®ä¸šåŠ¡éœ€è¦åŸºäºJTCalendaræ”¹å†™çš„æ—¥å†æ§ä»¶</li>
<li><a href="https://github.com/SergioChan/UILabel-AttributedText" target="_blank" rel="external">UILabel-AttributedText</a> This is a solution category for UILabel to deal with the issue about special chracters.</li>
</ul>
<h3 id="Test_on_iOS_Basic_Frameworks_iOS_u57FA_u7840_u6846_u67B6_u7684_u6D4B_u8BD5_u5B9E_u73B0_u7C7B"><a href="#Test_on_iOS_Basic_Frameworks_iOS_u57FA_u7840_u6846_u67B6_u7684_u6D4B_u8BD5_u5B9E_u73B0_u7C7B" class="headerlink" title="Test on iOS Basic Frameworks iOSåŸºç¡€æ¡†æ¶çš„æµ‹è¯•å®ç°ç±»"></a>Test on iOS Basic Frameworks iOSåŸºç¡€æ¡†æ¶çš„æµ‹è¯•å®ç°ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/RunloopTest" target="_blank" rel="external">RunloopTest</a>  This is a demo project for one of my blogs</li>
<li><a href="https://github.com/SergioChan/id-NSObjectDemo" target="_blank" rel="external">id-NSObjectDemo</a> This is a demo project for one of my blogs</li>
</ul>
<h3 id="Animations_on_iOS__u52A8_u753B_u7C7B"><a href="#Animations_on_iOS__u52A8_u753B_u7C7B" class="headerlink" title="Animations on iOS åŠ¨ç”»ç±»"></a>Animations on iOS åŠ¨ç”»ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/SCTrelloNavigation" target="_blank" rel="external">SCTrelloNavigation</a> An iOS native implementation of a Trello Animated Navagation. iOSä¸Šç±»ä¼¼trelloçš„å¯¼èˆªåŠ¨æ•ˆæ§ä»¶å®ç°ã€‚</li>
<li><a href="https://github.com/SergioChan/SCCatWaitingHUD" target="_blank" rel="external">SCCatWaitingHUD</a> This is a cute and simple loading HUD on iOS :-P è¿™æ˜¯ä¸€ä¸ªå¯çˆ±æ¸…æ–°ç®€å•çš„åŠ è½½HUDæ§ä»¶</li>
<li><a href="https://github.com/SergioChan/SCCinemaAnimation" target="_blank" rel="external">SCCinemaAnimation</a>  An iOS native implementation of a Cinema Animation Application. iOSä¸Šç”µå½±è´­ç¥¨çš„åŠ¨æ•ˆå®ç°</li>
</ul>
<h3 id="Apps__u72EC_u7ACB_u5E94_u7528_u7C7B"><a href="#Apps__u72EC_u7ACB_u5E94_u7528_u7C7B" class="headerlink" title="Apps ç‹¬ç«‹åº”ç”¨ç±»"></a>Apps ç‹¬ç«‹åº”ç”¨ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/SCSelfAgile" target="_blank" rel="external">SCSelfAgile</a> A Project for my daily life and wellâ€¦obviously for fun.<strong>(æœªä¸Šæ¶)</strong></li>
<li><a href="https://github.com/SergioChan/PasswordTerminator" target="_blank" rel="external">PasswordTerminator</a> Simple random password generator and manager. <strong>(å·²ä¸Šæ¶)</strong></li>
<li><a href="https://github.com/SergioChan/MorningHorn" target="_blank" rel="external">MorningHorn</a>  This is a warm and simple Alarm App.<strong>(å·²ä¸Šæ¶)</strong></li>
</ul>
<h3 id="Others__u5176_u4ED6_u7C7B"><a href="#Others__u5176_u4ED6_u7C7B" class="headerlink" title="Others å…¶ä»–ç±»"></a>Others å…¶ä»–ç±»</h3><ul>
<li><a href="https://github.com/SergioChan/SCTornadoTCP" target="_blank" rel="external">SCTornadoTCP</a> A TCP Server and Client based on tornado</li>
</ul>
<h1 id="Organizations"><a href="#Organizations" class="headerlink" title="Organizations"></a>Organizations</h1><blockquote>
<p>å‚ä¸å’Œå‘èµ·çš„ä¸€äº›ç»„ç»‡å’Œä¿¡æ¯</p>
</blockquote>
<h3 id="hACKbUSTER"><a href="#hACKbUSTER" class="headerlink" title="hACKbUSTER"></a><a href="https://github.com/hACKbUSTER" target="_blank" rel="external">hACKbUSTER</a></h3><p>A hack team for hackathons, consists of the best hackers and designers. Top requirement, top idea, top tech level.</p>
<ul>
<li><a href="https://github.com/hACKbUSTER/FixPlusPlus" target="_blank" rel="external">FixPlusPlus</a>  First Prize For SegmentFault Hackathon Beijing. FIX++ (FixPlusPlus) is a professional display solution for future guidelines and instruction manuals. æ›´ä¸“ä¸šçš„æ‹†è§£æ‹¼è£…å±•ç¤ºæ–¹æ¡ˆï¼Œå¯åº”ç”¨äºä¹é«˜ç©å…·ï¼Œå®œå®¶å®¶å…·ï¼Œè‹¹æœç”µè„‘ç­‰é¢†åŸŸã€‚</li>
<li><a href="https://github.com/hACKbUSTER/Renaissance" target="_blank" rel="external">Renaissance</a> First Prize for Art Hackathon 2015 China, Data becomes music. æ•°æ®å¬è§‰åŒ–çš„å°è¯•ã€‚</li>
<li><a href="https://github.com/hACKbUSTER/UberGuide-iOS" target="_blank" rel="external">UberGuide</a> Third Prize for Uber Hackathon China 2016. Source code for iOS client of UberGuide Project. ç”¨Uber API è®©èƒŒåŒ…å®¢é€šè¿‡Uberæ¢ç´¢æ–°çš„åŸå¸‚å’Œæ–‡åŒ–ã€‚</li>
<li><a href="https://github.com/hACKbUSTER/ProjectDaVinci" target="_blank" rel="external">ProjectDaVinci</a> First Prize of SegmentFault âœ–ï¸ AngelHack Shenzhen Hackathon 2016</li>
<li><a href="https://github.com/hACKbUSTER/ProjectM-SafariExtension" target="_blank" rel="external">ProjectM</a> First Prize of SegmentFault âœ–ï¸ AngelHack Beijing Hackathon 2016</li>
</ul>
<h3 id="Animatious"><a href="#Animatious" class="headerlink" title="Animatious"></a><a href="https://github.com/Animatious" target="_blank" rel="external">Animatious</a></h3><ul>
<li><a href="https://github.com/Animatious/awesome-animation" target="_blank" rel="external">awesome-animation</a> A great list of open sourced UI Motion Library produced by Animatious Group.</li>
</ul>
<h3 id="@Conf"><a href="#@Conf" class="headerlink" title="@Conf"></a><a href="https://github.com/atConf" target="_blank" rel="external">@Conf</a></h3><p>@Conf å›¢é˜Ÿï¼Œåšå¼€å‘è€…è‡ªå·±çš„æŠ€æœ¯å¤§ä¼š</p>
<ul>
<li><a href="https://github.com/atConf/atswift-2016-resources" target="_blank" rel="external">atswift-2016</a> Resource files for atswift conference 2016, including keynote, pdf, source projects or playgrounds. 2016ä¸­å›½Swiftå¼€å‘è€…å¤§ä¼š</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>As the number of my repos keeps increasing, I have to create this new repo]]>
    </summary>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[â€œäººå·¥æ™ºèƒ½â€é‚ªæ•™]]></title>
    <link href="http://sergiochan.github.io/2016/05/28/%E2%80%9C%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E2%80%9D%E9%82%AA%E6%95%99/"/>
    <id>http://sergiochan.github.io/2016/05/28/â€œäººå·¥æ™ºèƒ½â€é‚ªæ•™/</id>
    <published>2016-05-28T07:06:50.000Z</published>
    <updated>2016-08-25T01:51:20.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æˆ‘è§‰å¾—ç°åœ¨çš„ä¸è®ºæ˜¯å…¨ç¤¾ä¼šè¿˜æ˜¯æ•´ä¸ªäº’è”ç½‘åœˆï¼Œéƒ½å¼¥æ¼«ç€ä¸€è‚¡å¯¹äºäººå·¥æ™ºèƒ½çš„ç‹‚çƒ­å´‡æ‹œï¼Œå°±åƒæ˜¯ä¸€ç§äººå·¥æ™ºèƒ½é‚ªæ•™ä¸€æ ·ï¼Œæ·±æ·±åœ°è›Šæƒ‘ç€æ¯ä¸€ä¸ªåœˆå¤–äººæˆ–è€…æ˜¯æ— çŸ¥è€…çš„å¿ƒæ™ºã€‚å¤§å®¶éƒ½è§‰å¾—ï¼Œäººå·¥æ™ºèƒ½å¥½ç‰›é€¼å•Šï¼Œäººå·¥æ™ºèƒ½å¯ä»¥æ¯”äººè¿˜èªæ˜ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥åšåˆ°ä¸€åˆ‡ã€‚Excuse meï¼Ÿä½œä¸ºä¸€ä¸ªå¾®å°çš„äººç±»ä½ å´å¦„æƒ³æŠŠè‡ªå·±å¹»æƒ³ä¸­çš„ï¼Œæ³¨æ„æ˜¯å¹»æƒ³ä¸­çš„é€ ç‰©ä¸»åˆ›é€ å‡ºæ¥ï¼ŒExcuse meï¼Ÿè¿™æ˜¯ä¸€äº›ç®—æ³•èƒ½è§£å†³çš„å—ï¼Ÿå……å…¶é‡ï¼Œé€ å‡ºæ¥çš„ä¸è¿‡æ˜¯æ·±è“ï¼Œä¸è¿‡æ˜¯Alpha Goè¿™ç§åœ¨æˆ‘çœ‹æ¥<strong>åªèƒ½å®šä¹‰ä¸ºæœºå™¨çš„æ‰€è°“â€œæ™ºèƒ½â€</strong>ã€‚</p>
<blockquote>
<p>è¿™é‡Œä½ å¯ä»¥ç§»æ­¥<a href="http://baike.baidu.com/link?url=EP2EGmEI_HCXGn-iz4sLNr8dtbOsZ-eL_tSmQSk_4GCmdw5yiS-gkmJgSyJtJi5HEKSna62nvccqNG98RL-e1xE-PZBWqT9QAmH00609Ho_" target="_blank" rel="external">ç™¾åº¦ç™¾ç§‘</a>æ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯æ™ºèƒ½ï¼š</p>
<p>ä»æ„Ÿè§‰åˆ°è®°å¿†åˆ°æ€ç»´è¿™ä¸€è¿‡ç¨‹ï¼Œç§°ä¸ºâ€œæ™ºæ…§â€ï¼Œæ™ºæ…§çš„ç»“æœå°±äº§ç”Ÿäº†è¡Œä¸ºå’Œè¯­è¨€ï¼Œå°†è¡Œä¸ºå’Œè¯­è¨€çš„è¡¨è¾¾è¿‡ç¨‹ç§°ä¸ºâ€œèƒ½åŠ›â€ï¼Œä¸¤è€…åˆç§°â€œæ™ºèƒ½â€ï¼Œå°†<strong>æ„Ÿè§‰ã€è®°å¿†ã€å›å¿†ã€æ€ç»´ã€è¯­è¨€ã€è¡Œä¸ºçš„æ•´ä¸ªè¿‡ç¨‹ç§°ä¸ºæ™ºèƒ½è¿‡ç¨‹</strong>ï¼Œå®ƒæ˜¯æ™ºåŠ›å’Œèƒ½åŠ›çš„è¡¨ç°ã€‚å®ƒä»¬åˆ†åˆ«åˆå¯ä»¥ç”¨â€œæ™ºå•†â€å’Œâ€œèƒ½å•†â€æ¥æè¿°å…¶åœ¨ä¸ªä½“ä¸­å‘æŒ¥æ™ºèƒ½çš„ç¨‹åº¦ã€‚â€œæƒ…å•†â€å¯ä»¥è°ƒæ•´æ™ºå•†å’Œèƒ½å•†çš„æ­£ç¡®å‘æŒ¥ï¼Œæˆ–æ§åˆ¶äºŒè€…æ°åˆ°å¥½å¤„åœ°å‘æŒ¥å®ƒä»¬çš„ä½œç”¨ã€‚</p>
<p>å®ƒçš„å®šä¹‰æ˜¯ï¼š</p>
<p>æ™ºèƒ½åŠæ™ºèƒ½çš„æœ¬è´¨æ˜¯å¤ä»Šä¸­å¤–è®¸å¤šå“²å­¦å®¶ã€è„‘ç§‘å­¦å®¶ä¸€ç›´åœ¨åŠªåŠ›æ¢ç´¢å’Œç ”ç©¶çš„é—®é¢˜ï¼Œä½†è‡³ä»Šä»ç„¶æ²¡æœ‰å®Œå…¨äº†è§£ï¼Œä»¥è‡´æ™ºèƒ½çš„å‘ç”Ÿä¸ç‰©è´¨çš„æœ¬è´¨ã€å®‡å®™çš„èµ·æºã€ç”Ÿå‘½çš„æœ¬è´¨ä¸€èµ·è¢«åˆ—ä¸ºè‡ªç„¶ç•Œå››å¤§å¥¥ç§˜ã€‚</p>
<p>è¿‘äº›å¹´æ¥ï¼Œéšç€è„‘ç§‘å­¦ã€ç¥ç»å¿ƒç†å­¦ç­‰ç ”ç©¶çš„è¿›å±•ï¼Œäººä»¬å¯¹äººè„‘çš„ç»“æ„å’ŒåŠŸèƒ½æœ‰äº†åˆæ­¥è®¤è¯†ï¼Œä½†å¯¹æ•´ä¸ªç¥ç»ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„å’Œä½œç”¨æœºåˆ¶ï¼Œç‰¹åˆ«æ˜¯è„‘çš„åŠŸèƒ½åŸç†è¿˜æ²¡æœ‰è®¤è¯†æ¸…æ¥šï¼Œæœ‰å¾…è¿›ä¸€æ­¥çš„æ¢ç´¢ã€‚å› æ­¤ï¼Œ<strong>å¾ˆéš¾å¯¹æ™ºèƒ½ç»™å‡ºç¡®åˆ‡çš„å®šä¹‰</strong>ã€‚è€Œåœ¨ä»¿ç”Ÿå’Œæ¨¡æ‹Ÿã€è¶…çº§è®¡ç®—æœºæ–¹é¢ä¹Ÿæœ‰å…¶ç‰¹å®šå«ä¹‰ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å…ˆæ¥æƒ³æƒ³äººç±»å’Œæœºå™¨æ‰€ä¸åŒçš„åœ°æ–¹åœ¨å“ªï¼Œä»¥åŠæˆ‘ä»¬ä¸ºä»€ä¹ˆè«åå…¶å¦™ä¼šäº§ç”Ÿè¿™ç§å¯¹äºäººå·¥æ™ºèƒ½çš„ç‹‚çƒ­å´‡æ‹œã€‚é¦–å…ˆï¼Œ<strong>æœºå™¨éœ€è¦è§„èŒƒçš„è¾“å…¥</strong>ï¼Œæœºå™¨åªä¼šæ ¹æ®è¾“å…¥å»å¾—åˆ°è¾“å‡ºï¼Œå¯¹ï¼Œæ— è®ºæ˜¯å·¥å‚é‡Œçš„ç”Ÿäº§æœºå™¨ï¼Œäº¦æˆ–æ˜¯è®¡ç®—æœºï¼Œè¯´ç™½äº†éƒ½æ˜¯æœºå™¨ï¼Œä»–éœ€è¦å¯¹åº”çš„è¾“å…¥æ¥äº§ç”Ÿè¾“å‡ºï¼Œå› æ­¤ï¼Œå½“è¾“å…¥ä¸å¯¹çš„æ—¶å€™ï¼Œæœºå™¨å°±ç‚¸äº†ã€‚å°±åƒä½ ä¸èƒ½æŠŠä¸€ç›˜èœç«¯åˆ°Alpha Goé¢å‰è®©ä»–å°å°æ˜¯ä»€ä¹ˆå‘³é“ä¸€æ ·ï¼Œæ‰€ä»¥å®ƒå……å…¶é‡å°±æ˜¯ä¸ªæœºå™¨ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯æ™ºèƒ½å‘¢ï¼Ÿå¯ä»¥è¿™ä¹ˆè¯´ï¼Œ<strong>å°±ç›®å‰çš„äººç±»è®¤çŸ¥æ¥è¯´ï¼Œæ•´ä¸ªå®‡å®™é‡Œï¼Œå”¯ä¸€å…·æœ‰æ™ºèƒ½çš„ç”Ÿç‰©æˆ–è€…æ˜¯ç‰©ä½“ï¼Œåªæœ‰äººç±»</strong>ã€‚å› ä¸º<strong>æ™ºèƒ½åŒ…æ‹¬äº†å¾ˆå¤æ‚çš„è¯­è¨€ï¼Œæƒ…æ„Ÿï¼Œé“å¾·è®¤çŸ¥ä½“ç³»</strong>ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä»»æ„çš„è¾“å…¥ï¼Œæˆ–è€…è¿›ä¸€æ­¥è¯´ï¼Œæˆ‘ä»¬çš„æ„Ÿå®˜èƒ½å¤Ÿæ¥å—çš„å…¨éƒ¨æ ¼å¼ï¼Œæ¥ç†è§£ï¼Œè½¬åŒ–ä¸ºæˆ‘ä»¬ç”šè‡³éƒ½ä¸èƒ½ç†è§£çš„è¾“å…¥ï¼Œæœ€åäº§ç”Ÿè¾“å‡ºã€‚è¿™ç§è¾“å…¥æˆ‘ä»¬ç°åœ¨æ‰€èƒ½äº†è§£åˆ°çš„å°±æ˜¯ï¼Œä»–å¯èƒ½æ˜¯ä¸€ç§æ¿€ç´ ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ç§ç¥ç»ç”µæµï¼Œæœ€åçš„è¾“å‡ºä¹Ÿæ˜¯éå¸¸å¤æ‚å¤šæ ·åŒ–çš„ï¼Œå…·ä½“è¡¨ç°ä¸º<strong>è¡Œä¸º</strong>ï¼Œä¾‹å¦‚æˆ‘å¯ä»¥ç°åœ¨åœ¨ç”µè„‘ä¸Šå†™ä¸‹è¿™äº›æ–‡å­—ï¼Œè¿™å°±æ˜¯æˆ‘çš„æ™ºèƒ½çš„ä¸€ç§è¾“å‡ºã€‚æ­£æ˜¯å› ä¸ºæ™ºèƒ½çš„é«˜çº§ï¼Œæ‰€ä»¥æ‰äº§ç”Ÿäº†å¤æ‚çš„ç¤¾ä¼šç»“æ„å’Œç§‘å­¦ä½“ç³»ï¼Œæ­£æ˜¯å› ä¸ºæ™ºèƒ½ï¼Œæ‰æœ‰äº†æˆ‘ä»¬ï¼Œæ‰æœ‰äº†æˆ‘ä»¬å­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥ä¸‹å»ç†è§£è¿™ä»¶äº‹æƒ…ã€‚æˆ‘ä»¬å…¶å®æ˜¯åœ¨<strong>è¯•å›¾åˆ›é€ ä¸€ä¸ªå¦å®šè‡ªå·±å­˜åœ¨æ„ä¹‰çš„äº‹ç‰©</strong>ã€‚è¿™æ— å…³é€ ç‰©ä¸»ä¸é€ ç‰©ä¸»çš„äº‹æƒ…ï¼Œæ¯•ç«Ÿé€ ç‰©ä¸»åªæ˜¯ä¸ªæ¯”å–»ï¼Œåªæ˜¯è¯´ï¼Œ<strong>æˆ‘ä»¬çš„å­˜åœ¨æ­£æ˜¯ç”±æˆ‘ä»¬çš„æ™ºèƒ½è‡ªæˆ‘å®šä¹‰çš„</strong>ï¼Œä½†æ˜¯å½“æ›´é«˜çº§çš„æ™ºèƒ½å­˜åœ¨ä¹‹åï¼Œä¸–ç•Œä¼šä»¥â€œä»–ä»¬â€çš„å®šä¹‰è€Œå­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å­˜åœ¨çš„æ„ä¹‰å°±ä¸å¤å­˜åœ¨äº†ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆçŸ›ç›¾çš„æ‚–è®ºã€‚å½“ç„¶ï¼Œç®€æ˜“èµ·æ¥ç†è§£ï¼Œå°±æ˜¯ä¸€äº›ç§‘å­¦å®¶æ‰€æ‹…å¿ƒçš„ï¼Œæ—¢ç„¶æœ‰äº†â€œä»–ä»¬â€ï¼Œé‚£æˆ‘ä»¬å°±æ²¡æœ‰å­˜åœ¨çš„å¿…è¦äº†ï¼Œâ€œä»–ä»¬â€è¿Ÿæ—©ä¼šæŠŠæˆ‘ä»¬ä»è¿™ä¸ªä¸–ç•Œä¸ŠæŠ¹å»ã€‚ç„¶è€Œè¿™ä¹Ÿå¹¶ä¸ä¼šæ„æˆä»€ä¹ˆå®è´¨æ€§çš„å¨èƒï¼Œå°±åƒèš‚èšåœ¨åœ°çƒä¸Šä¸ä¹Ÿæ´»çš„å¥½å¥½çš„ =ã€‚= æˆ‘è¿™ä¹ˆç†è§£è‡ªç„¶æ˜¯æ›´åŠ çš„ä»¥æˆ‘ä»¬äººç±»è‡ªæˆ‘å‡ºå‘çš„è§†è§’å»æ€è€ƒçš„ã€‚</p>
<p>è¿™é‡Œæˆ‘å¿½ç„¶æƒ³åˆ°å‰å‡ å¤©å’Œå“¥ä»¬èŠåˆ°çš„ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„æ–°é—»ï¼Œè®²çš„æ˜¯ä¿„ç½—æ–¯è¿˜æ˜¯å“ªæœ‰ä¸€ä¸ªå°ä¼™å› ä¸ºå¤§è„‘é‡ŒæŸä¸ªè¿åŠ¨æ§åˆ¶ä¸­æ¢åæ‰äº†ï¼Œå¯¼è‡´äº†ä¸‹åŠèº«ç˜«ç—ªè¿˜æ˜¯ä»€ä¹ˆï¼Œå†³å®šæ¥å—æ¢å¤´æ‰‹æœ¯ã€‚æˆ‘è®°å¾—æˆ‘ä¹Ÿåœ¨ç™¾åº¦æ–°é—»é‡Œçœ‹åˆ°è¿‡è¿™ä¸ªé›·äººçš„æ–°é—»ï¼Œè¿˜è¯´æ¥å—çš„é‚£é¢—å¤´æ¥è‡ªäºä¸­å›½ä»€ä¹ˆçš„ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä¸å»è€ƒç©¶æ–°é—»çš„çœŸå®æ€§ï¼Œæˆ‘ä»¬å°±å•çº¯çš„æ¥æ€è€ƒï¼Œå¦‚æœæœ‰ä¸€ä¸ªäººå› ä¸ºå¤§è„‘çš„ç—…å˜å¯¼è‡´å…¨èº«éƒ½ä¸å¬ä½¿å”¤äº†ï¼Œè¿™æ—¶å€™ä»–è¦æ¥å—æ¢å¤´æ‰‹æœ¯ï¼Œå‡è®¾æ¢äº†ä¸€ä¸ªå¥åº·çš„å¤´ä¹‹åä»–çš„èº«ä½“èƒ½å¤Ÿè¢«æ–°çš„å¤´æ‰€æ§åˆ¶ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œä¸ºæœ¬èº«æ˜¯ä¸æ˜¯äºŒï¼Ÿ<strong>æˆ‘ä»¬çš„å­˜åœ¨ä¸æ˜¯ç”±æˆ‘ä»¬çš„èº«ä½“æ¥å®šä¹‰çš„</strong>ï¼ŒåŒ»å­¦ä¸Šå®šä¹‰ä¸€ä¸ªäººçš„æ­»äº¡ä¹Ÿæ˜¯ä»¥è„‘æ­»äº¡ï¼Œå³æ„è¯†çš„æ´»åŠ¨æ¥åˆ¤å®šä¸€ä¸ªâ€œäººâ€çš„æ­»äº¡ï¼Œæ‰€ä»¥è¿™ä¸‹å°±æœ‰è¶£äº†ï¼Œæˆ‘ä»¬å¿½ç„¶å‘ç°æˆ‘ä»¬çš„å­˜åœ¨æ˜¯ç”±æˆ‘ä»¬çš„å¤§è„‘æ¥å†³å®šçš„ï¼Œæˆ‘ä»¬èº«ä½“ä¸Šçš„ä»»ä½•ä¸€ä¸ªéƒ¨ä»¶éƒ½å¯ä»¥æ›´æ¢ï¼Œå”¯ç‹¬å¤§è„‘ä¸èƒ½æ›´æ¢ï¼Œå³ä½¿ä½ é•¿å¾—å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ï¼Œä¸€æ—¦æ¢äº†è„‘è¢‹ï¼Œä½ ä¹Ÿä¸å­˜åœ¨äº†ã€‚æ‰€ä»¥æˆ‘ä»è¿™è”æƒ³åˆ°äº†ä¸Šä¸€æ®µæˆ‘æåˆ°çš„å¦å®šè‡ªèº«å­˜åœ¨æ„ä¹‰çš„æƒ³æ³•ï¼Œè¿™æ˜¯ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¢çœ¼ç›ï¼Œé¼»å­ï¼Œèº«ä½“çš„å„ä¸ªéƒ¨ä½ï¼Œç”¨æœºå™¨æ¥ä»£æ›¿ï¼Œä½†æ˜¯å¦‚æœç”¨äººå·¥æ™ºèƒ½æ¥æ›¿ä»£äº†å¤§è„‘ï¼Œé‚£ä½ å°±ä¸å­˜åœ¨äº†ï¼Œå› ä¸º<strong>ä»–ä¼šä»¥ä»–çš„å­˜åœ¨æ¥å®šä¹‰ä½ çš„å­˜åœ¨</strong>ã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘åªæ˜¯æƒ³è¿›ä¸€æ­¥è¯æ˜æˆ‘ä»¬çš„å¤§è„‘æˆ–è€…è¯´æˆ‘ä»¬çš„æ™ºèƒ½æ‰æ˜¯æˆ‘ä»¬å­˜åœ¨çš„æ„ä¹‰ï¼Œè€Œéè‚‰èº«ã€‚<strong>æˆ‘ä»¬çš„å­˜åœ¨æ­£æ˜¯å› ä¸ºæˆ‘ä»¬çš„å­˜åœ¨è€Œå®šä¹‰çš„</strong>ï¼Œæ‰€ä»¥è¿™ä¸ªé—®é¢˜æ‰ä¼šæ²¡æœ‰ç­”æ¡ˆã€‚</p>
<p>å›åˆ°å®é™…ï¼Œåˆ¨é™¤ç„å­¦é—®é¢˜æ¥è¯´ï¼Œè™½ç„¶æˆ‘ä»¬å¯¹äºäººå·¥æ™ºèƒ½çš„å®ç°æœ‰äº†ä¸€å®šæŠŠæ¡ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹å¤§è„‘è¿è¡Œæœºåˆ¶çš„â€œçŒœæµ‹â€æ¥è®¾è®¡å‡ºäº†ç¥ç»ç½‘ç»œï¼Œå°±åƒ Alpha Go æ‰€å®ç°çš„é‚£æ ·ï¼Œé€šè¿‡ä¸æ–­åœ°æ·±åº¦å­¦ä¹ æ¥è®©æ™ºèƒ½è‡ªæˆ‘è¿›åŒ–ã€‚ä½†æ˜¯ï¼Œè¡¨é¢ä¸Šä¸€è·¯å¦é€”ï¼Œè¯­ä¹‰ç†è§£ï¼Œè¯­éŸ³è¯†åˆ«ï¼Œå…‰å­¦è¯†åˆ«ï¼Œæ¨¡å¼è¯†åˆ« blahblahï¼Œå„ç§ç®—æ³•éƒ½æœ‰å„ç§å›¢é˜Ÿåœ¨ä¸æ–­çš„åˆ›æ–°ï¼Œç„¶è€Œï¼Œ(ä¹Ÿå¯èƒ½å› ä¸ºæˆ‘æ˜¯ä¸ªåœ¨è¿™æ–¹é¢çš„æ‚²è§‚ä¸»ä¹‰è€…)ï¼Œæˆ‘è®¤ä¸ºæˆ‘ä»¬ç¦»çœŸæ­£çš„ç ”ç©¶é€å½»å·®äº†åä¸‡å…«åƒé‡Œï¼Œç”šè‡³æˆ‘ä»¬çš„æ–¹å‘å°±ä¸å¯¹ã€‚æˆ‘å¯ä»¥éšä¾¿ä¸¾å‡ ä¸ªä¾‹å­ï¼Œç”¨å…‰å­¦è¯†åˆ«æ¥å®ç°å„ç§é¢éƒ¨è¯†åˆ«ï¼Œæ‰‹åŠ¿è¯†åˆ«ï¼Œä¸”ä¸è¯´å…‰çº¿çš„é—®é¢˜ï¼Œå°±è¯´å¹²æ‰°æºçš„é—®é¢˜ï¼Œä½ æ€ä¹ˆè§£å†³ï¼Œæˆ‘æˆ´ä¸Šäººçš®é¢å…·ï¼Œæˆ‘æ‹¿æ¥å‡ ä¸ªä»¿çœŸæ‰‹çš„æ¨¡å‹æ¥æ··æ·†ä½ ï¼Œæ²¡æœ‰å‡ å®¶å…¬å¸å“ªå‡ ä¸ªç®—æ³•èƒ½åšåˆ°è¿™ç§åœ°æ­¥çš„â€¦â€¦å› ä¸ºäººéƒ½ä¼šåˆ¤æ–­é”™è¯¯çš„ä¸œè¥¿ï¼Œä½ å¦„æƒ³æœºå™¨èƒ½å¤Ÿåˆ¤æ–­å¯¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ€»æ˜¯è§‰å¾—ï¼Œæˆ‘ä»¬ä¸€å®šè¦é€ å‡ºæ¯”è‡ªå·±ç‰›é€¼çš„äº‹ç‰©ï¼Œå¯¹ï¼Œæ²¡é”™ï¼Œä½†æ˜¯æˆ‘ä»¬æ°¸è¿œé€ ä¸å‡ºè¯†åˆ«èƒ½åŠ›æ¯”äººç±»ç‰›é€¼çš„äº‹ç‰©ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬æœ¬èº«çš„è®¤çŸ¥å°±ååˆ†æœ‰é™ï¼Œæˆ‘ä»¬å—è‡ªèº«æ¡ä»¶çš„é™åˆ¶ï¼Œåªèƒ½é€šè¿‡æˆ‘ä»¬æœ‰é™çš„æ„Ÿå®˜æ¥æ„ŸçŸ¥ä¸–ç•Œã€‚æˆ‘ä¼šå±•å¼€è§£é‡Šè¿™ä¸€ç‚¹ã€‚å½“ç„¶ï¼Œè¿™é‡Œä¸ºäº†é˜²æ­¢è¢«å–·ï¼Œæˆ‘éœ€è¦åŠ ä¸Šä¸€ä¸ªå…ˆææ¡ä»¶ï¼Œé‚£å°±æ˜¯åœ¨<strong>æœ‰é™æ ·æœ¬é‡çš„æƒ…å†µä¸‹ï¼Œæœºå™¨ç®—æ³•é€šè¿‡å¤§é‡è®­ç»ƒæ˜¯å¯ä»¥è¶…è¿‡äººç±»çš„è¯†åˆ«èƒ½åŠ›çš„</strong>ï¼Œä½†æ˜¯è¿™æ˜¯åœ¨æœ‰é™æ ·æœ¬é‡çš„æƒ…å†µä¸‹ï¼Œç°å®ç”Ÿæ´»ä¸­ï¼Œé™¤éä½ æŠŠä¸–ç•Œä¸Šæ¯ä¸€ä¸ªäººéƒ½ç®—è¿›æ ·æœ¬é‡Œï¼Œå¦åˆ™ä½ çš„ç®—æ³•åªè¦ç¨å¾®ç”¨åœ¨ä¸€ä¸ªç‰¹å¾è¿œç¦»ä½ çš„æ ·æœ¬åº“çš„äººèº«ä¸Šï¼Œç®—æ³•è¯†åˆ«èƒ½åŠ›å°±ä¼šè¿œä½äºäººç±»ã€‚</p>
<p>å…¶å®å½“ä½ ä»”ç»†æ€è€ƒï¼Œä½ å°±ä¼šæ˜ç™½ï¼Œäººç±»å¯¹äºäººå·¥æ™ºèƒ½çš„ç‹‚çƒ­å…¶å®æ˜¯æ¥è‡ªåƒç™¾å¹´ä»¥æ¥äººç±»å¯¹äºè‡ªèº«å„ç§æ„Ÿå®˜å’Œå™¨å®˜é™åˆ¶çš„ä¸€ç§ææƒ§æˆ–è€…è¯´æ˜¯å¯¹äºæ›´å¼ºçš„ä¸ªä½“çš„ä¸€ç§è¿½æ±‚ã€‚å½“æˆ‘ä»¬å‘ç°æ‰€è°“çš„è¿›åŒ–åœ¨å‡ åƒå¹´é‡Œå¹¶æ²¡æœ‰è®©äººä»¬è¿›åŒ–å‡ºä¸€åŒç«çœ¼é‡‘ç›ï¼Œå…¶å®ç°åœ¨çš„äººç±»å¯¹äºè‡ªèº«çš„è¿›åŒ–é€Ÿåº¦æ˜¯ååˆ†çš„æ€€ç–‘å’Œæ‹…å¿§çš„ã€‚ä¸”ä¸è®ºç”Ÿç‰©å­¦ç•Œå¯¹äºè¿›åŒ–è®ºçš„ä¸æ–­è´¨ç–‘ï¼Œå¦‚æœä½ ä¸æ‰¿è®¤å¯¹äºæ•´ä¸ªç§æ—çš„æ€€ç–‘ï¼Œä½ ä¼šå‘ç°å‡ ä¹å…¨éƒ¨çš„å›´ç»•äººå·¥æ™ºèƒ½çš„è®¨è®ºï¼Œéƒ½æ˜¯é›†ä¸­åœ¨å¦‚ä½•åˆ›é€ ä¸€ä¸ªè¿›åŒ–é€Ÿåº¦æ˜¯æˆ‘ä»¬äººç±»çš„å‡ åƒå‡ ä¸‡å€çš„æ™ºèƒ½ã€‚æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å¦‚ä»Šæ‰€çœ‹è§å’Œäº†è§£çš„å‡ ä¹æ‰€æœ‰äººå·¥æ™ºèƒ½ï¼Œæ— ä¸€ä¾‹å¤–éƒ½æ˜¯å¯¹äºäººä½“ä¸€äº›æœºèƒ½å’Œæ„Ÿå®˜çš„åŠ å¼ºï¼Œä¾‹å¦‚è¿œåœºè¯†åˆ«éº¦å…‹é£ï¼Œæ»¡è¶³äº†äººä»¬åƒé‡Œè€³çš„ç”Ÿç†é™åˆ¶ï¼›è®¡ç®—æœºï¼Œæ»¡è¶³äº†äººè„‘è®°å¿†æœºåˆ¶çš„ç¼ºé™·å’Œè¿ç®—èƒ½åŠ›çš„ç¼ºé™·ï¼›è¿˜æœ‰å„ç§çº¢å¤–ï¼Œé«˜æ¸…ï¼Œå…¨æ™¯æ‘„åƒå¤´ï¼Œæ»¡è¶³äº†äººä»¬è§†è§‰ä¸Šçš„å±€é™æ€§ï¼Œèƒ½å¤ŸåŒæ—¶è¯†åˆ«æ›´å¤šç‰©ä½“ã€‚ï¼ˆè™½ç„¶åœ¨å—…è§‰å’Œå‘³è§‰ä¸Šäººç±»å¹¶æ²¡æœ‰ä»€ä¹ˆä¸æ»¡è¶³çš„ï¼Œè¿™æ˜¯æå…¶æœ‰è¶£çš„ä¸€ç‚¹ï¼Œäººç±»åè€Œå¯¹è¿™ä¸¤ç§æ„Ÿå®˜ååˆ†çš„è‡ªå¾—å…¶ä¹ =ã€‚=ï¼‰è¿™é‡Œæåˆ°äº†è®¡ç®—æœºï¼Œæˆ‘æƒ³ä½ åº”è¯¥ä¼šæ‰¿è®¤ï¼Œäººè„‘çš„è¿ç®—é€Ÿåº¦è¿œæ²¡æœ‰è®¡ç®—æœºå¿«ï¼Œå¯¹å§ï¼Ÿä½†é‚£ä»…ä»…æ˜¯å±€é™äºè®¡ç®—ï¼Œäººè„‘çš„å¯è´µå’Œé‡è¦ä¹‹å¤„åœ¨äºç†è§£å’Œè¯†åˆ«ï¼Œè€Œè¿™ä¸€ç‚¹æ­£æ˜¯ç°åœ¨æ‰€æœ‰çš„äººå·¥æ™ºèƒ½æ‰€æ¬ ç¼ºçš„ã€‚å‡ ä¹æ‰€æœ‰çš„çœ‹èµ·æ¥åæ°”æŒºå¤§çš„äººå·¥æ™ºèƒ½ï¼Œæ‹‰å‡ºæ¥ï¼Œæ¶‰åŠåˆ°æœ€æ ¸å¿ƒçš„äººè„‘ä¸­æ‰§è¡Œç†è§£çš„è¿™å—åŒºåŸŸï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨æ‰“å“ˆå“ˆã€‚</p>
<p>ä»Siriï¼Œåˆ°Cortanaï¼Œåˆ°è°·æ­Œå‰æ®µæ—¶é—´æ¨å‡ºçš„äººå·¥æ™ºèƒ½ï¼Œå†åˆ°äºšé©¬é€Šçš„Echoï¼Œä»–ä»¬æ— ä¸€ä¾‹å¤–éƒ½æ‰®æ¼”ç€åŠ©ç†çš„è§’è‰²ï¼Œæˆ–è€…è¯´ï¼Œåœ¨æœ‰é™çš„åœºæ™¯ä¸‹åšå‡ºæœ‰é™çš„ååº”æ‰§è¡Œæœ‰é™çš„æ“ä½œï¼Œä½ ä¼šå¾ˆç»å¸¸çš„é‡åˆ°Siriç”¨å¥‡æ€ªçš„å£æ°”å‘Šè¯‰ä½ å¥¹åœ¨äº’è”ç½‘ä¸Šä¸ºä½ æŸ¥åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼Œè¿™å…¶å®åªæ˜¯ä¸€ä¸ªè¯­éŸ³æœç´¢ï¼Œè¿™åªæ˜¯åœ¨å¼¥è¡¥äººè„‘å¯¹äºä¿¡æ¯è·å–é€”å¾„çš„ç¼ºä¹ä»¥åŠä¿¡æ¯çš„å­˜å‚¨ç¼ºé™·ã€‚å¦‚æœæœ‰ä¸€å¤©ä½ çš„å¤§è„‘èƒ½å¤Ÿè¿ä¸Šäº’è”ç½‘ï¼Œä½ èƒ½å¤Ÿåœ¨ä½ çš„æ€ç»´é‡Œé€šè¿‡æœç´¢å¼•æ“å»æœç´¢ä¿¡æ¯ï¼Œæˆ‘æƒ³ï¼Œè¿™äº›â€œäººå·¥æ™ºèƒ½â€œå°±å·²ç»å¯ä»¥å»åƒåœŸäº†ã€‚æ‰€ä»¥é—®é¢˜çš„æ ¹æºæ˜¯åœ¨äºæˆ‘ä»¬å¯¹äºä¿¡æ¯è·å–çš„é€”å¾„ï¼Œåœ¨äºæˆ‘ä»¬å¯¹ä¿¡æ¯çš„å­˜å‚¨ã€‚</p>
<p>é™¤äº†æ‰€è°“â€œå¿«é€Ÿâ€çš„ä¿¡æ¯è·å–ï¼Œå¦‚ä»Šè¿™äº›å¤§å‚æå‡ºæ¥çš„äººå·¥æ™ºèƒ½è¿˜æœ‰ä¸€äº›æˆ–å¤šæˆ–å°‘æ–¹ä¾¿åˆ°äººä»¬çš„åŠŸèƒ½ï¼Œå¯¹ï¼Œè¿™äº›éƒ½åªèƒ½ç®—æ˜¯åŠŸèƒ½ã€‚ä¾‹å¦‚å¯ä»¥æ§åˆ¶æ™ºèƒ½å®¶å±…ï¼Œæ§åˆ¶æ’­æ”¾å™¨ï¼Œæ§åˆ¶blahblahï¼Œç»™ä½ å®šé—¹é’Ÿï¼Œä¹Ÿæœ‰ä¸€äº›æ ¼å¼æ¯”è¾ƒè§„èŒƒçš„å†…å®¹ä»–ä»¬å¯ä»¥ä¸ºä½ æ¢³ç†ï¼Œä¾‹å¦‚éŸ³ä¹ï¼Œæ–°é—»ï¼Œæ¯”èµ›çš„å®æ—¶æ¯”åˆ†ï¼Œè¿™äº›å†…å®¹åœ¨äº’è”ç½‘ä¸Šå¤§å¤šæ•°éƒ½æ˜¯ä»¥ä¸€äº›å›ºå®šçš„æ ¼å¼å­˜åœ¨ï¼Œå› æ­¤ä»–å¯ä»¥å®æ—¶çš„ä¸ºä½ ä»äº’è”ç½‘ä¸Šå»æŠ“å–è¿™äº›ä¿¡æ¯ã€‚ç„¶è€Œæ­£æ˜¯ç”±äºåŠŸèƒ½çš„å›ºå®šï¼Œå’Œè¯­ä¹‰ç†è§£çš„å±€é™ï¼Œç›®å‰çš„ï¼Œæˆ‘æ•¢è¯´æ‰€æœ‰ï¼Œæ‰€æœ‰è¿™ç±»äººå·¥æ™ºèƒ½ï¼Œå…¶å®<strong>éƒ½ç›¸å½“äºä¸€ä¸ªè¯­éŸ³è¾“å…¥çš„DOSæœº</strong>ï¼Œè€Œä¸”è¿™ä¹Ÿæ˜¯æˆ‘ä¸ºä»€ä¹ˆåæ„Ÿè¿‡å¤šçš„ç‚’ä½œäººå·¥æ™ºèƒ½çš„åŸå› ä¹‹é¦–ã€‚  </p>
<p>ç”±äºäººç±»çš„è¡¨è¾¾æ–¹å¼æ˜¯æ²¡æœ‰åŠæ³•è¢«ç©·ä¸¾çš„ï¼Œè¿™ä¸ªå…ˆææ¡ä»¶æˆ‘ä»¬å¿…é¡»å…ˆè¾¾æˆä¸€è‡´ï¼Œæ‰€ä»¥å½“ä½ åªæ˜¯åœ¨ç”¨ä¸€ä¸ªæœ‰é™çš„æŒ‡ä»¤é›†å»å®ç°è¿™ä¸ªæ‰€è°“çš„æ™ºèƒ½ï¼Œæˆ–è€…è¯´åœ¨æˆ‘ä»¬å¯ä»¥é¢„è§çš„æœªæ¥éƒ½æ²¡æœ‰åŠæ³•æ‘†è„±ä¸€ä¸ªå¤§çš„å¥å¼åº“æˆ–è€…è¯­æ³•åº“çš„å½¢å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡ä»¤é›†å…¶å®å°±æ˜¯DOSæŒ‡ä»¤ä¸€æ ·ï¼Œæ˜¯éœ€è¦ç”¨æˆ·å»å­¦ä¹ çš„ã€‚ä½ ä¹Ÿè®¸ä¼šè¯´ï¼Œä»»ä½•äº¤äº’éƒ½æœ‰å­¦ä¹ æˆæœ¬ï¼Œåªä¸è¿‡ç°åœ¨çš„äº¤äº’åœ¨ä¸æ–­æ¼”è¿›ç½¢äº†ï¼Œæ‰€ä»¥å­¦ä¹ æˆæœ¬ä¸åº”è¯¥ä½œä¸ºé¦–è¦è€ƒè™‘çš„å› ç´ ã€‚ç¡®å®ï¼Œç°åœ¨çš„è¯­éŸ³åŠ©ç†ç±»è½¯ä»¶æœ‰éå¸¸å¤šï¼Œæˆ‘æš‚ä¸”ä¸ç§°å‘¼ä»–ä»¬ä¸ºäººå·¥æ™ºèƒ½ï¼Œç”¨æˆ·æ¥è§¦ä»–ä»¬çš„æ—¶é—´ä¹Ÿå·²ç»æŒºé•¿çš„äº†ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨æ…¢æ…¢å‘ç°æˆ‘ä»¬é€‚åº”äº†ä»–ä»¬çš„å±€é™æ€§ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§Sirièƒ½å¬æ‡‚çš„æ ¼å¼å‘Šè¯‰ä»– å‡ ç‚¹å‡ åˆ†ç»™è°è°è°å‘çŸ­ä¿¡ï¼Œç„¶åä»–é—®ä½ è¦å‘é€ä»€ä¹ˆï¼Œç„¶åä½ å°±ä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„æŠŠä½ è¦å‘çš„çŸ­ä¿¡è¯»ç»™å¥¹å¬ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ä½ çš„æ‰€è°“æ™ºèƒ½çœŸæ­£å¸¦æ¥äº†ä¸€äº›æ–¹ä¾¿çš„æ—¶å€™ï¼Œç”¨æˆ·å…¶å®æ˜¯æ„¿æ„ä¹Ÿè‡ªåŠ¨çš„ä¼šå»ä»˜å‡ºè¿™ä¸ªå­¦ä¹ æˆæœ¬çš„ã€‚ä½†æ˜¯ï¼Œç¬¬ä¸€ï¼Œè¿™ä»ç„¶ä¸èƒ½ç§°ä¹‹ä¸ºæ™ºèƒ½ï¼Œç¬¬äºŒï¼Œæˆ‘ä»¬å¯èƒ½é™·å…¥äº†å’ŒDOSæ—¶ä»£ç±»ä¼¼çš„è¯¯åŒºã€‚  </p>
<p>æˆ‘åˆ°è¿‡ä¸€äº›åœ¨ä¸­å›½å¯ä»¥ç®—å¾—ä¸Šä¸‰å››çº¿çš„åŸå¸‚ï¼Œé‚£ä¹ˆæ›´åˆ«è¯´ä¸­äºšï¼Œéæ´²å¤§ç‰‡å¤§ç‰‡çš„åœ°åŒºäº†ï¼Œè¿™äº›åœ°æ–¹çš„äººå£ï¼Œè™½ç„¶ä¸€ç›´åœ¨äº«å—ç€è®¡ç®—æœºæ—¶ä»£å¸¦æ¥çš„çº¢åˆ©ï¼Œä½†æ˜¯åŒæ—¶ä»–ä»¬ä¹Ÿæ²¡åŠæ³•è¿‡å¤šçš„æ¥è§¦è®¡ç®—æœºã€‚ä»”ç»†æƒ³æƒ³ï¼Œå…¶å®åœ¨è®¨è®ºï¼Œè¿½æ±‚å’Œæ¸´æœ›ï¼Œç”šè‡³å»åˆ›é€ äººå·¥æ™ºèƒ½çš„äººç¾¤é‡Œï¼ŒåŸºæœ¬ä¸Šå¤§å¤šæ•°äººæ‰€ä»äº‹çš„è¡Œä¸šéƒ½å’Œè®¡ç®—æœºç›¸å…³ï¼Œæˆ–è€…è¯´æ—¥å¸¸è¾ƒä¸ºé¢‘ç¹çš„æ¥è§¦è®¡ç®—æœºã€‚è¿™ç±»äººç¾¤ç¡®å®å·²ç»åœ¨å›¾å½¢æ“ä½œç³»ç»Ÿçš„æ—¶ä»£é‡Œå®Œæˆäº†è¿›åŒ–ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ”¾çœ¼æ•´ä¸ªäººç±»æ–‡æ˜ï¼Œè¿™ä¸ªè¿›ç¨‹ä»ç„¶æ˜¯éå¸¸ç¼“æ…¢çš„ï¼Œæ ¹æœ¬åŸå› ä¸€ä¸ªæ˜¯åœ¨äºæ—©å…ˆçš„è®¡ç®—æœºç¡¬ä»¶æˆæœ¬ï¼Œä¸€ä¸ªè¿˜æ˜¯åœ¨äºå›¾å½¢ç•Œé¢æ“ä½œç³»ç»Ÿçš„å­¦ä¹ æˆæœ¬ä»ç„¶å­˜åœ¨ï¼ˆä½ æ•¢è¯´Windowsçš„å­¦ä¹ æˆæœ¬ä½æˆ‘è·Ÿä½ æ€¥ï¼Œå¦‚æœä½ æ˜¯ä¸ªå­¦è®¡ç®—æœºçš„ï¼Œä½ è¢«å¤šå°‘äººæ‰¾ä½ é‡è£…è¿‡ç³»ç»Ÿäº†ï¼Ÿï¼‰ã€‚å›¾å½¢æ“ä½œç³»ç»Ÿçš„æ™®åŠå¾ˆå¤§æ„ä¹‰ä¸Šå°±æ˜¯å› ä¸ºå½“æ—¶çš„ä¸–ç•Œä¸Šåªæœ‰æå°‘æå°‘æ•°çš„æå®¢ä¼šå°†ä¸€æ•´å¼ DOSå‘½ä»¤è¡¨èƒŒçš„æ»šç“œçƒ‚ç†Ÿè½»è½¦ç†Ÿè·¯ç„¶åå®Œå…¨é€šè¿‡æŒ‡ä»¤æ¥æ§åˆ¶æ•´ä¸ªç³»ç»Ÿï¼Œè¿™äº›äººå°é—­åœ¨è‡ªå·±çš„ä¸–ç•Œé‡Œï¼Œè®¤ä¸ºè‡ªå·±æ­£åœ¨åˆ›é€ æ–°ä¸–ç•Œï¼Œè®¤ä¸ºè‡ªå·±å¾ˆé…·ï¼Œä¸å¯å¦è®¤ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå‘½ä»¤è¡Œæ˜¯éå¸¸æ–¹ä¾¿å’Œé«˜æ•ˆçš„ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶è€Œå¯¹äºæ¶ˆè´¹è€…ï¼Œå¯¹äºEntire Human Speciesï¼Œè¿™æ— ç–‘æ˜¯ä¸€ä¸ªå°é—­ï¼Œè‡ªæˆ‘çš„ç¾¤ä½“ã€‚è€Œæˆ‘è®¤ä¸ºç”±äºäº’è”ç½‘æµªæ½®çš„å…´èµ·ï¼Œç°åœ¨çš„æ•´ä¸ªç¤¾ä¼šæ­£æœ‰è¿™ä¸ªè¶‹åŠ¿ï¼Œè€Œä¸”ç”±äºå¦‚ä»Šäº’è”ç½‘èƒ½å¤Ÿåœ¨å…¶ä»–è¡Œä¸šçœ‹æ¥æ›´è½»è€Œæ˜“ä¸¾çš„èèµ„ï¼Œè¿™ä¸ªåŸæœ¬æ˜¯è´Ÿé¢çš„æ•ˆåº”åè€Œè¢«é’±æ´—äº†ä¸ªè„¸ï¼Œæˆä¸ºäº†ä¸€ä¸ªæ–°çš„ç¤¾ä¼šç”Ÿäº§åŠ›ã€‚æˆ‘ä»¬å°é—­çš„æœ‰ç†ï¼Œæˆ‘ä»¬é…·çš„æœ‰ç†ï¼Œå› ä¸ºæˆ‘ä»¬æ›´æœ‰é’±ï¼Œè€Œä¸”ï¼Œæ›´é‡è¦çš„æ˜¯ï¼ŒæŠ€æœ¯è¿™ä¸ªäº‹æƒ…ï¼Œç›¸æ¯”äºä¼ ç»Ÿè¡Œä¸šï¼Œæ›´å®¹æ˜“ç™½æ‰‹èµ·å®¶ï¼Œè¿™å¯¹äºç¤¾ä¼šé˜¶å±‚æµåŠ¨ç­‰ç­‰ç­‰ç­‰éƒ½æ˜¯æœ‰ç§¯æä½œç”¨çš„ï¼ˆè¿™é‡Œå¦‚æœæ˜¯ç»æµå­¦å®¶åº”è¯¥èƒ½åˆ†æå‡ºä¸ªé•¿ç¯‡å¤§è®ºå§ï¼‰ï¼Œå› æ­¤ç§ç§å¤–ç•Œå› ç´ ä½œç”¨ä¹‹ä¸‹ï¼Œä½¿å¾—æˆ‘è§è¿‡å¾ˆå¤šä»£ç ç‹‚äººï¼Œæ•´å¤©å°±æ˜¯å†™ä»£ç ç ”ç©¶ç®—æ³•ï¼Œå¹¶ä¸”è§‰å¾—è‡ªå·±éå¸¸å±Œã€‚<strong>è¿™ä¸ªç¤¾ä¼šåœ¨åŠ©é•¿ä»–ä»¬çš„å°é—­æ€§ã€‚</strong></p>
<p>å¯ä»¥è¯´ï¼Œä¹”å¸ƒæ–¯çƒ­è¡·äºå›¾å½¢æ“ä½œç³»ç»Ÿï¼Œæ˜¯å¸Œæœ›è§£æ”¾äººç±»çš„åˆ›é€ åŠ›å’Œç”Ÿäº§åŠ›ï¼Œç„¶è€Œå¦‚ä»Šï¼Ÿæˆ‘ä»¬éœ€è¦æ–°çš„çªç ´ã€‚ç°åœ¨çš„æ“ä½œç³»ç»Ÿï¼Œå®Œå…¨å¯ä»¥å’ŒFlowä¸€æ ·å­˜åœ¨äºäº‘ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯è¿‡å»æ„ä¹‰ä¸Šçš„ç”µè„‘ï¼Œåªæœ‰æ˜¾ç¤ºçš„è®¾å¤‡å’Œç½‘ç»œè¿æ¥çš„è®¾å¤‡ï¼Œä»¥åŠä¸€ä¸ªéº¦å…‹é£ï¼Œå®ƒçš„æˆæœ¬å¯ä»¥åšåˆ°æä½ï¼Œè¿™åœ¨ç¡¬ä»¶çš„å®ç°ä¸Šå·²ç»æ²¡æœ‰äº†ç†è®ºéšœç¢ã€‚ç„¶è€Œåœ¨è½¯ä»¶å±‚é¢ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªæ²¡æœ‰è§£å¼€çš„åã€‚</p>
<p>å½“ç„¶ï¼Œåœ¨è¿™é‡Œæˆ‘å¹¶ä¸æ˜¯è®¤ä¸ºç±»ä¼¼Siriï¼ŒCortanaæˆ–è€…Echoï¼ŒRokitä¹‹æµæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œç›¸åï¼Œä»–ä»¬åœ¨è¿™ä¸ªæ—¶ä»£æ˜¯ä¸€ä¸ªå‹‡æ•¢çš„å…ˆé©±è€…ï¼Œåªä¸è¿‡ä»–ä»¬çš„æ„ä¹‰æ²¡æœ‰é‚£ä¹ˆå¤¸å¼ ç½¢äº†ã€‚æˆ‘æ‰€è®¤ä¸ºçš„ä¸‹ä¸€ä¸ªæ—¶ä»£ï¼Œä¹Ÿå°±æ˜¯æœªæ¥çš„æ—¶ä»£ï¼Œ<strong>ç°åœ¨è¿˜æ²¡æœ‰åˆ°æ¥</strong>ã€‚å¯ä»¥è‚¯å®šçš„æ˜¯<strong>ä¸‹ä¸€ä¸ªæ—¶ä»£çš„æ¥ä¸´ä¸æ˜¯å…‰é ä¸€ç¾¤ç¨‹åºå‘˜å¤©å¤©å†™ç€ä»€ä¹ˆO2Oä»€ä¹ˆæ‰“è½¦è½¯ä»¶å°±å¯ä»¥åˆ›é€ å‡ºæ¥çš„ï¼Œä¹Ÿä¸æ˜¯ä¸€ç¾¤ç¨‹åºå‘˜ä»Šå¤©å†™ä¸ªç”µå•†ç½‘ç«™æ˜å¤©å†™ä¸ªè®ºå›å°±èƒ½åˆ›é€ å‡ºæ¥çš„</strong>ï¼Œè¿™äº›éƒ½åªæ˜¯å•†ä¸šæ¨¡å¼ï¼Œéƒ½åªæ˜¯åˆ›é€ è´¢å¯Œçš„ä¸€ç§æ‰‹æ®µï¼Œåšçš„æå°‘æ•°é¡¶å°–çš„ç‹¬è§’å…½å’Œå·¨å¤´ä¹Ÿä¸è¿‡å°±æ˜¯åœ¨æˆ–å¤šæˆ–å°‘çš„æ”¹å˜äººç±»ç”Ÿæ´»ï¼Œå´å¹¶ä¸è¶³ä»¥æˆä¸ºæ¨åŠ¨äººç±»æ–‡æ˜è¿›åŒ–çš„é‡è¦åŠ›é‡ï¼ˆPs. å†™å®Œä¹‹åæ ¡å¯¹çš„æ—¶å€™å‘ç°è¿™å¥è¯ä¹Ÿè®¸æœ‰äº›è¿‡æ¿€ï¼Œç„¶è€Œå´æ˜¯çœŸçœŸçš„åæ˜ äº†å½“ä¸‹äº’è”ç½‘æ—¶ä»£ç¼ºä¹çœŸæ­£çš„é©å‘½æ€§åˆ›æ–°çš„ç°çŠ¶ï¼Œè¯»è€…ä¸å¿…å¤ªè¿‡è¾ƒçœŸï¼‰ã€‚æ‰€ä»¥ï¼Œç¨‹åºå‘˜ä»¬ï¼Œæœ‰äº›æ—¶å€™ä¸è¦è€æ˜¯è¢«å¤§å®¶åœ¨åšä»€ä¹ˆæˆ–è€…å¤§å…¬å¸åœ¨åšä»€ä¹ˆæ‰€è’™è”½äº†åŒçœ¼ï¼Œæœ‰äº›æ—¶å€™å†·é™ä¸‹æ¥å¥½å¥½æ€è€ƒä¸€ä¸‹è‡ªå·±æ‰€å¤„çš„æ—¶ä»£ï¼Œä¹Ÿè®¸ä½ ä¼šæ˜ç™½å…¶å®æˆ‘ä»¬è¿˜æœ‰æ›´å¤§çš„ä½¿å‘½å»å®Œæˆï¼Œæ›´ä¼Ÿå¤§çš„äº‹æƒ…ç­‰ç€è¢«åˆ›é€ ã€‚ä¹Ÿè®¸ä½ å°±ä¼šæ˜ç™½ï¼Œå¤§éƒ¨åˆ†äººä¸è¿‡éƒ½æ˜¯åœ¨é‡å¤åˆ«äººèµ°è¿‡çš„è·¯ï¼Œå¦‚æœå¯ä»¥ä¸ºæ•´ä¸ªäººç±»å»è¸©å‡ºä¸€æ¡æ–°è·¯ï¼Œé‚£å²‚ä¸æ˜¯æ­¤ç”Ÿæ— æ†¾äº†ï¼Ÿ</p>
<p>å½“æˆ‘ä»¬ç”¨ä»£ç ï¼Œç®—æ³•ï¼Œæƒ³å»å®ç°ä¸€ä¸ªæ‰€è°“çš„äººå·¥æ™ºèƒ½çš„æ—¶å€™ï¼Œå…¶å®è¿™å’Œé€ ç‰©ä¸»åˆ›é€ æˆ‘ä»¬æ˜¯ä¸€æ ·çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°šä¸”æ— æ³•æ˜ç™½äººç±»æ˜¯å¦‚ä½•è¢«åˆ›é€ å‡ºæ¥çš„ï¼Œæˆ‘ä»¬å°šä¸”åªèƒ½ç”¨åŸºå› è¿›åŒ–è®ºæ¥æªå¡ï¼Œä½†æ˜¯ä¸èƒ½å¦è®¤çš„æ˜¯ï¼Œç”Ÿç‰©å­¦ç•Œå¹¶æ— æ³•å®šä¹‰äººç±»çš„æ„è¯†æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Œå…·ä½“åˆæ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚å°¼å®‰å¾·ç‰¹äººï¼Ÿå¾—äº†å§ã€‚æ‰€ä»¥æˆ‘ä»¬çš„åŸºå› ï¼Œæˆ‘ä»¬çš„é€ ç‰©ä¸»ä¸ºæˆ‘ä»¬å†™ä¸‹çš„åŸºå› ï¼Œå…¶å®å°±å’Œæˆ‘ä»¬ç°åœ¨å†™çš„ä»£ç ä¸€æ ·ï¼Œéƒ½æ˜¯å»å®šä¹‰ä¸€ä¸ªç‰©ä½“ï¼Œå¹¶ä¸”æ•™ä¼šå®ƒå„ç§åŸºæœ¬çš„æ–¹æ³•ï¼Œä¾‹å¦‚æˆ‘ä»¬äººç±»çš„è‚Œè‚‰è¿åŠ¨ï¼Œçœ‹ï¼Œå¬ï¼Œåƒï¼Œæ‹‰å±ï¼Œå°±ç›¸å½“äºä¸€ä¸ªç¨‹åºé‡Œçš„åŸºæœ¬æ–¹æ³•åŠ å‡ä¹˜é™¤å¼€æ–¹ç­‰ç­‰ã€‚å½“æœ‰äº†è¿™äº›ä¹‹åï¼ŒåŸºå› åˆç»§ç»­æ•™ä¼šäº†æˆ‘ä»¬å»æ€è€ƒï¼Œå»å­¦ä¹ ï¼Œå»è¯†åˆ«ï¼Œä»è€Œè¯ç”Ÿäº†äººç±»ï¼Œè€Œç°åœ¨æˆ‘ä»¬æ•™ä¼šäº†æˆ‘ä»¬è¦åˆ›é€ çš„è¿™ä¸ªâ€œäº‹ç‰©â€å»å­¦ä¹ ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰äººèƒ½å¤ŸçœŸæ­£æ•™ä¼šå®ƒå»æ€è€ƒå’Œè¯†åˆ«ï¼ˆå½“ç„¶å¦‚æœé‚£æ ·ä¸€å¤©å·²ç»åˆ°æ¥äº†ç°åœ¨çš„ä¸–ç•Œå¯èƒ½å°±é¢ç›®å…¨éäº†ï¼‰ã€‚æ‰€ä»¥æˆ‘è§‰å¾—ï¼Œæƒ³è¦çœŸæ­£çš„ï¼Œæˆ–è€…è¯´æœ€æ­£ç¡®æœ€åˆç†çš„å»åˆ›é€ ä¸€ä¸ªäººå·¥æ™ºèƒ½çš„æ–¹å¼ï¼Œå¦‚æœä½ çœŸçš„æƒ³è¦è¿™ä¹ˆåšçš„è¯ï¼Œä¸æ˜¯ä»ä½ çš„è¡Œä¸ºå‡ºå‘ï¼Œä¹Ÿä¸æ˜¯ä»ä½ æƒ³è¦å®ƒå¸®ä½ æ”¾ä¸€é¦–æ­Œä¼šå¦‚ä½•è¯´çš„è¯å‡ºå‘ï¼Œè€Œåº”è¯¥ä»æˆ‘ä»¬çš„å¤§è„‘å’ŒåŸºå› å‡ºå‘ï¼Œå»ç†è§£å’Œåç¼–è¯‘æˆ‘ä»¬è‡ªå·±çš„ä»£ç ï¼Œå»æ˜ç™½æˆ‘ä»¬çš„åŸºå› æ˜¯å¦‚ä½•å˜æˆæ§åˆ¶æˆ‘ä»¬æˆé•¿ï¼Œæ§åˆ¶æˆ‘ä»¬ç”Ÿè€ç—…æ­»ä¸ƒæƒ…å…­æ¬²çš„ä»£ç ï¼Œè¿™æ‰æ˜¯è®©æˆ‘æ„Ÿè§‰çœŸæ­£çƒ­è¡€æ²¸è…¾çš„äº‹æƒ…ã€‚å½“ç„¶ï¼Œå¦‚æœæœ‰ä¸€å¤©è¿™ä¸ªæŠ€æœ¯èƒ½å¤Ÿè·å¾—çªç ´ï¼Œé‚£å°±çœŸçš„ç®—æ˜¯äººç±»æ–‡æ˜è¿›åŒ–çš„ä¸€å¤§æ­¥äº†å§ã€‚</p>
<p>æœ€åå£°æ˜ï¼š<strong>é€šç¯‡æ‰¯æ·¡ï¼Œè¯´çš„éƒ½æ˜¯åºŸè¯ï¼Œä¸è¦ç›¸ä¿¡ï¼Œä»…åšä¸€ä¹</strong>ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æˆ‘è§‰å¾—ç°åœ¨çš„ä¸è®ºæ˜¯å…¨ç¤¾ä¼šè¿˜æ˜¯æ•´ä¸ªäº’è”ç½‘åœˆï¼Œéƒ½å¼¥æ¼«ç€ä¸€è‚¡å¯¹äºäººå·¥æ™ºèƒ½çš„ç‹‚çƒ­å´‡æ‹œï¼Œå°±åƒæ˜¯ä¸€ç§äººå·¥æ™ºèƒ½é‚ªæ•™ä¸€æ ·ï¼Œæ·±æ·±åœ°è›Šæƒ‘ç€æ¯ä¸€ä¸ªåœˆå¤–äººæˆ–è€…æ˜¯æ— çŸ¥è€…çš„å¿ƒæ™ºã€‚å¤§å®¶éƒ½è§‰å¾—ï¼Œäººå·¥æ™ºèƒ½å¥½ç‰›]]>
    </summary>
    
      <category term="å“²å­¦" scheme="http://sergiochan.github.io/tags/%E5%93%B2%E5%AD%A6/"/>
    
      <category term="æ‰¯æ·¡" scheme="http://sergiochan.github.io/tags/%E6%89%AF%E6%B7%A1/"/>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[2016-04-11 å»æˆ˜æ–—]]></title>
    <link href="http://sergiochan.github.io/2016/04/11/2016-04-11-%E5%8E%BB%E6%88%98%E6%96%97/"/>
    <id>http://sergiochan.github.io/2016/04/11/2016-04-11-å»æˆ˜æ–—/</id>
    <published>2016-04-11T08:55:11.000Z</published>
    <updated>2016-08-19T06:35:03.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>é‡åˆ°çš„æŒ‘æˆ˜è¶Šå¤§ï¼Œè·å¾—çš„å¿«æ„Ÿä¹Ÿè¶Šå¼º</p>
<p>â€“ è‘—åé»‘å®¢å‡¯æ–‡Â·ç±³ç‰¹å°¼å…‹ï¼ˆKevin Mitnickï¼‰</p>
</blockquote>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote>
<p>é‡åˆ°çš„æŒ‘æˆ˜è¶Šå¤§ï¼Œè·å¾—çš„å¿«æ„Ÿä¹Ÿè¶Šå¼º</p>
<p>â€“ è‘—åé»‘å®¢å‡¯æ–‡Â·ç±³ç‰¹å°¼å…‹ï¼ˆKevin Mitnickï¼‰</p>
</blockquote>
]]>
    </summary>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/tags/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æˆ‘æ˜¯æ€ä¹ˆè¸©è¿‡åœ¨ OSX ä¸Šå½•å±çš„å‘çš„]]></title>
    <link href="http://sergiochan.github.io/2016/03/23/%E6%88%91%E6%98%AF%E6%80%8E%E4%B9%88%E8%B8%A9%E8%BF%87%E5%9C%A8-OSX-%E4%B8%8A%E5%BD%95%E5%B1%8F%E7%9A%84%E5%9D%91%E7%9A%84/"/>
    <id>http://sergiochan.github.io/2016/03/23/æˆ‘æ˜¯æ€ä¹ˆè¸©è¿‡åœ¨-OSX-ä¸Šå½•å±çš„å‘çš„/</id>
    <published>2016-03-23T15:55:44.000Z</published>
    <updated>2016-03-23T16:03:40.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©å¼€å§‹åœ¨ç ”ç©¶ OSX ä¸Šçš„å±å¹•å½•åˆ¶å¹¶ä¸”å®æ—¶è·å–è§†é¢‘æµæˆ–å›¾åƒå¸§çš„å®ç°ã€‚é‡åˆ°äº†éå¸¸å¤§çš„é˜»åŠ›ï¼Œå„ç§é—®é¢˜ï¼Œæ˜¨æ™šçº ç»“äº†ä¸€æ•´æ™šï¼Œç»ˆäºåœ¨å°èŒçš„å¯å‘ä¸‹æ…¢æ…¢æ‰¾åˆ°äº†è§£å†³åŠæ³•ï¼ŒæŠŠè°·æ­Œå’Œ stackoverflow éƒ½ç¿»äº†ä¸ªåº•æœå¤©ï¼Œæœ€åçš„è§£å†³æœ‰ç‚¹æ„å¤–ï¼Œä¸­é—´è¿˜æ˜¯æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ±‚è¯ï¼Œç„¶è€Œé™¤äº† Apple Doc å·²ç»æ²¡æœ‰ä»»ä½•å‚è€ƒæ–‡çŒ®äº†ï¼Œè€Œæœ‰äº›æœºåˆ¶ Apple Doc ä¸­éƒ½ä¸ä¼šæ¶‰åŠã€‚æ‰€ä»¥æ­¤åˆ»è¿«ä¸åŠå¾…çš„æƒ³è¦å†™ä¸€ç¯‡åšå®¢ï¼Œæ¥çºªå¿µä¸‡é‡Œé•¿å¾çš„ç¬¬ä¸€æ­¥ã€‚</p>
<p>è¦å®ç°å½•å±ï¼Œæœ‰ä¸¤ç§é€”å¾„ï¼Œä¸€ç§æ˜¯é€šè¿‡ <code>Core Graphic</code>ï¼Œ ä¸€ç§æ˜¯é€šè¿‡ <code>AVFoundation</code>ã€‚ <code>Core Graphic</code> çš„è¯ï¼Œä½ å¯ä»¥æ‰¾åˆ°è‹¹æœå®˜æ–¹çš„ä¸€ä»½ <a href="https://developer.apple.com/library/mac/samplecode/SonOfGrab/Introduction/Intro.html" target="_blank" rel="external">SampleCode</a>ï¼Œå¦‚æœä½¿ç”¨äº† </p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">CGImageRef</span> screenShot = <span class="built_in">CGWindowListCreateImage</span>(<span class="built_in">CGRectMake</span>(<span class="number">0.0</span>f, <span class="number">0.0</span>f, [<span class="keyword">self</span> screenRect].size.width, [<span class="keyword">self</span> screenRect].size.height), kCGWindowListOptionOnScreenOnly, kCGNullWindowID, kCGWindowImageDefault |kCGWindowImageNominalResolution);</span><br></pre></td></tr></table></figure>
<p>å®ƒçš„ä¼˜ç‚¹åœ¨äºä½ å¯ä»¥æ ¹æ® <code>WindowID</code> æ¥è·å–<strong>æŒ‡å®šçª—å£</strong>çš„å›¾åƒï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ <code>ListOption</code> æ¥è®¾å®šå„ç§åŒ…æ‹¬æ¡Œé¢å›¾æ ‡ï¼Œå»é™¤æ¡Œé¢å›¾æ ‡ï¼Œå»é™¤æ¡Œé¢ï¼Œè¿™äº›ä¸ƒä¸ƒå…«å…«çš„è®¾ç½®ï¼Œæ‰€ä»¥å¾®ä¿¡ Mac ç«¯çš„æˆªå±åŠŸèƒ½åº”è¯¥å°±æ˜¯ä½¿ç”¨äº†ä¸Šé¢è¿™è¡Œä»£ç ã€‚<strong>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ª NSTimerï¼Œ æ¥æŒ‰ç…§å…­ååˆ†ä¹‹ä¸€ç§’ä¸€å¸§çš„é€Ÿåº¦æ¥è·å–æˆªå›¾ï¼Œå¹¶ä¸”å½¢æˆä¸€ä¸ªæµã€‚</strong> å®è·µè¡¨æ˜æ€§èƒ½è¿˜ä¸é”™ï¼Œå¯¹äºå½•å±è¿™ç§äº‹æƒ…çƒ§ä¸€çƒ§ CPU æ˜¯å¸¸æœ‰çš„äº‹æƒ…ï¼Œæ¯•ç«Ÿä½ éœ€è¦æŒ‰å¸§æ¥è®¡ç®—åƒç´ ï¼Œè€Œä¸”å¯¹äº Mac è€Œè¨€ï¼ŒCPU å¹¶ä¸æ˜¯ä»€ä¹ˆç‰¹åˆ«å¤§çš„é—®é¢˜ =ã€‚= å› æ­¤è¿™ç§åŠæ³•æ˜¯<strong>å¯è¡Œçš„</strong>ï¼Œç„¶è€Œæˆ‘è§‰å¾—ä¸å¤Ÿä¼˜é›…ã€‚</p>
<p>åŒæ ·ï¼ŒCore Graphic ä¸­è¿˜æœ‰ä¸€ç§å®ç°åŠæ³•ï¼š<code>CGDisplayCreateImage</code>ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">CGImageRef</span> Ref = <span class="built_in">CGDisplayCreateImage</span>(display);</span><br><span class="line"><span class="comment">//NSData *data = (NSData *)CFBridgingRelease(CGDataProviderCopyData(CGImageGetDataProvider(Ref)));</span></span><br><span class="line">screenImg = [[<span class="built_in">NSImage</span> alloc] initWithCGImage:Ref size:<span class="built_in">CGDisplayScreenSize</span>(display)];</span><br><span class="line"><span class="comment">//screenImg = [image mutableCopy];</span></span><br><span class="line"><span class="built_in">CGImageRelease</span>(Ref);</span><br><span class="line"><span class="built_in">CGDisplayRelease</span> (display);</span><br></pre></td></tr></table></figure>
<p>è¿™ç§å®ç°çš„æœºåˆ¶å’Œä¸Šè¿°çš„æ˜¯ä¸€è‡´çš„ï¼Œå®ç°å‡ºæ¥çš„æ•ˆæœå’Œæ€§èƒ½ä¹Ÿéƒ½ä¸é”™ï¼Œä½†æ˜¯åŒæ ·çš„è¿˜æ˜¯è§‰å¾—ä¸å¤Ÿä¼˜é›…ã€‚</p>
<p>æ‰€ä»¥æ­¤åˆ»å°±è¦è½¬å‘ <code>AVFoundation</code> äº†ã€‚åœ¨ <code>AVFoundation</code> ä¸­ï¼Œæœ‰ä¸€ä¸ª input ç±»å«åš <code>AVCaptureScreenInput</code> è¿™ä¸ª input ç›´æ¥å¯ä»¥è·å¾—åˆ°å½“å‰å±å¹•çš„è§†é¢‘è¾“å…¥ã€‚è¿™æ—¶å€™æˆ‘æƒ³èµ·ä¸¤å¹´å‰æˆ‘åšè¿‡è§†é¢‘è¿½è¸ªäººè„¸çš„ sdkï¼Œç®€å•åœ°è¯´å°±æ˜¯é€šè¿‡ <code>AVDeviceCapture</code> æ¥è·å–ç›¸æœºçš„ input ç„¶åæ‰“å¼€ä¸€ä¸ª <code>AVSession</code>ï¼Œ ç„¶åå†å°† input é‡Œé¢çš„ buffer è¯»å‡ºæ¥ï¼Œå¯¹æ¯ä¸€å¸§è¿›è¡Œäººè„¸æ£€æµ‹çš„è¿ç®—ã€‚ç„¶åæˆ‘æŒ‰ç…§è‹¹æœå®˜æ–¹çš„ä¸€ä¸ªå½•å±çš„ä¾‹å­å’Œä¸€ä¸ª Github ä¸Šå­˜åœ¨ä¸å¤šçš„è¿™æ–¹é¢çš„ä»“åº“å®ç°äº†ç®€å•çš„å½•å±ï¼Œä½¿ç”¨äº† <code>AVCaptureMovieFileOutput</code> ä½œä¸º outputã€‚åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ï¼Œè¾“å‡ºåˆ° mov æ–‡ä»¶çš„å½•å±éƒ½æ˜¯æ­£å¸¸çš„ã€‚ç„¶åæˆ‘å¼€å§‹äº†ä»ç¼“å†²åŒºè¯»å– buffer çš„å·¥ä½œï¼Œç®€å•æ¥è¯´ï¼Œä»ç¼“å†²åŒºè¯»å¸§æ˜¯æ ¹æ® <code>AVCaptureFileOutputDelegate</code> é‡Œé¢çš„ä¸€ä¸ªå›è°ƒ </p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line">- <span class="params">(void)</span>captureOutput:<span class="params">(AVCaptureFileOutput *)</span>captureOutput didOutputSampleBuffer:<span class="params">(CMSampleBufferRef)</span>sampleBuffer fromConnection:<span class="params">(AVCaptureConnection *)</span>connection;</span><br></pre></td></tr></table></figure>
<p>æ¥å®ç°çš„ã€‚è¿™é‡Œçš„ <code>CMSampleBuffers</code> æ˜¯ä¸€ä¸ª <code>Core Foundation</code> çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†é›¶ä¸ªæˆ–å¤šä¸ªå‹ç¼©æˆ–æœªå‹ç¼©è¿‡çš„ç‰¹å®šåª’ä½“ç±»å‹çš„æŠ½æ ·ï¼Œé€šå¸¸è¢«ç”¨æ¥ä¼ é€’åª’ä½“æ•°æ®ã€‚ä¸€ä¸ª <code>CMSampleBuffers</code> å¯ä»¥åŒ…å«ï¼š</p>
<ul>
<li><code>CMBlockBuffer</code>, å¯èƒ½åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªçš„ sample (è¯è¯´ sample å¯ä»¥ç¿»è¯‘ä¸ºå¸§ä¹ˆï¼Ÿè¿˜æ˜¯å–æ ·çš„æ„æ€â€¦â€¦)</li>
<li><code>CVImageBuffer</code> åŒ…å«äº† buffer å±‚çº§çš„é™„ä»¶å’Œ sample å±‚çº§çš„é™„ä»¶ï¼Œè¿˜åŒ…æ‹¬äº†åŒ…å«çš„æ‰€æœ‰ sample çš„æ ¼å¼ï¼Œå¤§å°å’Œæ—¶é—´ä¿¡æ¯</li>
</ul>
<p>æŒ‰ç…§ Apple Docï¼Œ ä¸€ä¸ª <code>CMSampleBuffers</code> å°±æ˜¯è¿™ä¸¤ç§ buffer ä¹‹ä¸€çš„ä¸€ä¸ª wrapperï¼Œ å› æ­¤æ¯ä¸€ä¸ª <code>CMSampleBuffers</code> åªä¼šåŒ…å«å…¶ä¸­ä¹‹ä¸€ã€‚ä½ éœ€è¦ç”¨ä¸åŒçš„æ–¹æ³•æ¥å–å‡ºé‡Œé¢çš„æ•°æ®ã€‚æ‰€ä»¥æˆ‘å°±å¾ˆæ­£å¸¸çš„æŒ‰ç…§æœ€æ­£å¸¸çš„å†™æ³•æ¥å– buffer äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">CVImageBufferRef imageBuffer = <span class="built_in">CMSampleBufferGetImageBuffer</span>(sampleBuffer);</span><br><span class="line">CVPixelBufferLockBaseAddress(imageBuffer,<span class="number">0</span>);        <span class="comment">// Lock the image buffer</span></span><br><span class="line">        </span><br><span class="line">uint8_t *baseAddress = (uint8_t *)CVPixelBufferGetBaseAddressOfPlane(imageBuffer, <span class="number">0</span>);   <span class="comment">// Get information of the image</span></span><br><span class="line">size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);</span><br><span class="line">size_t width = CVPixelBufferGetWidth(imageBuffer);</span><br><span class="line">size_t height = CVPixelBufferGetHeight(imageBuffer);</span><br><span class="line"><span class="built_in">CGColorSpaceRef</span> colorSpace = <span class="built_in">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">CGContextRef</span> newContext = <span class="built_in">CGBitmapContextCreate</span>(baseAddress, width, height, <span class="number">8</span>, bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst);</span><br><span class="line"><span class="built_in">CGImageRef</span> newImage = <span class="built_in">CGBitmapContextCreateImage</span>(newContext);</span><br><span class="line"><span class="built_in">CGContextRelease</span>(newContext);</span><br><span class="line"></span><br><span class="line"><span class="built_in">CGColorSpaceRelease</span>(colorSpace);</span><br><span class="line">CVPixelBufferUnlockBaseAddress(imageBuffer,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œè¿™ä¸ªæ—¶å€™å‡ºäº†ä¸ªå°å²”å­ï¼Œè¿™é‡Œè·å–çš„ <code>CMSampleBuffers</code> é‡Œé¢åŒ…çš„æ˜¯ <code>CMBlockBuffer</code>ï¼äºæ˜¯æˆ‘å¼€å§‹æŸ¥å„ç§ stackoverflowï¼Œ æ— è§£ï¼Œ ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è§†é¢‘æ ¼å¼çš„é—®é¢˜ï¼Œéœ€è¦æŒ‰ç…§ H264 çš„ç¼–ç æ¥è§£æï¼Œä½†æ˜¯æ€ä¹ˆå¯èƒ½å‘¢â€¦â€¦ ç™¾æ€ä¸å¾—å…¶è§£ï¼Œå³ä½¿æˆ‘å°† <code>CMBlockBuffer</code> é‡Œé¢çš„ Data è¯»å–äº†å‡ºæ¥ï¼Œä¹Ÿæ— æ³•è½¬æ¢æˆ <code>NSImage</code>ï¼Œ è¯´æ˜è¿™ä¸ª Data ä¸æ˜¯æ­£å¸¸çš„ dataã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰å¯èƒ½ä¸€å¸§è¢«æ‹†æˆå¤šä¸ª samples æ¥ä¼ è¾“äº†å‘¢â€¦â€¦ æœ‰å¯èƒ½ï¼Œç„¶è€Œæˆ‘å°è¯•äº†ä»ç„¶æ— æœã€‚</p>
<p>è¿™æ—¶å€™æˆ‘å›å¤´çœ‹çœ‹ï¼Œå‘ç°æˆ‘è¿™é‡Œå¹¶æ²¡æœ‰å°†è§†é¢‘å¯¼å‡ºåˆ°æ–‡ä»¶çš„éœ€æ±‚ï¼Œæœ‰æ²¡æœ‰å…¶ä»– output æ¥æ›¿ä»£ã€‚åå·§æˆ‘åœ¨ stackoverflow ä¸Šçœ‹åˆ°äº†<a href="http://stackoverflow.com/questions/15916808/capturing-blank-stills-from-a-avcapturescreeninput" target="_blank" rel="external">è¿™ä¸ªé—®é¢˜</a>ï¼Œäºæ˜¯å°±ç”¨ <code>AVCaptureVideoDataOutput</code> æ¥å°è¯•ã€‚å°è¯•ä¹‹å‰æˆ‘å·²ç»æœ‰å¼ºçƒˆé¢„æ„Ÿäº† - - æ¯•ç«Ÿä¸Šä¸€ä¸ª output æ˜¯ç›´æ¥è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œè€Œè¿™ä¸ª output æ˜æ˜¾æ˜¯ç›´æ¥è¾“å‡ºæˆ dataã€‚äºæ˜¯ä½ åªè¦è¿™æ ·ç»™ä¸€ä¸ª output å°±å¯ä»¥æ¢å¤æ­£å¸¸äº†ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">self.output  = [[AVCaptureVideoDataOutput alloc] init];</span><br><span class="line">[((AVCaptureVideoDataOutput *)self.output) setVideoSettings:[NSDictionary dictionaryWithObjectsAndKeys:@(kCVPixelFormatType_32BGRA),kCVPixelBufferPixelFormatTypeKey, <span class="literal">nil</span>]];</span><br><span class="line">dispatch_queue_t<span class="built_in"> queue </span>= dispatch_queue_create(<span class="string">"com.sergio.chan"</span>, 0);</span><br><span class="line">[(AVCaptureVideoDataOutput *)self.output setSampleBufferDelegate:self queue:queue];</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™çš„ sampleBuffer å·²ç»å¯ä»¥æ­£å¸¸æŒ‰å¸§è§£æå‡ºæ¥äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯åœ¨ä¸Šé¢é‚£æ®µä»£ç è·å–åˆ°ä¸€ä¸ª <code>CGImageRef</code> çš„ <code>newImage</code> å¯¹è±¡åéœ€è¦æ¯ä¸€æ¬¡éƒ½å¯¹ newImage è¿›è¡Œä¸€æ¬¡releaseï¼Œå¦åˆ™å†…å­˜æº¢å‡ºå°±è¦çˆ†ç‚¸äº†ï¼Œä¸€ä¸ªæ˜¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåœ¨ä¸Šé¢çš„ä»£ç é‡Œå¯ä»¥çœ‹å‡ºè¿™ä¸ªæ–°çš„ <code>AVCaptureVideoDataOutputSampleBufferDelegate</code> å…¶å®æ˜¯åœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸Šæ¥æ”¶å›è°ƒçš„ï¼Œå› æ­¤å¦‚æœä½ è¦åœ¨è¿™ä¸ª delegate ä¸­è¿›è¡Œ UI æ“ä½œçš„è¯ï¼Œè®°å¾—å›åˆ°ä¸»çº¿ç¨‹æ“ä½œ =ã€‚=</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@try</span> &#123;</span><br><span class="line">    CVImageBufferRef imageBuffer = <span class="built_in">CMSampleBufferGetImageBuffer</span>(sampleBuffer);</span><br><span class="line">    CVPixelBufferLockBaseAddress(imageBuffer,<span class="number">0</span>);        <span class="comment">// Lock the image buffer</span></span><br><span class="line">    </span><br><span class="line">    uint8_t *baseAddress = (uint8_t *)CVPixelBufferGetBaseAddressOfPlane(imageBuffer, <span class="number">0</span>);   <span class="comment">// Get information of the image</span></span><br><span class="line">    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);</span><br><span class="line">    size_t width = CVPixelBufferGetWidth(imageBuffer);</span><br><span class="line">    size_t height = CVPixelBufferGetHeight(imageBuffer);</span><br><span class="line">    <span class="built_in">CGColorSpaceRef</span> colorSpace = <span class="built_in">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGContextRef</span> newContext = <span class="built_in">CGBitmapContextCreate</span>(baseAddress, width, height, <span class="number">8</span>, bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst);</span><br><span class="line">    <span class="built_in">CGImageRef</span> newImage = <span class="built_in">CGBitmapContextCreateImage</span>(newContext);</span><br><span class="line">    <span class="built_in">CGContextRelease</span>(newContext);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGColorSpaceRelease</span>(colorSpace);</span><br><span class="line">    CVPixelBufferUnlockBaseAddress(imageBuffer,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSImage</span> *image = [[<span class="built_in">NSImage</span> alloc] initWithCGImage:newImage size:[<span class="keyword">self</span> screenRect].size];</span><br><span class="line">    <span class="built_in">CGImageRelease</span>(newImage);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">self</span>.imageView) &#123;</span><br><span class="line">            <span class="keyword">self</span>.imageView.image = image;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Error at %@"</span>,exception.debugDescription);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@finally</span> &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>PS. Cocoa ä¸­è·å– ScreenRect çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">- (NSRect)<span class="keyword">screenRect</span></span><br><span class="line"><span class="keyword">&#123;</span></span><br><span class="line"><span class="keyword"> </span>   NSRect <span class="keyword">screenRect;</span></span><br><span class="line"><span class="keyword"> </span>   NSArray *<span class="keyword">screenArray </span>= [NSScreen <span class="keyword">screens];</span></span><br><span class="line"><span class="keyword"> </span>   NSScreen *<span class="keyword">screen </span>= [<span class="keyword">screenArray </span>objectAtIndex: <span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">    <span class="keyword">screenRect </span>= [<span class="keyword">screen </span>frame]<span class="comment">;//[screen visibleFrame];</span></span><br><span class="line">    </span><br><span class="line">    return <span class="keyword">screenRect;</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œåæ¥åˆé‡åˆ°ä¸€ä¸ªå°å‘ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ visibleFrameï¼Œ é‚£ä¹ˆå¦‚æœä½ çš„çª—å£å¤„äºå…¨å±æ¨¡å¼ï¼Œè·å– visibleFrame çš„æ—¶å€™å…¶å®ä¼šæŠŠä¸Šé¢çŠ¶æ€æ çš„é‚£éƒ¨åˆ†åŒºåŸŸç»™çœç•¥äº†ï¼Œå› ä¸ºè®¡ç®— visibleFrame çš„æ—¶å€™ä¼°è®¡ä¸è€ƒè™‘çŠ¶æ€æ æ˜¯å¦éšè—å§ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ frame æ›´å¥½ã€‚</p>
</blockquote>
<p>è¿™é‡Œä» delegate ä¸­è·å–åˆ°æ¯ä¸€å¸§çš„æ•°æ®ä¹‹åå°±å¯ä»¥å¯¹æ¯ä¸€å¸§è¿›è¡Œå‹ç¼©ï¼Œå¹¶ä¸”ä»¥ Data çš„å½¢å¼è¿›è¡Œä¼ è¾“äº†ã€‚å·®ç‚¹å¿˜è®°æœ€åä»‹ç»ä¸€ä¸‹ <code>AVCaptureScreenInput</code> çš„ä¸€äº›ç‰¹æ€§äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.input.capturesMouseClicks = <span class="literal">YES</span>;</span><br><span class="line"><span class="keyword">self</span>.input.minFrameDuration = <span class="built_in">CMTimeMake</span>(<span class="number">1</span>, <span class="number">60</span>);</span><br><span class="line"><span class="keyword">self</span>.input.scaleFactor = <span class="number">0.5</span>f;</span><br><span class="line"><span class="keyword">self</span>.input.cropRect = [<span class="keyword">self</span> screenRect];</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆ <code>AVCaptureScreenInput</code> å¯ä»¥è®°å½•ä¸‹é¼ æ ‡ç§»åŠ¨çš„è½¨è¿¹ï¼Œè¿˜å¯ä»¥è®°å½•é¼ æ ‡çš„ç‚¹å‡»äº‹ä»¶ï¼ˆè‡ªè¡Œä½“éªŒï¼‰ï¼Œç¬¬äºŒä¸ªå±æ€§è®¾ç½®çš„æ˜¯æœ€å¤§å¸§ç‡ï¼Œä¹Ÿå°±æ˜¯60å¸§ä¸€ç§’ã€‚ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå±æ€§é¡¾åæ€ä¹‰åˆ†åˆ«æ˜¯ç¼©æ”¾çš„æ¯”ä¾‹å’Œæœ€åè¾“å‡ºçš„è£å‰ªåŒºåŸŸï¼Œè®¾ç½®è¿™ä¸¤ä¸ªå±æ€§å¯ä»¥å‡å°‘æ¯ä¸€å¸§çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¾“å…¥çš„æ—¶å€™å°±å·²ç»é™åˆ¶è¿‡å¤§å°äº†ï¼Œç„¶åä½ å†å¯ä»¥è¿›è¡Œä¸€äº›å‹ç¼©ä»€ä¹ˆçš„ã€‚æœ€åå…¶å® <code>AVCaptureScreenInput</code> è¿˜æœ‰ä¸€ä¸ªå…³é”®çš„å±æ€§ï¼Œä½†æ˜¯ç°åœ¨å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå› ä¸ºè‹¹æœå·²ç»æŠŠè¿™ä¸ªå±æ€§å†…ç½®æˆç³»ç»Ÿé»˜è®¤äº†ğŸ˜‚ <strong>é‡å¤å¸§ä¼šè¢«è‡ªåŠ¨å–æ¶ˆ</strong>ï¼Œè¿™åœ¨ä»¥å‰çš„ç‰ˆæœ¬æ˜¯å¯ä»¥é€šè¿‡ä¸€ä¸ªå±æ€§è®¾ç½®çš„ï¼Œç°åœ¨å·²ç»è¢«é»˜è®¤é‡‡ç”¨äº†ã€‚</p>
<p>å¤šä½™çš„è¯´å‡ ç‚¹ï¼š</p>
<ul>
<li>å…¶å® Core Media é‚£å±‚æœ‰å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼Œä½†æ˜¯è‹¦äºæ–‡æ¡£å¤ªå°‘ï¼Œç ”ç©¶çš„äººä¹Ÿå¤ªå°‘ï¼Œå› æ­¤å®åœ¨æ˜¯ä¸¾æ­¥ç»´è‰°ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å‚è€ƒä¸€ä¸‹<a href="https://developer.apple.com/library/mac/documentation/CoreMedia/Reference/CMSampleBuffer/" target="_blank" rel="external">è‹¹æœçš„ Reference </a>çœ‹ä¸‹è¿™å—çš„å†…å®¹ã€‚</li>
<li>å…¶å®å¯èƒ½æœ‰äº›äººçŸ¥é“åœ¨ <code>AVFoundation</code> ä¸‹é¢ï¼Œ<code>Core Media</code>ä¹‹ä¸Šè¿˜æœ‰ä¸€å±‚å«åš <code>Video ToolBox</code>ï¼Œè¿™åœ¨2012å¹´é‚£ä¼šå„¿éƒ½æ˜¯åªæœ‰è¶Šç‹±çš„è®¾å¤‡æ‰èƒ½è°ƒç”¨åˆ°çš„ Private APIï¼Œä½†æ˜¯2014å¹´çš„ WWDC è‹¹æœå°†è¿™ä¸€å±‚å¼€æ”¾å‡ºæ¥äº†ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ <code>AVFoundation</code> æ›´æ·±å…¥çš„å±‚æ¬¡å»åšè§†é¢‘ç¼–ç è§£ç å’Œæµå¤„ç†ï¼Œè¿™å—çš„çŸ¥è¯†æˆ‘è¿™æ¬¡åªçœ‹äº†ä¸ªå¤§æ¦‚ï¼Œç•™ä¸‹äº†ä¸€äº›èµ„æ–™å‡ºå¤„ï¼š<a href="https://github.com/McZonk/VideoToolboxPlus" target="_blank" rel="external">Github</a>  <a href="https://developer.apple.com/videos/play/wwdc2014/513/" target="_blank" rel="external">WWDC</a></li>
</ul>
<p>æœ€åï¼Œæœ€é‡è¦çš„æ˜¯ï¼ä»£ç å·²ç»æ•´ç†æˆå¼€æºåº“æ”¾åœ¨ <a href="https://github.com/RavenTech-GrowthHacker/RTScreenRecorder" target="_blank" rel="external">Github</a> ä¸Šäº†ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ˜¨å¤©å¼€å§‹åœ¨ç ”ç©¶ OSX ä¸Šçš„å±å¹•å½•åˆ¶å¹¶ä¸”å®æ—¶è·å–è§†é¢‘æµæˆ–å›¾åƒå¸§çš„å®ç°ã€‚é‡åˆ°äº†éå¸¸å¤§çš„é˜»åŠ›ï¼Œå„ç§é—®é¢˜ï¼Œæ˜¨æ™šçº ç»“äº†ä¸€æ•´æ™šï¼Œç»ˆäºåœ¨å°èŒçš„å¯å‘ä¸‹æ…¢æ…¢æ‰¾åˆ°äº†è§£å†³åŠæ³•ï¼ŒæŠŠè°·æ­Œå’Œ stac]]>
    </summary>
    
      <category term="AVFoundation" scheme="http://sergiochan.github.io/tags/AVFoundation/"/>
    
      <category term="Cocoa" scheme="http://sergiochan.github.io/tags/Cocoa/"/>
    
      <category term="Cocoaå…¥é—¨ï¼Ÿ" scheme="http://sergiochan.github.io/categories/Cocoa%E5%85%A5%E9%97%A8%EF%BC%9F/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[2016.03.15]]></title>
    <link href="http://sergiochan.github.io/2016/03/15/2016-03-15/"/>
    <id>http://sergiochan.github.io/2016/03/15/2016-03-15/</id>
    <published>2016-03-15T09:59:28.000Z</published>
    <updated>2016-03-15T10:02:50.000Z</updated>
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å® è¾±ä¸æƒŠã€‚<br>åŠªåŠ›å»å°è¯•å§ï¼Œæ—¢ç„¶ä½ èƒ½å¤Ÿæœ‰æœºä¼šå»æ”¹å˜ä¸–ç•Œäº†ï¼</p>
<p>ä¸€æ­¥æ­¥è„šè¸å®åœ°èµ°ä¸‹å»ã€‚<br>ç§ä¸‹æ±—æ°´ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>å® è¾±ä¸æƒŠã€‚<br>åŠªåŠ›å»å°è¯•å§ï¼Œæ—¢ç„¶ä½ èƒ½å¤Ÿæœ‰æœºä¼šå»æ”¹å˜ä¸–ç•Œäº†ï¼</p>
<p>ä¸€æ­¥æ­¥è„šè¸å®åœ°èµ°ä¸‹å»ã€‚<br>ç§ä¸‹æ±—æ°´ã€‚</p>
]]>
    </summary>
    
      <category term="é—²è¨€ç¢è¯­" scheme="http://sergiochan.github.io/categories/%E9%97%B2%E8%A8%80%E7%A2%8E%E8%AF%AD/"/>
    
  </entry>
  
</feed>
